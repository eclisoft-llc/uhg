CREATE OR REPLACE PROCEDURE COMPACT.TB_DIM_FCT_CLM_TRANS_CRR_LOAD("STARTDATE" VARCHAR(16777216))
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '
    declare result varchar;
    load_strt_ts timestamp;
    load_end_ts timestamp;
    upr_ts timestamp;
    ins_cnt number;
    updt_cnt number;
    unique_id varchar;
    begin
     SELECT UUID_STRING() into unique_id;
     SELECT CURRENT_TIMESTAMP() INTO load_strt_ts ;

CREATE OR REPLACE TEMPORARY TABLE ETL_CLM_MBR_SYS_ID AS
SELECT
SRV.CRR_CLM_SRVC_SYS_ID as CRR_CLM_SRVC_SYS_ID,
SRV.CLM_MBR_ALT_ID as CLM_MBR_ALT_ID,
case when ALT.MBR_SYS_ID is null then -1 else ALT.MBR_SYS_ID end as MBR_SYS_ID,
case when MBR.PERS_SYS_ID is null then -1 else MBR.PERS_SYS_ID end as PERS_SYS_ID,
MBR.BTH_DT as BTH_DT,
HDR.CLM_FST_SRVC_DT
FROM COMPACT.TB_CLM_CRR_CLM_SRVC SRV
LEFT JOIN COMPACT.TB_CLM_CRR_CLM_HEAD HDR ON SRV.CRR_CLM_HEAD_SYS_ID = HDR.CRR_CLM_HEAD_SYS_ID
LEFT OUTER JOIN COMPACT.TB_MEM_MBR_ALT ALT
ON TRIM(SRV.CLM_MBR_ALT_ID) = TRIM(ALT.MBR_ALT_ID) and TRIM(ALT.REC_INPUT_SRC_CD) =''CRR''
LEFT OUTER JOIN COMPACT.TB_MEM_MBR MBR
ON TRIM(ALT.MBR_SYS_ID) = TRIM(MBR.MBR_SYS_ID);
 
 
CREATE OR REPLACE TEMPORARY TABLE TMP_TB_DIM_FCT_CLM_CRR AS (SELECT * FROM (SELECT DISTINCT
(case when CRR_CLM_SRVC.CLM_SRVC_FROM_DT >=''2003-01-01'' then 1 else 0 end) as NET_DTL_FLG,
CRR_CLM_SRVC.CLM_AUD_NBR CLM_AUD_NBR,
CRR_CLM_SRVC.REC_INPUT_SRC_CD REC_INPUT_SRC_CD,
CRR_CLM_SRVC.CLM_AUD_LN_NBR CLM_AUD_LN_NBR,
CRR_CLM_SRVC.PROV_SRVC_CTY_NM PROV_SRVC_CTY_NM,
CRR_CLM_SRVC.PROV_SRVC_ST_CD PROV_SRVC_ST_CD,
CRR_CLM_SRVC.CLM_SRVC_SRC_PROV_ID CLM_SRVC_SRC_PROV_ID,
CRR_CLM_SRVC.CLM_SRVC_ADJ_CD CLM_SRVC_ADJ_CD,
CRR_CLM_SRVC.CLM_SRVC_BEN_LVL_DERIV_CD CLM_SRVC_BEN_LVL_DERIV_CD,
CRR_CLM_SRVC.CLM_SRVC_BEN_LVL_SRC_CD CLM_SRVC_BEN_LVL_SRC_CD,
CRR_CLM_SRVC.CLM_CHK_NBR CLM_CHK_NBR,
Coalesce(CRR_CLM_SRVC.CLM_SRVC_DIAG_1_CD,'''') as CLM_SRVC_DIAG_1_CD,
Coalesce(CRR_CLM_SRVC.CLM_SRVC_DIAG_2_CD,'''') as CLM_SRVC_DIAG_2_CD,
Coalesce(CRR_CLM_SRVC.CLM_SRVC_DIAG_3_CD,'''') as CLM_SRVC_DIAG_3_CD,
CRR_CLM_SRVC.DIAG_SBSTNC_ABUS_FLG DIAG_SBSTNC_ABUS_FLG,
CRR_CLM_SRVC.LVL_OF_CARE_DERIV_TXT LVL_OF_CARE_DERIV_TXT,
CRR_CLM_SRVC.CLM_SRVC_PD_DT as CLM_SRVC_PD_DT,
CRR_CLM_SRVC.CLM_SRVC_PST_DT as CLM_SRVC_PST_DT,
COALESCE(CRR_CLM_SRVC.CLM_SRVC_FROM_DT,''1900-01-01'') as CLM_SRVC_FROM_DT,
COALESCE(CRR_CLM_SRVC.CLM_SRVC_THRU_DT,''1900-01-01'') as CLM_SRVC_THRU_DT,
CRR_CLM_SRVC.LVL_OF_SRVC_DERIV_CD LVL_OF_SRVC_DERIV_CD,
CRR_CLM_SRVC.LVL_OF_SRVC_SRC_CD LVL_OF_SRVC_SRC_CD,
CRR_CLM_SRVC.PL_OF_SRVC_AMA_CD PL_OF_SRVC_AMA_CD,
CRR_CLM_SRVC.CLM_SRVC_PROC_MOD_CD as CLM_SRVC_PROC_MOD_CD,
CRR_CLM_SRVC.CLM_SRVC_RVNU_CD as CLM_SRVC_RVNU_CD,
CRR_CLM_SRVC.CLM_SRVC_PROC_CD as CLM_SRVC_PROC_CD,
CRR_CLM_SRVC.CLM_SRVC_UNIT_OF_MSR_DESC as CLM_SRVC_UNIT_OF_MSR_DESC,
CRR_CLM_SRVC.CLM_SRVC_PROV_IN_NTWK_CD as CLM_SRVC_PROV_IN_NTWK_CD,
CRR_CLM_SRVC.PROV_TAX_ID as PROV_TAX_ID,
CRR_CLM_SRVC.PROV_SRVC_ZIP_CD as PROV_SRVC_ZIP_CD,
CRR_CLM_SRVC.PROV_NPI_ID as PROV_NPI_ID,
CRR_CLM_SRVC.PYMT_OVRIDE_CD as PYMT_OVRIDE_CD,
CRR_CLM_SRVC.PYMT_EOB_RSN_CD as PYMT_EOB_RSN_CD,
CRR_CLM_SRVC.PYMT_EOB_RSN_CD_DESC as PYMT_EOB_RSN_CD_DESC,
coalesce(CRR_CLM_SRVC.AUTH_SYS_ID,-1) as AUTH_SYS_ID,
CRR_CLM_SRVC.CLM_AUTH_NBR CLM_AUTH_NBR, 
CRR_CLM_SRVC.CRR_CLM_SRVC_SYS_ID as CRR_CLM_SRVC_SYS_ID,
CRR_CLM_SRVC.PROV_PAYE_NM as PROV_PAYE_NM,
trim(CRR_CLM_SRVC.PRI_PAYE_CD) as PRI_PAYE_CD,
CRR_CLM_SRVC.PRI_PAYE_CD_DESC PRI_PAYE_CD_DESC,
CRR_CLM_SRVC.ICD_DIAG_TYP_CD as ICD_DIAG_TYP_CD,
coalesce(CRR_CLM_SRVC.PROV_SYS_ID,-1) as PROV_SYS_ID,
(CASE WHEN CRR_CLM_SRVC.AMT_ALLW_AMT >= 9999999.99 THEN 9999999.99 ELSE CRR_CLM_SRVC.AMT_ALLW_AMT END) AS AMT_ALLW_AMT,
(CASE WHEN CRR_CLM_SRVC.AMT_ALLW_DERIV_AMT >= 9999999.99 THEN 9999999.99 ELSE CRR_CLM_SRVC.AMT_ALLW_DERIV_AMT END) AS AMT_ALLW_DERIV_AMT,
(CASE WHEN CRR_CLM_SRVC.AMT_COPAY_AMT >= 9999999.99 THEN 9999999.99 ELSE CRR_CLM_SRVC.AMT_COPAY_AMT END) AS AMT_COPAY_AMT,
(CASE WHEN CRR_CLM_SRVC.AMT_DED_AMT >= 9999999.99 THEN 9999999.99 ELSE CRR_CLM_SRVC.AMT_DED_AMT END) AS AMT_DED_AMT,
(CASE WHEN CRR_CLM_SRVC.AMT_DSALLW_AMT >= 9999999.99 THEN 9999999.99 ELSE CRR_CLM_SRVC.AMT_DSALLW_AMT END) AS AMT_DSALLW_AMT,          
(CASE WHEN CRR_CLM_SRVC.AMT_MBR_RESP_AMT >= 9999999.99 THEN 9999999.99 ELSE CRR_CLM_SRVC.AMT_MBR_RESP_AMT END) AS AMT_MBR_RESP_AMT,
(CASE WHEN CRR_CLM_SRVC.AMT_PD_AMT >= 9999999.99 THEN 9999999.99 ELSE CRR_CLM_SRVC.AMT_PD_AMT END) AS AMT_PD_AMT,
(CASE WHEN CRR_CLM_SRVC.AMT_SBMT_AMT >= 9999999.99 THEN 9999999.99 ELSE CRR_CLM_SRVC.AMT_SBMT_AMT END) AS AMT_SBMT_AMT,
CRR_CLM_SRVC.CLM_SRVC_UNIT_CNT as CLM_SRVC_UNIT_CNT,
CRR_CLM_SRVC.CLM_SRVC_UNIT_DERIV_CNT CLM_SRVC_UNIT_DERIV_CNT,
CRR_CLM_SRVC.AMT_COB_AMT AS CLM_TOT_COB_SV_AMT,  
CRR_CLM_SRVC.AMT_COINS_AMT AS CLM_TOT_COPAY_COINS_AMT,
CRR_CLM_HEAD.CLM_MBR_SRC_MBR_SYS_ID CLM_MBR_SRC_MBR_SYS_ID,
trim(CRR_CLM_HEAD.CLM_MBR_GDR_CD) as CLM_MBR_GDR_CD,
trim(CRR_CLM_HEAD.CLM_MBR_REL_CD) as CLM_MBR_REL_CD,
CRR_CLM_HEAD.CLM_SRVC_AUTH_NBR CLM_SRVC_AUTH_NBR,
CRR_CLM_HEAD.CLM_MBR_SRC_SBSCR_ID as CLM_MBR_SRC_SBSCR_ID,
CRR_CLM_HEAD.CLM_SRC_CUST_CONTR_ID CLM_SRC_CUST_CONTR_ID,
CRR_CLM_HEAD.CLM_MBR_SRC_SGRP_ID as CLM_MBR_SRC_SGRP_ID,
CRR_CLM_SRVC.CLM_SRVC_ADJD_DT as CLM_ADJD_DT,
trim(CRR_CLM_HEAD.CLM_FM_TYP_CD) as CLM_FM_TYP_CD,
CRR_CLM_HEAD.CLM_ENT_DT as CLM_ENT_DT,
CRR_CLM_HEAD.CLM_RECV_DT as CLM_RECV_DT,
CRR_CLM_HEAD.CLM_SBMT_SRC_DESC as CLM_SBMT_SRC_DESC,
CRR_CLM_HEAD.CLM_PRI_DIAG_CD as CLM_PRI_DIAG_CD,
COALESCE(CRR_CLM_HEAD.ADMIT_DT,''1900-01-01'') as ADMIT_DT,
trim(CRR_CLM_HEAD.ADMIT_TYP_CD) as ADMIT_TYP_CD,
trim(CRR_CLM_HEAD.ADMIT_SRC_CD) as ADMIT_SRC_CD,
CRR_CLM_HEAD.CLM_FST_SRVC_DT as CLM_FST_SRVC_DT,
CRR_CLM_HEAD.CLM_LST_SRVC_DT as CLM_LST_SRVC_DT,
trim(CRR_CLM_HEAD.ADJD_BIL_TYP_CD) as ADJD_BIL_TYP_CD,
trim(CRR_CLM_HEAD.DSCHRG_STS_CD) as DSCHRG_STS_CD,
trim(CRR_CLM_HEAD.ADJD_DIAG_REL_GRP_CD) as ADJD_DIAG_REL_GRP_CD,
trim(CRR_CLM_HEAD.SBMT_DIAG_REL_GRP_CD) as SBMT_DIAG_REL_GRP_CD,
Coalesce(TB_DIAG_1.DIAG_CATGY_DERIV_DESC,''Unknown'') as DIAG_CATGY_DERIV_DESC_1,
Coalesce(TB_DIAG_1.DIAG_DERIV_DESC,''Unknown'') as DIAG_DERIV_DESC_1,
Coalesce(TB_DIAG_1.DIAG_DERIV_TYP_CD,''U'') as DIAG_DERIV_TYP_CD_1,
Coalesce(TB_DIAG_1.DSM_TYP_CD,''U'') as DSM_TYP_CD_1,
Coalesce((case when trim(TB_DIAG_1.DIAG_DERIV_TYP_CD)=''EAP'' Then ''MH''
               when trim(TB_DIAG_1.MH_SA_CD)='''' Then ''MH''
               else TB_DIAG_1.MH_SA_CD end),''MH'') as MH_SA_CD,
Coalesce(TB_DIAG_2.DIAG_CATGY_DERIV_DESC,''Unknown'') as DIAG_CATGY_DERIV_DESC_2,
Coalesce(TB_DIAG_2.DIAG_DERIV_DESC,''Unknown'') as DIAG_DERIV_DESC_2,
Coalesce(TB_DIAG_2.DIAG_DERIV_TYP_CD,''U'') as DIAG_DERIV_TYP_CD_2,
Coalesce(TB_DIAG_2.DSM_TYP_CD,''U'') as DSM_TYP_CD_2,
Coalesce(TB_DIAG_3.DIAG_CATGY_DERIV_DESC,''Unknown'') as DIAG_CATGY_DERIV_DESC_3,
Coalesce(TB_DIAG_3.DIAG_DERIV_DESC,''Unknown'') as DIAG_DERIV_DESC_3,
Coalesce(TB_DIAG_3.DIAG_DERIV_TYP_CD,''U'') as DIAG_DERIV_TYP_CD_3,
Coalesce(TB_DIAG_3.DSM_TYP_CD,''U'') as DSM_TYP_CD_3,
TB_PROC.PROC_DESC as PROC_DESC,
trim(TB_PROC.PROC_TYP_CD) as PROC_TYP_CD,
LVL_OF_CARE_CATGY_XREF.LVL_OF_CARE_SEQ_NBR as LVL_OF_CARE_SEQ_NBR,
trim(LVL_OF_CARE_CATGY_XREF.LVL_OF_CARE_RLLP_CATGY_TXT) as LVL_OF_CARE_RLLP_CATGY_TXT,
ETL.BTH_DT as BTH_DT,
ETL.MBR_SYS_ID as MBR_SYS_ID,
ETL.PERS_SYS_ID as PERS_SYS_ID,
COALESCE(PRD_PKG_ALT.PKG_SYS_ID,-1) as PKG_SYS_ID,
COALESCE(CUS_GRP_ALT.GRP_SYS_ID, -1) as GRP_SYS_ID,
CRR_CLM_SRVC.CLM_SRVC_PROC_MOD_2_CD as CLM_TRANS_PROC_MOD_2_CD,
CRR_CLM_SRVC.CLM_SRVC_PROC_MOD_3_CD as CLM_TRANS_PROC_MOD_3_CD,
CRR_CLM_SRVC.CLM_SRVC_PROC_MOD_4_CD as CLM_TRANS_PROC_MOD_4_CD,
trim(CRR_CLM_SRVC.CLM_SRVC_RVNU_CD) as CLM_TRANS_RVNU_CD,
Coalesce(TB_PROC_1.PROC_DESC,''Unknown'') as CLM_TRANS_RVNU_DESC,
(case when CRR_CLM_HEAD.CLM_FM_TYP_CD = ''1'' and CRR_CLM_SRVC.CLM_SRVC_RVNU_CD is not null then CRR_CLM_SRVC.clm_srvc_proc_cd
      when CRR_CLM_HEAD.CLM_FM_TYP_CD = ''2'' and CRR_CLM_SRVC.CLM_SRVC_PROC_CD is not null then CRR_CLM_SRVC.clm_srvc_rvnu_cd
 else '''' end) as CLM_TRANS_SEC_PROC_CD,
Coalesce(TB_PROC_2.PROC_TYP_CD,''U'') as CLM_TRANS_SEC_PROC_TYP_CD,
Coalesce(TB_PROC_2.PROC_DESC,''Unknown'') as CLM_TRANS_SEC_PROC_DESC,
CRR_CLM_SRVC.SRC_FINC_LIAB_CD as SRC_FINC_LIAB_CD,
CRR_CLM_SRVC.DERIV_OBH_FINC_LIAB as DERIV_OBH_FINC_LIAB,
COALESCE(CRR_CLM_HEAD.CLM_MBR_DEPN_NBR,'''') as CLM_MBR_DEPN_NBR,
coalesce(CRR_CLM_HEAD.CLM_MBR_MKT_DERIV_NBR,'''') as CLM_MBR_MKT_DERIV_NBR,
coalesce(CRR_CLM_HEAD.CLM_CO_CD,'''') as CLM_CO_CD,
coalesce(CRR_CLM_HEAD.CLM_LVL_RSN_CD,'''') as CLM_LVL_RSN_CD,
coalesce(CRR_CLM_HEAD.CLM_LVL_RSN_CD_DESC,'''') as CLM_LVL_RSN_CD_DESC,
coalesce(CRR_CLM_HEAD.CLM_CES_FINC_ARNG_CD,'''') as CLM_CES_FINC_ARNG_CD,
coalesce(CRR_CLM_HEAD.CLM_MKT_SEG_CD,'''') as CLM_MKT_SEG_CD,
coalesce(CRR_CLM_HEAD.CLM_MHSA_PRDCT_CD,'''') as CLM_MHSA_PRDCT_CD,
coalesce(CRR_CLM_HEAD.CLM_MHSA_PRDCT_DESC,'''') as CLM_MHSA_PRDCT_DESC,
CRR_CLM_SRVC.CLM_SRC_PROV_CLM_REF_NPI_ID as CLM_SRC_PROV_CLM_REF_NPI_ID,
CRR_CLM_SRVC.CLM_SRC_PROV_CLM_RNDR_NPI_ID as CLM_SRC_PROV_CLM_RNDR_NPI_ID,
CRR_CLM_SRVC.CLM_SRC_PROV_CLM_BIL_NPI_ID  as CLM_SRC_PROV_CLM_BIL_NPI_ID     
FROM
ETL_CLM_MBR_SYS_ID ETL
INNER JOIN
COMPACT.TB_CLM_CRR_CLM_SRVC CRR_CLM_SRVC
ON CRR_CLM_SRVC.CRR_CLM_SRVC_SYS_ID = ETL.CRR_CLM_SRVC_SYS_ID
INNER JOIN COMPACT.TB_CLM_CRR_CLM_HEAD CRR_CLM_HEAD
ON CRR_CLM_SRVC.CRR_CLM_HEAD_SYS_ID = CRR_CLM_HEAD.CRR_CLM_HEAD_SYS_ID
INNER JOIN COMPACT.CRR_CLAIMLINEADJUDICATION  CRR_CLAIMLINEADJUDICATION
ON CRR_CLAIMLINEADJUDICATION.CLAIMID = CRR_CLM_SRVC.CLM_AUD_NBR
--AND RIGHT(''000''+CONVERT(VARCHAR(10), CRR_CLAIMLINEADJUDICATION.CLAIMLINENUM),3) = CRR_CLM_SRVC.CLM_AUD_LN_NBR
AND CRR_CLAIMLINEADJUDICATION.IS_ACTIVE=''Y'' AND CRR_CLAIMLINEADJUDICATION.CDC_FLAG<>''D'' and CRR_CLAIMLINEADJUDICATION.CLASTATUS IN (''A'', ''D'')
AND CRR_CLAIMLINEADJUDICATION.BENEFITCLAIND = 1
INNER JOIN COMPACT.CRR_CLABENEFIT  CRR_CLABENEFIT
ON CRR_CLABENEFIT.CLAIMLINEADJUDICATIONID = CRR_CLAIMLINEADJUDICATION.CLAIMLINEADJUDICATIONID
AND CRR_CLABENEFIT.IS_ACTIVE=''Y'' AND CRR_CLABENEFIT.CDC_FLAG<>''D''
LEFT OUTER JOIN  COMPACT.TB_DIAG TB_DIAG_1
ON CRR_CLM_SRVC.CLM_SRVC_DIAG_1_CD=TB_DIAG_1.DIAG_CD
and CRR_CLM_SRVC.CLM_SRVC_FROM_DT  between TB_DIAG_1.DIAG_EFF_DT and TB_DIAG_1.DIAG_EXPR_DT
and CRR_CLM_SRVC.ICD_DIAG_TYP_CD = TB_DIAG_1.ICD_DIAG_TYP_CD
LEFT OUTER JOIN  COMPACT.TB_DIAG TB_DIAG_2
ON CRR_CLM_SRVC.CLM_SRVC_DIAG_2_CD=TB_DIAG_2.DIAG_CD
and CRR_CLM_SRVC.CLM_SRVC_FROM_DT  between TB_DIAG_2.DIAG_EFF_DT and TB_DIAG_2.DIAG_EXPR_DT
and CRR_CLM_SRVC.ICD_DIAG_TYP_CD = TB_DIAG_2.ICD_DIAG_TYP_CD
LEFT OUTER JOIN  COMPACT.TB_DIAG TB_DIAG_3
ON CRR_CLM_SRVC.CLM_SRVC_DIAG_3_CD=TB_DIAG_3.DIAG_CD
and CRR_CLM_SRVC.CLM_SRVC_FROM_DT  between TB_DIAG_3.DIAG_EFF_DT and TB_DIAG_3.DIAG_EXPR_DT
and CRR_CLM_SRVC.ICD_DIAG_TYP_CD = TB_DIAG_3.ICD_DIAG_TYP_CD
 
LEFT OUTER JOIN COMPACT.TB_PROC TB_PROC
ON (case when CRR_CLM_HEAD.CLM_FM_TYP_CD=''1'' then CRR_CLM_SRVC.CLM_SRVC_RVNU_CD else CRR_CLM_SRVC.CLM_SRVC_PROC_CD end)=TB_PROC.PROC_CD
and CRR_CLM_HEAD.CLM_FM_TYP_CD =TB_PROC.CLM_FM_TYP_CD
 
LEFT OUTER JOIN COMPACT.TB_PROC TB_PROC_1
ON CRR_CLM_SRVC.CLM_SRVC_RVNU_CD=TB_PROC_1.PROC_CD
and CRR_CLM_HEAD.CLM_FM_TYP_CD =TB_PROC_1.CLM_FM_TYP_CD
 
LEFT OUTER JOIN COMPACT.TB_PROC TB_PROC_2
ON (case when CRR_CLM_HEAD.CLM_FM_TYP_CD = ''1'' and CRR_CLM_SRVC.CLM_SRVC_RVNU_CD is not null then CRR_CLM_SRVC.CLM_SRVC_PROC_CD
         when CRR_CLM_HEAD.CLM_FM_TYP_CD = ''2'' and CRR_CLM_SRVC.CLM_SRVC_PROC_CD is not null then CRR_CLM_SRVC.CLM_SRVC_RVNU_CD
         else null end)=TB_PROC_2.PROC_CD
 
LEFT OUTER JOIN COMPACT.TB_SYS_DERIV_LVL_OF_CARE_CATGY_XREF LVL_OF_CARE_CATGY_XREF
ON TRIM(CRR_CLM_SRVC.LVL_OF_CARE_DERIV_TXT)=TRIM(LVL_OF_CARE_CATGY_XREF.LVL_OF_CARE_DERIV_TXT)
 
--LEFT OUTER JOIN #DMSchema#.LOAD_TB_DIM_CLM_TRANS LD
--ON CRR_CLM_SRVC.CRR_CLM_SRVC_SYS_ID = LD.CLM_ETL_DW_SYS_ID and LD.CLM_AUD_SRC_SYS_CD = ''CRR''
 
LEFT OUTER JOIN COMPACT.CRR_MEMBERBENEFIT  CRR_MEMBERBENEFIT
ON CRR_CLABENEFIT.MEMBERBENEFITID = CRR_MEMBERBENEFIT.MEMBERBENEFITID
AND CRR_MEMBERBENEFIT.IS_ACTIVE=''Y'' AND CRR_MEMBERBENEFIT.CDC_FLAG<>''D''
 
LEFT OUTER JOIN COMPACT.CRR_MEMGROUPCONTRACT  CRR_MEMGROUPCONTRACT
ON CRR_MEMBERBENEFIT.MEMGROUPID = CRR_MEMGROUPCONTRACT.MEMGROUPID
AND  CRR_CLM_SRVC.CLM_SRVC_FROM_DT BETWEEN CRR_MEMGROUPCONTRACT.EFFECTIVEDATE AND CRR_MEMGROUPCONTRACT.EXPIRATIONDATE
AND CRR_MEMGROUPCONTRACT.IS_ACTIVE=''Y'' AND CRR_MEMGROUPCONTRACT.CDC_FLAG<>''D''
 
LEFT OUTER JOIN COMPACT.TB_CUS_GRP_ALT CUS_GRP_ALT
ON CAST(CUS_GRP_ALT.GRP_ALT_ID AS VARCHAR) = CAST(CRR_MEMBERBENEFIT.MEMGROUPID AS VARCHAR) AND TRIM(CUS_GRP_ALT.REC_INPUT_SRC_CD) = ''CRR''
AND CRR_MEMBERBENEFIT.IS_ACTIVE=''Y'' AND CRR_MEMBERBENEFIT.CDC_FLAG<>''D''
 
 
LEFT OUTER JOIN COMPACT.TB_PRD_PKG_ALT PRD_PKG_ALT
ON PRD_PKG_ALT.PKG_ALT_ID = CRR_MEMBERBENEFIT.MEMGROUPCONTRACTID||''-''||CRR_MEMBERBENEFIT.PLANOPTIONID  AND
TRIM(PRD_PKG_ALT.REC_INPUT_SRC_CD) = ''CRR''
AND CRR_MEMBERBENEFIT.IS_ACTIVE=''Y'' AND CRR_MEMBERBENEFIT.CDC_FLAG<>''D''
 
 
UNION ALL
 
SELECT DISTINCT
(case when CRR_CLM_SRVC.CLM_SRVC_FROM_DT >=''2003-01-01'' then 1 else 0 end) as NET_DTL_FLG,
CRR_CLM_SRVC.CLM_AUD_NBR as CLM_AUD_NBR,
CRR_CLM_SRVC.REC_INPUT_SRC_CD as REC_INPUT_SRC_CD,
CRR_CLM_SRVC.CLM_AUD_LN_NBR as CLM_AUD_LN_NBR,
CRR_CLM_SRVC.PROV_SRVC_CTY_NM as PROV_SRVC_CTY_NM,
CRR_CLM_SRVC.PROV_SRVC_ST_CD as PROV_SRVC_ST_CD,
CRR_CLM_SRVC.CLM_SRVC_SRC_PROV_ID as CLM_SRVC_SRC_PROV_ID,
CRR_CLM_SRVC.CLM_SRVC_ADJ_CD as CLM_SRVC_ADJ_CD,
CRR_CLM_SRVC.CLM_SRVC_BEN_LVL_DERIV_CD as CLM_SRVC_BEN_LVL_DERIV_CD,
CRR_CLM_SRVC.CLM_SRVC_BEN_LVL_SRC_CD as CLM_SRVC_BEN_LVL_SRC_CD,
CRR_CLM_SRVC.CLM_CHK_NBR as CLM_CHK_NBR,
Coalesce(CRR_CLM_SRVC.CLM_SRVC_DIAG_1_CD,'''') as CLM_SRVC_DIAG_1_CD,
Coalesce(CRR_CLM_SRVC.CLM_SRVC_DIAG_2_CD,'''') as CLM_SRVC_DIAG_2_CD,
Coalesce(CRR_CLM_SRVC.CLM_SRVC_DIAG_3_CD,'''') as CLM_SRVC_DIAG_3_CD,
CRR_CLM_SRVC.DIAG_SBSTNC_ABUS_FLG as DIAG_SBSTNC_ABUS_FLG,
CRR_CLM_SRVC.LVL_OF_CARE_DERIV_TXT as LVL_OF_CARE_DERIV_TXT,
CRR_CLM_SRVC.CLM_SRVC_PD_DT as CLM_SRVC_PD_DT,
CRR_CLM_SRVC.CLM_SRVC_PST_DT as CLM_SRVC_PST_DT,
COALESCE(CRR_CLM_SRVC.CLM_SRVC_FROM_DT,''1900-01-01'') as CLM_SRVC_FROM_DT,
COALESCE(CRR_CLM_SRVC.CLM_SRVC_THRU_DT,''1900-01-01'') as CLM_SRVC_THRU_DT,
CRR_CLM_SRVC.LVL_OF_SRVC_DERIV_CD as LVL_OF_SRVC_DERIV_CD,
CRR_CLM_SRVC.LVL_OF_SRVC_SRC_CD as LVL_OF_SRVC_SRC_CD,
CRR_CLM_SRVC.PL_OF_SRVC_AMA_CD as PL_OF_SRVC_AMA_CD,
CRR_CLM_SRVC.CLM_SRVC_PROC_MOD_CD as CLM_SRVC_PROC_MOD_CD,
CRR_CLM_SRVC.CLM_SRVC_RVNU_CD as CLM_SRVC_RVNU_CD,
CRR_CLM_SRVC.CLM_SRVC_PROC_CD as CLM_SRVC_PROC_CD,
CRR_CLM_SRVC.CLM_SRVC_UNIT_OF_MSR_DESC as CLM_SRVC_UNIT_OF_MSR_DESC,
CRR_CLM_SRVC.CLM_SRVC_PROV_IN_NTWK_CD as CLM_SRVC_PROV_IN_NTWK_CD,
CRR_CLM_SRVC.PROV_TAX_ID as PROV_TAX_ID,
CRR_CLM_SRVC.PROV_SRVC_ZIP_CD as PROV_SRVC_ZIP_CD,
CRR_CLM_SRVC.PROV_NPI_ID as PROV_NPI_ID,
CRR_CLM_SRVC.PYMT_OVRIDE_CD as PYMT_OVRIDE_CD,
CRR_CLM_SRVC.PYMT_EOB_RSN_CD as PYMT_EOB_RSN_CD,
CRR_CLM_SRVC.PYMT_EOB_RSN_CD_DESC as PYMT_EOB_RSN_CD_DESC,
coalesce(CRR_CLM_SRVC.AUTH_SYS_ID,-1) as AUTH_SYS_ID,
CRR_CLM_SRVC.CLM_AUTH_NBR as CLM_AUTH_NBR, 
CRR_CLM_SRVC.CRR_CLM_SRVC_SYS_ID as CRR_CLM_SRVC_SYS_ID,
CRR_CLM_SRVC.PROV_PAYE_NM as PROV_PAYE_NM,
trim(CRR_CLM_SRVC.PRI_PAYE_CD) as PRI_PAYE_CD,
CRR_CLM_SRVC.PRI_PAYE_CD_DESC as PRI_PAYE_CD_DESC,
CRR_CLM_SRVC.ICD_DIAG_TYP_CD as ICD_DIAG_TYP_CD,
coalesce(CRR_CLM_SRVC.PROV_SYS_ID,-1) as PROV_SYS_ID,
(CASE WHEN ADJ.AMT_ADJ_ALLW_AMT >= 9999999.99 THEN 9999999.99 ELSE ADJ.AMT_ADJ_ALLW_AMT END) AS AMT_ALLW_AMT,
(CASE WHEN ADJ.AMT_ADJ_ALLW_DERIV_AMT >= 9999999.99 THEN 9999999.99 ELSE ADJ.AMT_ADJ_ALLW_DERIV_AMT END) AS AMT_ALLW_DERIV_AMT,
(CASE WHEN ADJ.AMT_ADJ_COPAY_AMT >= 9999999.99 THEN 9999999.99 ELSE ADJ.AMT_ADJ_COPAY_AMT END) AS AMT_COPAY_AMT,
(CASE WHEN ADJ.AMT_ADJ_DED_AMT >= 9999999.99 THEN 9999999.99 ELSE ADJ.AMT_ADJ_DED_AMT END) AS AMT_DED_AMT,
(CASE WHEN ADJ.AMT_ADJ_DSALLW_AMT >= 9999999.99 THEN 9999999.99 ELSE ADJ.AMT_ADJ_DSALLW_AMT END) AS AMT_DSALLW_AMT,
(CASE WHEN ADJ.AMT_ADJ_MBR_RESP_AMT >= 9999999.99 THEN 9999999.99 ELSE ADJ.AMT_ADJ_MBR_RESP_AMT END) AS AMT_MBR_RESP_AMT,
(CASE WHEN ADJ.AMT_ADJ_PD_AMT >= 9999999.99 THEN 9999999.99 ELSE ADJ.AMT_ADJ_PD_AMT END) AS AMT_PD_AMT,
(CASE WHEN ADJ.AMT_ADJ_SBMT_AMT >= 9999999.99 THEN 9999999.99 ELSE ADJ.AMT_ADJ_SBMT_AMT END) AS AMT_SBMT_AMT,
ADJ.CLM_ADJ_SRVC_UNIT_CNT as CLM_ADJ_SRVC_UNIT_CNT,
ADJ.CLM_SRVC_UNIT_DERIV_CNT AS CLM_SRVC_UNIT_DERIV_CNT,
ADJ.AMT_ADJ_COB_AMT AS CLM_TOT_COB_SV_AMT,  
ADJ.AMT_ADJ_COINS_AMT AS CLM_TOT_COPAY_COINS_AMT,
CRR_CLM_HEAD.CLM_MBR_SRC_MBR_SYS_ID as CLM_MBR_SRC_MBR_SYS_ID,
trim(CRR_CLM_HEAD.CLM_MBR_GDR_CD) as CLM_MBR_GDR_CD,
trim(CRR_CLM_HEAD.CLM_MBR_REL_CD) as CLM_MBR_REL_CD,
CRR_CLM_HEAD.CLM_SRVC_AUTH_NBR as CLM_SRVC_AUTH_NBR,
CRR_CLM_HEAD.CLM_MBR_SRC_SBSCR_ID as CLM_MBR_SRC_SBSCR_ID,
CRR_CLM_HEAD.CLM_SRC_CUST_CONTR_ID as CLM_SRC_CUST_CONTR_ID,
CRR_CLM_HEAD.CLM_MBR_SRC_SGRP_ID as CLM_MBR_SRC_SGRP_ID,
(CASE WHEN CLAIMPAYONSETOFFSETVIEW.PROCESSDATE is not null then CLAIMPAYONSETOFFSETVIEW.PROCESSDATE else CRR_CLM_SRVC.CLM_SRVC_ADJD_DT END) as CLM_ADJD_DT,
trim(CRR_CLM_HEAD.CLM_FM_TYP_CD) as CLM_FM_TYP_CD,
CRR_CLM_HEAD.CLM_ENT_DT as CLM_ENT_DT,
CRR_CLM_HEAD.CLM_RECV_DT as CLM_RECV_DT,
CRR_CLM_HEAD.CLM_SBMT_SRC_DESC as CLM_SBMT_SRC_DESC,
CRR_CLM_HEAD.CLM_PRI_DIAG_CD as CLM_PRI_DIAG_CD,
COALESCE(CRR_CLM_HEAD.ADMIT_DT,''1900-01-01'') as ADMIT_DT,
trim(CRR_CLM_HEAD.ADMIT_TYP_CD) as ADMIT_TYP_CD,
trim(CRR_CLM_HEAD.ADMIT_SRC_CD) as ADMIT_SRC_CD,
CRR_CLM_HEAD.CLM_FST_SRVC_DT as CLM_FST_SRVC_DT,
CRR_CLM_HEAD.CLM_LST_SRVC_DT as CLM_LST_SRVC_DT,
trim(CRR_CLM_HEAD.ADJD_BIL_TYP_CD) as ADJD_BIL_TYP_CD,
trim(CRR_CLM_HEAD.DSCHRG_STS_CD) as DSCHRG_STS_CD,
trim(CRR_CLM_HEAD.ADJD_DIAG_REL_GRP_CD) as ADJD_DIAG_REL_GRP_CD,
trim(CRR_CLM_HEAD.SBMT_DIAG_REL_GRP_CD) as SBMT_DIAG_REL_GRP_CD,
Coalesce(TB_DIAG_1.DIAG_CATGY_DERIV_DESC,''Unknown'') as DIAG_CATGY_DERIV_DESC_1,
Coalesce(TB_DIAG_1.DIAG_DERIV_DESC,''Unknown'') as DIAG_DERIV_DESC_1,
Coalesce(TB_DIAG_1.DIAG_DERIV_TYP_CD,''U'') as DIAG_DERIV_TYP_CD_1,
Coalesce(TB_DIAG_1.DSM_TYP_CD,''U'') as DSM_TYP_CD_1,
Coalesce((case when trim(TB_DIAG_1.DIAG_DERIV_TYP_CD)=''EAP'' Then ''MH''
               when trim(TB_DIAG_1.MH_SA_CD)='''' Then ''MH''
               else TB_DIAG_1.MH_SA_CD end),''MH'') as MH_SA_CD,
Coalesce(TB_DIAG_2.DIAG_CATGY_DERIV_DESC,''Unknown'') as DIAG_CATGY_DERIV_DESC_2,
Coalesce(TB_DIAG_2.DIAG_DERIV_DESC,''Unknown'') as DIAG_DERIV_DESC_2,
Coalesce(TB_DIAG_2.DIAG_DERIV_TYP_CD,''U'') as DIAG_DERIV_TYP_CD_2,
Coalesce(TB_DIAG_2.DSM_TYP_CD,''U'') as DSM_TYP_CD_2,
Coalesce(TB_DIAG_3.DIAG_CATGY_DERIV_DESC,''Unknown'') as DIAG_CATGY_DERIV_DESC_3,
Coalesce(TB_DIAG_3.DIAG_DERIV_DESC,''Unknown'') as DIAG_DERIV_DESC_3,
Coalesce(TB_DIAG_3.DIAG_DERIV_TYP_CD,''U'') as DIAG_DERIV_TYP_CD_3,
Coalesce(TB_DIAG_3.DSM_TYP_CD,''U'') as DSM_TYP_CD_3,
TB_PROC.PROC_DESC as PROC_DESC,
trim(TB_PROC.PROC_TYP_CD) as PROC_TYP_CD,
LVL_OF_CARE_CATGY_XREF.LVL_OF_CARE_SEQ_NBR as LVL_OF_CARE_SEQ_NBR,
trim(LVL_OF_CARE_CATGY_XREF.LVL_OF_CARE_RLLP_CATGY_TXT) as LVL_OF_CARE_RLLP_CATGY_TXT,
ETL.BTH_DT as BTH_DT,
ETL.MBR_SYS_ID as MBR_SYS_ID,
ETL.PERS_SYS_ID as PERS_SYS_ID,
COALESCE(PRD_PKG_ALT.PKG_SYS_ID,-1) as PKG_SYS_ID,
COALESCE(CUS_GRP_ALT.GRP_SYS_ID, -1) as GRP_SYS_ID,
CRR_CLM_SRVC.CLM_SRVC_PROC_MOD_2_CD as CLM_TRANS_PROC_MOD_2_CD,
CRR_CLM_SRVC.CLM_SRVC_PROC_MOD_3_CD as CLM_TRANS_PROC_MOD_3_CD,
CRR_CLM_SRVC.CLM_SRVC_PROC_MOD_4_CD as CLM_TRANS_PROC_MOD_4_CD,
trim(CRR_CLM_SRVC.CLM_SRVC_RVNU_CD) as CLM_TRANS_RVNU_CD,
Coalesce(TB_PROC_1.PROC_DESC,''Unknown'') as CLM_TRANS_RVNU_DESC,
(case when CRR_CLM_HEAD.CLM_FM_TYP_CD = ''1'' and CRR_CLM_SRVC.CLM_SRVC_RVNU_CD is not null then CRR_CLM_SRVC.clm_srvc_proc_cd
      when CRR_CLM_HEAD.CLM_FM_TYP_CD = ''2'' and CRR_CLM_SRVC.CLM_SRVC_PROC_CD is not null then CRR_CLM_SRVC.clm_srvc_rvnu_cd
 else '''' end) as CLM_TRANS_SEC_PROC_CD,
Coalesce(TB_PROC_2.PROC_TYP_CD,''U'') as CLM_TRANS_SEC_PROC_TYP_CD,
Coalesce(TB_PROC_2.PROC_DESC,''Unknown'') as CLM_TRANS_SEC_PROC_DESC,
CRR_CLM_SRVC.SRC_FINC_LIAB_CD as SRC_FINC_LIAB_CD,
CRR_CLM_SRVC.DERIV_OBH_FINC_LIAB as DERIV_OBH_FINC_LIAB,
COALESCE(CRR_CLM_HEAD.CLM_MBR_DEPN_NBR,'''') as CLM_MBR_DEPN_NBR,
coalesce(CRR_CLM_HEAD.CLM_MBR_MKT_DERIV_NBR,'''') as CLM_MBR_MKT_DERIV_NBR,
coalesce(CRR_CLM_HEAD.CLM_CO_CD,'''') as CLM_CO_CD,
coalesce(CRR_CLM_HEAD.CLM_LVL_RSN_CD,'''') as CLM_LVL_RSN_CD,
coalesce(CRR_CLM_HEAD.CLM_LVL_RSN_CD_DESC,'''') as CLM_LVL_RSN_CD_DESC,
coalesce(CRR_CLM_HEAD.CLM_CES_FINC_ARNG_CD,'''') as CLM_CES_FINC_ARNG_CD,
coalesce(CRR_CLM_HEAD.CLM_MKT_SEG_CD,'''') as CLM_MKT_SEG_CD,
coalesce(CRR_CLM_HEAD.CLM_MHSA_PRDCT_CD,'''') as CLM_MHSA_PRDCT_CD,
coalesce(CRR_CLM_HEAD.CLM_MHSA_PRDCT_DESC,'''') as CLM_MHSA_PRDCT_DESC,
CRR_CLM_SRVC.CLM_SRC_PROV_CLM_REF_NPI_ID as CLM_SRC_PROV_CLM_REF_NPI_ID,
CRR_CLM_SRVC.CLM_SRC_PROV_CLM_RNDR_NPI_ID as CLM_SRC_PROV_CLM_RNDR_NPI_ID,
CRR_CLM_SRVC.CLM_SRC_PROV_CLM_BIL_NPI_ID as CLM_SRC_PROV_CLM_BIL_NPI_ID     
FROM
ETL_CLM_MBR_SYS_ID ETL
INNER JOIN
COMPACT.TB_CLM_CRR_CLM_SRVC CRR_CLM_SRVC
ON CRR_CLM_SRVC.CRR_CLM_SRVC_SYS_ID = ETL.CRR_CLM_SRVC_SYS_ID
INNER JOIN COMPACT.TB_CLM_CRR_CLM_HEAD CRR_CLM_HEAD
ON CRR_CLM_SRVC.CRR_CLM_HEAD_SYS_ID = CRR_CLM_HEAD.CRR_CLM_HEAD_SYS_ID
INNER JOIN COMPACT.TB_CLM_CRR_CLM_ADJ ADJ ON CRR_CLM_SRVC.CLM_AUD_NBR = ADJ.CLM_AUD_NBR and CRR_CLM_SRVC.CLM_AUD_LN_NBR = ADJ.CLM_AUD_LN_NBR
 
INNER JOIN COMPACT.CRR_CLAIMLINEADJUDICATION  CRR_CLAIMLINEADJUDICATION
ON CRR_CLAIMLINEADJUDICATION.CLAIMID = CRR_CLM_SRVC.CLM_AUD_NBR
--AND RIGHT(''000''+CONVERT(VARCHAR(10), CRR_CLAIMLINEADJUDICATION.CLAIMLINENUM),3) = CRR_CLM_SRVC.CLM_AUD_LN_NBR
AND CRR_CLAIMLINEADJUDICATION.IS_ACTIVE=''Y'' AND CRR_CLAIMLINEADJUDICATION.CDC_FLAG<>''D'' and CRR_CLAIMLINEADJUDICATION.CLASTATUS IN (''A'', ''D'')
AND CRR_CLAIMLINEADJUDICATION.BENEFITCLAIND = 1
 
INNER JOIN COMPACT.CRR_CLABENEFIT  CRR_CLABENEFIT
ON CRR_CLABENEFIT.CLAIMLINEADJUDICATIONID = CRR_CLAIMLINEADJUDICATION.CLAIMLINEADJUDICATIONID
AND CRR_CLABENEFIT.IS_ACTIVE=''Y'' AND CRR_CLABENEFIT.CDC_FLAG<>''D''
 
LEFT OUTER JOIN  COMPACT.TB_DIAG TB_DIAG_1
ON CRR_CLM_SRVC.CLM_SRVC_DIAG_1_CD=TB_DIAG_1.DIAG_CD
and CRR_CLM_SRVC.CLM_SRVC_FROM_DT  between TB_DIAG_1.DIAG_EFF_DT and TB_DIAG_1.DIAG_EXPR_DT
and CRR_CLM_SRVC.ICD_DIAG_TYP_CD = TB_DIAG_1.ICD_DIAG_TYP_CD
 
LEFT OUTER JOIN  COMPACT.TB_DIAG TB_DIAG_2
ON CRR_CLM_SRVC.CLM_SRVC_DIAG_2_CD=TB_DIAG_2.DIAG_CD
and CRR_CLM_SRVC.CLM_SRVC_FROM_DT  between TB_DIAG_2.DIAG_EFF_DT and TB_DIAG_2.DIAG_EXPR_DT
and CRR_CLM_SRVC.ICD_DIAG_TYP_CD = TB_DIAG_2.ICD_DIAG_TYP_CD
 
LEFT OUTER JOIN  COMPACT.TB_DIAG TB_DIAG_3
ON CRR_CLM_SRVC.CLM_SRVC_DIAG_3_CD=TB_DIAG_3.DIAG_CD
and CRR_CLM_SRVC.CLM_SRVC_FROM_DT  between TB_DIAG_3.DIAG_EFF_DT and TB_DIAG_3.DIAG_EXPR_DT
and CRR_CLM_SRVC.ICD_DIAG_TYP_CD = TB_DIAG_3.ICD_DIAG_TYP_CD
 
LEFT OUTER JOIN COMPACT.TB_PROC TB_PROC
ON (case when CRR_CLM_HEAD.CLM_FM_TYP_CD=''1'' then CRR_CLM_SRVC.CLM_SRVC_RVNU_CD else CRR_CLM_SRVC.CLM_SRVC_PROC_CD end)=TB_PROC.PROC_CD
and CRR_CLM_HEAD.CLM_FM_TYP_CD =TB_PROC.CLM_FM_TYP_CD
 
LEFT OUTER JOIN COMPACT.TB_PROC TB_PROC_1
ON TRIM(CRR_CLM_SRVC.CLM_SRVC_RVNU_CD)=TRIM(TB_PROC_1.PROC_CD)
and TRIM(CRR_CLM_HEAD.CLM_FM_TYP_CD) =TRIM(TB_PROC_1.CLM_FM_TYP_CD)
 
LEFT OUTER JOIN COMPACT.TB_PROC TB_PROC_2
ON (case when CRR_CLM_HEAD.CLM_FM_TYP_CD = ''1'' and CRR_CLM_SRVC.CLM_SRVC_RVNU_CD is not null then CRR_CLM_SRVC.CLM_SRVC_PROC_CD
         when CRR_CLM_HEAD.CLM_FM_TYP_CD = ''2'' and CRR_CLM_SRVC.CLM_SRVC_PROC_CD is not null then CRR_CLM_SRVC.CLM_SRVC_RVNU_CD
         else null end)=TB_PROC_2.PROC_CD
 
LEFT OUTER JOIN COMPACT.TB_SYS_DERIV_LVL_OF_CARE_CATGY_XREF LVL_OF_CARE_CATGY_XREF
ON TRIM(CRR_CLM_SRVC.LVL_OF_CARE_DERIV_TXT)=TRIM(LVL_OF_CARE_CATGY_XREF.LVL_OF_CARE_DERIV_TXT)
 
--LEFT OUTER JOIN #DMSchema#.LOAD_TB_DIM_CLM_TRANS LD
--ON ADJ.CRR_CLM_SRVC_SYS_ID = LD.CLM_ETL_DW_SYS_ID and LD.CLM_AUD_SRC_SYS_CD = ''CRR''
LEFT OUTER JOIN COMPACT.CRR_MEMBERBENEFIT  CRR_MEMBERBENEFIT
ON CRR_CLABENEFIT.MEMBERBENEFITID = CRR_MEMBERBENEFIT.MEMBERBENEFITID
AND CRR_MEMBERBENEFIT.IS_ACTIVE=''Y'' AND CRR_MEMBERBENEFIT.CDC_FLAG<>''D''
 
LEFT OUTER JOIN COMPACT.CRR_CLAIMPAYONSETOFFSETVIEW CLAIMPAYONSETOFFSETVIEW
ON CLAIMPAYONSETOFFSETVIEW.CLAIMID = CRR_CLM_SRVC.CLM_AUD_NBR
AND RIGHT(''000''+ CLAIMPAYONSETOFFSETVIEW.CLAIMLINENUM,3) = CRR_CLM_SRVC.CLM_AUD_LN_NBR
and CLAIMPAYONSETOFFSETVIEW.FINACTIVITYDESC=''Offset''
 
LEFT OUTER JOIN COMPACT.CRR_MEMGROUPCONTRACT  CRR_MEMGROUPCONTRACT
ON CRR_MEMBERBENEFIT.MEMGROUPID = CRR_MEMGROUPCONTRACT.MEMGROUPID
AND  CRR_CLM_SRVC.CLM_SRVC_FROM_DT BETWEEN CRR_MEMGROUPCONTRACT.EFFECTIVEDATE AND CRR_MEMGROUPCONTRACT.EXPIRATIONDATE
AND CRR_MEMGROUPCONTRACT.IS_ACTIVE=''Y'' AND CRR_MEMGROUPCONTRACT.CDC_FLAG<>''D''
 
LEFT OUTER JOIN COMPACT.TB_CUS_GRP_ALT CUS_GRP_ALT
ON CAST(CUS_GRP_ALT.GRP_ALT_ID AS VARCHAR) = CAST(CRR_MEMBERBENEFIT.MEMGROUPID AS VARCHAR) AND TRIM(CUS_GRP_ALT.REC_INPUT_SRC_CD) = ''CRR''
AND CRR_MEMBERBENEFIT.IS_ACTIVE=''Y'' AND CRR_MEMBERBENEFIT.CDC_FLAG<>''D''
 
LEFT OUTER JOIN COMPACT.TB_PRD_PKG_ALT PRD_PKG_ALT
ON PRD_PKG_ALT.PKG_ALT_ID = CRR_MEMBERBENEFIT.MEMGROUPCONTRACTID||''-''||CRR_MEMBERBENEFIT.PLANOPTIONID  AND
TRIM(PRD_PKG_ALT.REC_INPUT_SRC_CD) = ''CRR''
AND CRR_MEMBERBENEFIT.IS_ACTIVE=''Y'' AND CRR_MEMBERBENEFIT.CDC_FLAG<>''D'') DM qualify row_number() OVER (PARTITION BY DM.CRR_CLM_SRVC_SYS_ID ORDER BY DM.CRR_CLM_SRVC_SYS_ID) =1 ) ;
 
CREATE OR REPLACE TEMPORARY TABLE TB_DIM_FCT_CLM_TRANS_CRR AS
SELECT
TMP.CLM_AUD_NBR as CLM_AUD_SRC_ID,
TMP.REC_INPUT_SRC_CD as CLM_AUD_SRC_SYS_CD,
TMP.CLM_AUD_NBR as CLM_AUD_NBR,
TMP.CLM_AUD_LN_NBR AS CLM_AUD_LN_NBR,
-1 as CLM_AUD_TRANS_SEQ_NBR,
TMP.CLM_SRVC_AUTH_NBR as CLM_SRC_AUTH_NBR,
'''' as CLM_SRC_COSM_DIV_CD,
0 as CLM_SRC_DOC_CNTL_NBR,
'''' as CLM_SRC_LEG_ENTY_NBR,
TMP.CLM_MBR_SRC_SGRP_ID as CLM_SRC_MBR_ACCT_NBR,
TMP.CLM_SRC_CUST_CONTR_ID as CLM_SRC_MBR_CUST_SEG_NBR,
TMP.CLM_MBR_DEPN_NBR as CLM_SRC_MBR_DEPN_CD,
'''' as CLM_SRC_MBR_FAM_ID,
TMP.CLM_MBR_GDR_CD as CLM_SRC_MBR_GDR_CD,
TMP.CLM_MBR_SRC_SGRP_ID as CLM_SRC_MBR_GRP_ID,
TMP.CLM_MBR_MKT_DERIV_NBR as CLM_SRC_MBR_MKT_DERIV_NBR,
'''' as CLM_SRC_MBR_NON_UHG_EE_FLG,
'''' as CLM_SRC_MBR_PLN_ID,
'''' as CLM_SRC_MBR_PRDCT_CD,
TMP.CLM_MBR_REL_CD as CLM_SRC_MBR_REL_CD,
TMP.CLM_MBR_SRC_SBSCR_ID as CLM_SRC_MBR_SBSCR_ID,
TMP.CLM_MBR_SRC_MBR_SYS_ID as CLM_SRC_MBR_SYS_ID,
TMP.PROV_SRVC_CTY_NM as CLM_SRC_PROV_SRVC_CTY_NM,
TMP.PROV_SRVC_ST_CD as CLM_SRC_PROV_SRVC_ST_CD,
TMP.CLM_SRVC_SRC_PROV_ID as CLM_SRC_PROV_SYS_ID,
'''' as CLM_SRC_RIOS_BUS_UNIT_ID,
TMP.CLM_CO_CD as CLM_SRC_UNET_CO_CD,
'''' as CLM_TRANS_ACCOM_FLG,
TMP.CLM_SRVC_ADJ_CD as CLM_TRANS_ADJ_CD,
TMP.CLM_SRVC_BEN_LVL_DERIV_CD as CLM_TRANS_BEN_LVL_DERIV_CD,
TMP.CLM_SRVC_BEN_LVL_SRC_CD as CLM_TRANS_BEN_LVL_SRC_CD,
TMP.CLM_CHK_NBR as CLM_TRANS_CHK_NBR,
TMP.CLM_FM_TYP_CD as CLM_TRANS_CLM_FM_TYP_CD,
TMP.CLM_SRVC_DIAG_1_CD as CLM_TRANS_DIAG_1_CD,
TMP.DIAG_CATGY_DERIV_DESC_1 as CLM_TRANS_DIAG_1_CD_CATGY_DESC,
TMP.DIAG_DERIV_DESC_1 as CLM_TRANS_DIAG_1_CD_DESC,
TMP.DIAG_DERIV_TYP_CD_1 as CLM_TRANS_DIAG_1_CD_TYP_CD,
TMP.CLM_SRVC_DIAG_2_CD as CLM_TRANS_DIAG_2_CD,
TMP.DIAG_CATGY_DERIV_DESC_2 as CLM_TRANS_DIAG_2_CD_CATGY_DESC,
TMP.DIAG_DERIV_DESC_2 as CLM_TRANS_DIAG_2_CD_DESC,
TMP.DIAG_DERIV_TYP_CD_2 as CLM_TRANS_DIAG_2_CD_TYP_CD,
TMP.CLM_SRVC_DIAG_3_CD as CLM_TRANS_DIAG_3_CD,
TMP.DIAG_CATGY_DERIV_DESC_3 as CLM_TRANS_DIAG_3_CD_CATGY_DESC,
TMP.DIAG_DERIV_DESC_3 as CLM_TRANS_DIAG_3_CD_DESC,
TMP.DIAG_DERIV_TYP_CD_3 as CLM_TRANS_DIAG_3_CD_TYP_CD,
TMP.MH_SA_CD as CLM_TRANS_DIAG_MH_SA_CD,
TMP.DIAG_SBSTNC_ABUS_FLG as CLM_TRANS_DIAG_SBSTNC_ABUS_FLG,
TMP.LVL_OF_CARE_DERIV_TXT as CLM_TRANS_DLOC_TXT,
TMP.LVL_OF_CARE_SEQ_NBR as CLM_TRANS_DLOC_SEQ_NBR,
TMP.LVL_OF_CARE_RLLP_CATGY_TXT as CLM_TRANS_DLOC_CATGY_TXT,
TMP.CLM_ADJD_DT as CLM_TRANS_DT_ADJD_DT,
TMP.CLM_ENT_DT as CLM_TRANS_DT_ENT_DT,
TMP.CLM_SRVC_PD_DT as CLM_TRANS_DT_PD_DT,
TMP.CLM_RECV_DT as CLM_TRANS_DT_RCVD_DT,
TMP.CLM_SRVC_PST_DT as CLM_TRANS_DT_PST_DT,
TMP.CLM_SRVC_FROM_DT as CLM_TRANS_DT_SRVC_FROM_DT,
TMP.CLM_SRVC_THRU_DT as CLM_TRANS_DT_SRVC_THRU_DT,
TMP.LVL_OF_SRVC_DERIV_CD as CLM_TRANS_LVL_OF_SRVC_DERIV_CD,
TMP.LVL_OF_SRVC_SRC_CD as CLM_TRANS_LVL_OF_SRVC_SRC_CD,

  CAST(BTH_DT AS STRING) AS svDobValidate,
  CASE WHEN svDobValidate <> ''-1'' And substr(BTH_DT,1,4) > ''1800'' 
      Then (substr(CLM_FST_SRVC_DT,1,4) - substr(BTH_DT,1,4)) * 12 + (substr(CLM_FST_SRVC_DT,6,2) - substr(BTH_DT,6,2)) Else 0 END AS svAgeInMths,
  CASE WHEN svAgeInMths > 1600 or svAgeInMths < 0 Then 0 Else svAgeInMths END AS CLM_TRANS_MBR_IN_MO_AGE,
  
  
--case when nvl(BTH_DT,''-1'') <> ''-1'' And substr(BTH_DT,1,4) > ''1800'' Then
--(substr(CLM_SRVC_FROM_DT,1,4) - substr(BTH_DT,1,4)) * 12 + substr(CLM_SRVC_FROM_DT ,6,2) - substr(CLM_SRVC_FROM_DT,1,4) 
--Else 0 end as CLM_TRANS_MBR_IN_MO_AGE, --stage veriable
TMP.PL_OF_SRVC_AMA_CD as CLM_TRANS_PL_OF_SRVC_AMA_CD,
'''' as CLM_TRANS_PL_OF_SRVC_SRC_CD,
CASE WHEN trim(tmp.CLM_FM_TYP_CD)=''1'' then tmp.CLM_SRVC_RVNU_CD else tmp.CLM_SRVC_PROC_CD end as CLM_TRANS_PROC_CD,
case when Len(Trim(nvl(tmp.PROC_DESC,''''))) = 0 Then ''Unknown'' Else Trim(nvl(tmp.PROC_DESC,'''')) end as CLM_TRANS_PROC_DESC,
TMP.CLM_SRVC_PROC_MOD_CD as CLM_TRANS_PROC_MOD_CD,
case when Len(Trim(nvl(tmp.PROC_TYP_CD,''''))) = 0 Then ''U'' Else Trim(nvl(tmp.PROC_TYP_CD,'''')) end as CLM_TRANS_PROC_TYP_CD,
TMP.CLM_SRVC_UNIT_OF_MSR_DESC as CLM_TRANS_PROC_UNIT_OF_MSR_TXT,
TMP.CLM_SRVC_PROV_IN_NTWK_CD as CLM_TRANS_PROV_NTWK_DERIV_CD,
TMP.PYMT_EOB_RSN_CD as CLM_TRANS_RSN_CD,
TMP.PYMT_EOB_RSN_CD_DESC as CLM_TRANS_RSN_DESC,
'''' as CLM_TRANS_UNET_CAP_FND_CD,
'''' as CLM_TRANS_UNET_CAP_FND_DRIV_CD,
'''' as CLM_TRANS_UNET_RDUC_RSN_CD,
'''' as CLM_TRANS_UNET_RDUC_RSN_DESC,
'''' as CLM_SRC_MBR_JOB_CATGY_CD,
'''' as CLM_SRC_MBR_JOB_SITE_CD,
TMP.PROV_TAX_ID as CLM_SRC_PROV_TAX_ID_NBR,
TMP.PROV_PAYE_NM as CLM_SRC_PROV_PAYE_NM,
TMP.PROV_SRVC_ZIP_CD as CLM_SRC_PROV_SRVC_ZIP_CD,
TMP.PROV_NPI_ID as CLM_SRC_PROV_CLM_NPI_ID,
'''' as CLM_TRANS_UNET_OBLG_CD,
'''' as CLM_TRANS_UNET_SHR_ARNG_CD,
'''' as CLM_TRANS_UNET_BEN_LVL_CAUS_CD,
'''' as CLM_TRANS_ADJD_ID,
'''' as CLM_TRANS_PROC_ADJD_OFC_DESC,
'''' as CLM_TRANS_PYMT_OVRIDE_CD,
'''' as CLM_TRANS_PYMT_OVRIDE_FLG,
TMP.CLM_SBMT_SRC_DESC as CLM_TRANS_SBMT_SRC_DESC,
0 as CLM_TRANS_RSN_TYP_CD,
TMP.CLM_PRI_DIAG_CD as CLM_TRANS_CLM_PRI_DIAG_CD,
TMP.ADMIT_DT as CLM_TRANS_DT_ADMIT_DT,
TMP.ADMIT_TYP_CD as CLM_TRANS_ADMIT_TYP_CD,
TMP.ADMIT_SRC_CD as CLM_TRANS_ADMIT_SRC_CD,
TMP.CLM_FST_SRVC_DT as CLM_TRANS_DT_CLM_FST_SRVC_DT,
TMP.CLM_LST_SRVC_DT as CLM_TRANS_DT_CLM_LST_SRVC_DT,
TMP.ADJD_BIL_TYP_CD as CLM_TRANS_BILL_TYP_CD,
TMP.DSCHRG_STS_CD as CLM_TRANS_DSCHRG_STS_CD,
TMP.ADJD_DIAG_REL_GRP_CD as CLM_TRANS_SYS_DIAG_REL_GRP_CD,
TMP.SBMT_DIAG_REL_GRP_CD as CLM_TRANS_ENT_DIAG_REL_GRP_CD,
TMP.CLM_LVL_RSN_CD as CLM_TRANS_CLM_LVL_RSN_CD,
TMP.CLM_LVL_RSN_CD_DESC as CLM_TRANS_CLM_LVL_RSN_CD_DESC,
'''' as CLM_TRANS_UNET_HE_MBR_MKT_NBR,
TMP.CLM_CES_FINC_ARNG_CD as CLM_TRANS_UNET_CES_FINC_ARNG_CD,
'''' as CLM_TRANS_UNET_CES_CUST_NBR,
'''' as CLM_TRANS_UNET_CES_GRP_NBR,
TMP.CLM_MKT_SEG_CD as CLM_TRANS_UNET_CLM_MKT_SEG_CD,
'''' as CLM_TRANS_UNET_LD_PRTN_CD,
TMP.CLM_MHSA_PRDCT_CD as CLM_TRANS_UNET_MHSA_PRDCT_CD,
TMP.CLM_MHSA_PRDCT_DESC as CLM_TRANS_UNET_MHSA_PRDCT_DESC,
'''' as CLM_TRANS_UNET_PLN_VAR_SUBDIV_CD,
'''' as CLM_TRANS_UNET_RPT_CD_BR_CD,
TMP.PYMT_EOB_RSN_CD as CLM_TRANS_EOB_RSN_CD,
TMP.PYMT_EOB_RSN_CD_DESC as CLM_TRANS_EOB_RSN_CD_DESC,
TMP.AUTH_SYS_ID as CLM_TRANS_CAC_AUTH_SYS_ID,
TMP.CLM_AUTH_NBR as CLM_TRANS_AUTH_NBR,
'''' as CLM_TRANS_SUPP_ORDR_IND,
'''' as CLM_TRANS_EXTR_BEN_NBR,
'''' as CLM_TRANS_EXTR_AGCY_ID,
'''' as CLM_TRANS_EXTR_DEPN_NBR,
TMP.CRR_CLM_SRVC_SYS_ID as CLM_ETL_DW_SYS_ID,
TMP.CLM_SRVC_FROM_DT as CLM_ETL_DW_FROM_DT,
current_timestamp() as REC_CRT_DTTM,
current_timestamp() as REC_UPDT_DTTM,
2741 as CARE_MGT_MKT_SYS_ID,
TMP.GRP_SYS_ID as GRP_SYS_ID,
-1 as MBR_ELIG_SYS_ID,
case when tmp.MBR_SYS_ID > 0  Then tmp.MBR_SYS_ID Else -1 end as MBR_SYS_ID,
case when tmp.PERS_SYS_ID> 0 Then  tmp.PERS_SYS_ID Else -1 end as PERS_SYS_ID,
TMP.PKG_SYS_ID as PKG_SYS_ID,
case when tmp.PROV_SYS_ID > 0  Then tmp.PROV_SYS_ID Else -1 end as PROV_SYS_ID,
19 as SALE_CHNL_SYS_ID,
TMP.AMT_ALLW_AMT as CLM_TRANS_ALLW_AMT,
TMP.AMT_ALLW_DERIV_AMT as CLM_TRANS_ALLW_DERIV_AMT,
TMP.CLM_TOT_COB_SV_AMT as CLM_TRANS_COB_AMT,
TMP.CLM_TOT_COPAY_COINS_AMT as CLM_TRANS_COINS_AMT,
TMP.AMT_ALLW_AMT as CLM_TRANS_CONTR_AMT,
TMP.AMT_COPAY_AMT as CLM_TRANS_COPAY_AMT,
TMP.AMT_DED_AMT as CLM_TRANS_DED_AMT,
TMP.AMT_DSALLW_AMT as CLM_TRANS_DSALLW_AMT,
0 as CLM_TRANS_DSCNT_AMT,
TMP.AMT_MBR_RESP_AMT as CLM_TRANS_MBR_RESP_AMT,
TMP.AMT_PD_AMT as CLM_TRANS_PD_AMT,
0 as CLM_TRANS_RSRV_AMT,
TMP.AMT_SBMT_AMT as CLM_TRANS_SBMT_AMT,
TMP.CLM_SRVC_UNIT_CNT as CLM_TRANS_UNIT_CNT,
TMP.CLM_SRVC_UNIT_DERIV_CNT as CLM_TRANS_UNIT_DERIV_CNT,
-1 as CLM_MBR_ATTR_SYS_ID,
TMP.NET_DTL_FLG as NET_DTL_FLG,
TMP.PRI_PAYE_CD as PRI_PAYE_CD,
TMP.PRI_PAYE_CD_DESC as PRI_PAYE_CD_DESC,
TMP.ICD_DIAG_TYP_CD as ICD_DIAG_TYP_CD,
'''' as BIL_RVNU_CD,
TMP.DSM_TYP_CD_1 as CLM_TRANS_DIAG_1_DSM_TYP_CD,
TMP.DSM_TYP_CD_2 as CLM_TRANS_DIAG_2_DSM_TYP_CD,
TMP.DSM_TYP_CD_3 as CLM_TRANS_DIAG_3_DSM_TYP_CD,
TMP.CLM_TRANS_PROC_MOD_2_CD as CLM_TRANS_PROC_MOD_2_CD,
TMP.CLM_TRANS_PROC_MOD_3_CD as CLM_TRANS_PROC_MOD_3_CD,
TMP.CLM_TRANS_PROC_MOD_4_CD as CLM_TRANS_PROC_MOD_4_CD,
TMP.CLM_TRANS_RVNU_CD as CLM_TRANS_RVNU_CD,
TMP.CLM_TRANS_RVNU_DESC as CLM_TRANS_RVNU_DESC,
TMP.CLM_TRANS_SEC_PROC_CD as CLM_TRANS_SEC_PROC_CD,
TMP.CLM_TRANS_SEC_PROC_TYP_CD as CLM_TRANS_SEC_PROC_TYP_CD,
TMP.CLM_TRANS_SEC_PROC_DESC as CLM_TRANS_SEC_PROC_DESC,
TMP.SRC_FINC_LIAB_CD as SRC_FINC_LIAB_CD,
TMP.DERIV_OBH_FINC_LIAB as DERIV_OBH_FINC_LIAB,
'''' as CLM_SRC_PROV_CLM_SRVC_NPI_ID,
TMP.CLM_SRC_PROV_CLM_REF_NPI_ID as CLM_SRC_PROV_CLM_REF_NPI_ID,
'''' as CLM_SRC_PROV_CLM_FAC_NPI_ID,
TMP.CLM_SRC_PROV_CLM_RNDR_NPI_ID as CLM_SRC_PROV_CLM_RNDR_NPI_ID,
TMP.CLM_SRC_PROV_CLM_BIL_NPI_ID as CLM_SRC_PROV_CLM_BIL_NPI_ID,
'''' as CLM_SRC_PROV_CLM_PAYE_NPI_ID,
'''' as CLM_SRC_PROV_CLM_ADMIT_NPI_ID,
'''' as CLM_SRC_PROV_CLM_ATD_NPI_ID,
''False'' as PND_CLM_FLG,
'''' as CLM_TRANS_BIL_PROC_CD,
''Unknown'' as CLM_TRANS_BIL_PROC_DESC,
''U'' as CLM_TRANS_BIL_PROC_TYP_CD,
''U'' as CLM_TRANS_CLM_ST_OF_ISS,
'''' as CLM_TRANS_AGRMNT_ID,
'''' as CLM_TRANS_AGRMNT_DESC,
'''' as CSP_NTWX_PRCNG_CLM_BASED_ON,
'''' as CSP_NTWX_PRCNG_CLM_BASED_DESC,
'''' as CLM_TRANS_CLM_ACT_RATE_SRC,
'''' as CLM_TRANS_OON_MTHDLGY,
'''' as CSP_NTWX_PRCNG_CLM_VOL_TYP,
'''' as CSP_NTWX_PRCNG_CLM_RT,
'''' as CSP_NTWX_PRCNG_CLM_RT_TYP,
'''' as CLM_TRANS_CLM_ACT_RATE,
null as CLM_TRANS_UNET_ENG_CD
FROM TMP_TB_DIM_FCT_CLM_CRR TMP;



MERGE INTO FOUNDATION.TB_DIM_FCT_CLM_TRANS_CRR T
USING(
SELECT
CLM_AUD_SRC_ID,
CLM_AUD_SRC_SYS_CD,
CLM_AUD_NBR,
CLM_AUD_LN_NBR,
CLM_AUD_TRANS_SEQ_NBR,
CLM_SRC_AUTH_NBR,
CLM_SRC_COSM_DIV_CD,
CLM_SRC_DOC_CNTL_NBR,
CLM_SRC_LEG_ENTY_NBR,
CLM_SRC_MBR_ACCT_NBR,
CLM_SRC_MBR_CUST_SEG_NBR,
CLM_SRC_MBR_DEPN_CD,
CLM_SRC_MBR_FAM_ID,
CLM_SRC_MBR_GDR_CD,
CLM_SRC_MBR_GRP_ID,
CLM_SRC_MBR_MKT_DERIV_NBR,
CLM_SRC_MBR_NON_UHG_EE_FLG,
CLM_SRC_MBR_PLN_ID,
CLM_SRC_MBR_PRDCT_CD,
CLM_SRC_MBR_REL_CD,
CLM_SRC_MBR_SBSCR_ID,
CLM_SRC_MBR_SYS_ID,
CLM_SRC_PROV_SRVC_CTY_NM,
CLM_SRC_PROV_SRVC_ST_CD,
CLM_SRC_PROV_SYS_ID,
CLM_SRC_RIOS_BUS_UNIT_ID,
CLM_SRC_UNET_CO_CD,
CLM_TRANS_ACCOM_FLG,
CLM_TRANS_ADJ_CD,
CLM_TRANS_BEN_LVL_DERIV_CD,
CLM_TRANS_BEN_LVL_SRC_CD,
CLM_TRANS_CHK_NBR,
CLM_TRANS_CLM_FM_TYP_CD,
CLM_TRANS_DIAG_1_CD,
CLM_TRANS_DIAG_1_CD_CATGY_DESC,
CLM_TRANS_DIAG_1_CD_DESC,
CLM_TRANS_DIAG_1_CD_TYP_CD,
CLM_TRANS_DIAG_2_CD,
CLM_TRANS_DIAG_2_CD_CATGY_DESC,
CLM_TRANS_DIAG_2_CD_DESC,
CLM_TRANS_DIAG_2_CD_TYP_CD,
CLM_TRANS_DIAG_3_CD,
CLM_TRANS_DIAG_3_CD_CATGY_DESC,
CLM_TRANS_DIAG_3_CD_DESC,
CLM_TRANS_DIAG_3_CD_TYP_CD,
CLM_TRANS_DIAG_MH_SA_CD,
CLM_TRANS_DIAG_SBSTNC_ABUS_FLG,
CLM_TRANS_DLOC_TXT,
CLM_TRANS_DLOC_SEQ_NBR,
CLM_TRANS_DLOC_CATGY_TXT,
CLM_TRANS_DT_ADJD_DT,
CLM_TRANS_DT_ENT_DT,
CLM_TRANS_DT_PD_DT,
CLM_TRANS_DT_RCVD_DT,
CLM_TRANS_DT_PST_DT,
CLM_TRANS_DT_SRVC_FROM_DT,
CLM_TRANS_DT_SRVC_THRU_DT,
CLM_TRANS_LVL_OF_SRVC_DERIV_CD,
CLM_TRANS_LVL_OF_SRVC_SRC_CD,
CLM_TRANS_MBR_IN_MO_AGE,
CLM_TRANS_PL_OF_SRVC_AMA_CD,
CLM_TRANS_PL_OF_SRVC_SRC_CD,
CLM_TRANS_PROC_CD,
CLM_TRANS_PROC_DESC,
CLM_TRANS_PROC_MOD_CD,
CLM_TRANS_PROC_TYP_CD,
CLM_TRANS_PROC_UNIT_OF_MSR_TXT,
CLM_TRANS_PROV_NTWK_DERIV_CD,
CLM_TRANS_RSN_CD,
CLM_TRANS_RSN_DESC,
CLM_TRANS_UNET_CAP_FND_CD,
CLM_TRANS_UNET_CAP_FND_DRIV_CD,
CLM_TRANS_UNET_RDUC_RSN_CD,
CLM_TRANS_UNET_RDUC_RSN_DESC,
CLM_SRC_MBR_JOB_CATGY_CD,
CLM_SRC_MBR_JOB_SITE_CD,
CLM_SRC_PROV_TAX_ID_NBR,
CLM_SRC_PROV_PAYE_NM,
CLM_SRC_PROV_SRVC_ZIP_CD,
CLM_SRC_PROV_CLM_NPI_ID,
CLM_TRANS_UNET_OBLG_CD,
CLM_TRANS_UNET_SHR_ARNG_CD,
CLM_TRANS_UNET_BEN_LVL_CAUS_CD,
CLM_TRANS_ADJD_ID,
CLM_TRANS_PROC_ADJD_OFC_DESC,
CLM_TRANS_PYMT_OVRIDE_CD,
CLM_TRANS_PYMT_OVRIDE_FLG,
CLM_TRANS_SBMT_SRC_DESC,
CLM_TRANS_RSN_TYP_CD,
CLM_TRANS_CLM_PRI_DIAG_CD,
CLM_TRANS_DT_ADMIT_DT,
CLM_TRANS_ADMIT_TYP_CD,
CLM_TRANS_ADMIT_SRC_CD,
CLM_TRANS_DT_CLM_FST_SRVC_DT,
CLM_TRANS_DT_CLM_LST_SRVC_DT,
CLM_TRANS_BILL_TYP_CD,
CLM_TRANS_DSCHRG_STS_CD,
CLM_TRANS_SYS_DIAG_REL_GRP_CD,
CLM_TRANS_ENT_DIAG_REL_GRP_CD,
CLM_TRANS_CLM_LVL_RSN_CD,
CLM_TRANS_CLM_LVL_RSN_CD_DESC,
CLM_TRANS_UNET_HE_MBR_MKT_NBR,
CLM_TRANS_UNET_CES_FINC_ARNG_CD,
CLM_TRANS_UNET_CES_CUST_NBR,
CLM_TRANS_UNET_CES_GRP_NBR,
CLM_TRANS_UNET_CLM_MKT_SEG_CD,
CLM_TRANS_UNET_LD_PRTN_CD,
CLM_TRANS_UNET_MHSA_PRDCT_CD,
CLM_TRANS_UNET_MHSA_PRDCT_DESC,
CLM_TRANS_UNET_PLN_VAR_SUBDIV_CD,
CLM_TRANS_UNET_RPT_CD_BR_CD,
CLM_TRANS_EOB_RSN_CD,
CLM_TRANS_EOB_RSN_CD_DESC,
CLM_TRANS_CAC_AUTH_SYS_ID,
CLM_TRANS_AUTH_NBR,
CLM_TRANS_SUPP_ORDR_IND,
CLM_TRANS_EXTR_BEN_NBR,
CLM_TRANS_EXTR_AGCY_ID,
CLM_TRANS_EXTR_DEPN_NBR,
CLM_ETL_DW_SYS_ID,
CLM_ETL_DW_FROM_DT,
REC_CRT_DTTM,
REC_UPDT_DTTM,
CARE_MGT_MKT_SYS_ID,
GRP_SYS_ID,
MBR_ELIG_SYS_ID,
MBR_SYS_ID,
PERS_SYS_ID,
PKG_SYS_ID,
PROV_SYS_ID,
SALE_CHNL_SYS_ID,
CLM_TRANS_ALLW_AMT,
CLM_TRANS_ALLW_DERIV_AMT,
CLM_TRANS_COB_AMT,
CLM_TRANS_COINS_AMT,
CLM_TRANS_CONTR_AMT,
CLM_TRANS_COPAY_AMT,
CLM_TRANS_DED_AMT,
CLM_TRANS_DSALLW_AMT,
CLM_TRANS_DSCNT_AMT,
CLM_TRANS_MBR_RESP_AMT,
CLM_TRANS_PD_AMT,
CLM_TRANS_RSRV_AMT,
CLM_TRANS_SBMT_AMT,
CLM_TRANS_UNIT_CNT,
CLM_TRANS_UNIT_DERIV_CNT,
CLM_MBR_ATTR_SYS_ID,
NET_DTL_FLG,
PRI_PAYE_CD,
PRI_PAYE_CD_DESC,
ICD_DIAG_TYP_CD,
BIL_RVNU_CD,
CLM_TRANS_DIAG_1_DSM_TYP_CD,
CLM_TRANS_DIAG_2_DSM_TYP_CD,
CLM_TRANS_DIAG_3_DSM_TYP_CD,
CLM_TRANS_PROC_MOD_2_CD,
CLM_TRANS_PROC_MOD_3_CD,
CLM_TRANS_PROC_MOD_4_CD,
CLM_TRANS_RVNU_CD,
CLM_TRANS_RVNU_DESC,
CLM_TRANS_SEC_PROC_CD,
CLM_TRANS_SEC_PROC_TYP_CD,
CLM_TRANS_SEC_PROC_DESC,
SRC_FINC_LIAB_CD,
DERIV_OBH_FINC_LIAB,
CLM_SRC_PROV_CLM_SRVC_NPI_ID,
CLM_SRC_PROV_CLM_REF_NPI_ID,
CLM_SRC_PROV_CLM_FAC_NPI_ID,
CLM_SRC_PROV_CLM_RNDR_NPI_ID,
CLM_SRC_PROV_CLM_BIL_NPI_ID,
CLM_SRC_PROV_CLM_PAYE_NPI_ID,
CLM_SRC_PROV_CLM_ADMIT_NPI_ID,
CLM_SRC_PROV_CLM_ATD_NPI_ID,
PND_CLM_FLG,
CLM_TRANS_BIL_PROC_CD,
CLM_TRANS_BIL_PROC_DESC,
CLM_TRANS_BIL_PROC_TYP_CD,
CLM_TRANS_CLM_ST_OF_ISS,
CLM_TRANS_AGRMNT_ID,
CLM_TRANS_AGRMNT_DESC,
CSP_NTWX_PRCNG_CLM_BASED_ON,
CSP_NTWX_PRCNG_CLM_BASED_DESC,
CLM_TRANS_CLM_ACT_RATE_SRC,
CLM_TRANS_OON_MTHDLGY,
CSP_NTWX_PRCNG_CLM_VOL_TYP,
CSP_NTWX_PRCNG_CLM_RT,
CSP_NTWX_PRCNG_CLM_RT_TYP,
CLM_TRANS_CLM_ACT_RATE,
CLM_TRANS_UNET_ENG_CD
FROM TB_DIM_FCT_CLM_TRANS_CRR) as S ON (T.CLM_AUD_NBR = S.CLM_AUD_NBR AND T.CLM_AUD_SRC_SYS_CD = S.CLM_AUD_SRC_SYS_CD AND T.CLM_AUD_LN_NBR = S.CLM_AUD_LN_NBR)
WHEN MATCHED THEN UPDATE
SET 
T.CLM_AUD_SRC_ID = S.CLM_AUD_SRC_ID ,
T.CLM_AUD_TRANS_SEQ_NBR = S.CLM_AUD_TRANS_SEQ_NBR ,
T.CLM_SRC_AUTH_NBR = S.CLM_SRC_AUTH_NBR ,
T.CLM_SRC_COSM_DIV_CD = S.CLM_SRC_COSM_DIV_CD ,
T.CLM_SRC_DOC_CNTL_NBR = S.CLM_SRC_DOC_CNTL_NBR ,
T.CLM_SRC_LEG_ENTY_NBR = S.CLM_SRC_LEG_ENTY_NBR ,
T.CLM_SRC_MBR_ACCT_NBR = S.CLM_SRC_MBR_ACCT_NBR ,
T.CLM_SRC_MBR_CUST_SEG_NBR = S.CLM_SRC_MBR_CUST_SEG_NBR ,
T.CLM_SRC_MBR_DEPN_CD = S.CLM_SRC_MBR_DEPN_CD ,
T.CLM_SRC_MBR_FAM_ID = S.CLM_SRC_MBR_FAM_ID ,
T.CLM_SRC_MBR_GDR_CD = S.CLM_SRC_MBR_GDR_CD ,
T.CLM_SRC_MBR_GRP_ID = S.CLM_SRC_MBR_GRP_ID ,
T.CLM_SRC_MBR_MKT_DERIV_NBR = S.CLM_SRC_MBR_MKT_DERIV_NBR ,
T.CLM_SRC_MBR_NON_UHG_EE_FLG = S.CLM_SRC_MBR_NON_UHG_EE_FLG ,
T.CLM_SRC_MBR_PLN_ID = S.CLM_SRC_MBR_PLN_ID ,
T.CLM_SRC_MBR_PRDCT_CD = S.CLM_SRC_MBR_PRDCT_CD ,
T.CLM_SRC_MBR_REL_CD = S.CLM_SRC_MBR_REL_CD ,
T.CLM_SRC_MBR_SBSCR_ID = S.CLM_SRC_MBR_SBSCR_ID ,
T.CLM_SRC_MBR_SYS_ID = S.CLM_SRC_MBR_SYS_ID ,
T.CLM_SRC_PROV_SRVC_CTY_NM = S.CLM_SRC_PROV_SRVC_CTY_NM ,
T.CLM_SRC_PROV_SRVC_ST_CD = S.CLM_SRC_PROV_SRVC_ST_CD ,
T.CLM_SRC_PROV_SYS_ID = S.CLM_SRC_PROV_SYS_ID ,
T.CLM_SRC_RIOS_BUS_UNIT_ID = S.CLM_SRC_RIOS_BUS_UNIT_ID ,
T.CLM_SRC_UNET_CO_CD = S.CLM_SRC_UNET_CO_CD ,
T.CLM_TRANS_ACCOM_FLG = S.CLM_TRANS_ACCOM_FLG ,
T.CLM_TRANS_ADJ_CD = S.CLM_TRANS_ADJ_CD ,
T.CLM_TRANS_BEN_LVL_DERIV_CD = S.CLM_TRANS_BEN_LVL_DERIV_CD ,
T.CLM_TRANS_BEN_LVL_SRC_CD = S.CLM_TRANS_BEN_LVL_SRC_CD ,
T.CLM_TRANS_CHK_NBR = S.CLM_TRANS_CHK_NBR ,
T.CLM_TRANS_CLM_FM_TYP_CD = S.CLM_TRANS_CLM_FM_TYP_CD ,
T.CLM_TRANS_DIAG_1_CD = S.CLM_TRANS_DIAG_1_CD ,
T.CLM_TRANS_DIAG_1_CD_CATGY_DESC = S.CLM_TRANS_DIAG_1_CD_CATGY_DESC ,
T.CLM_TRANS_DIAG_1_CD_DESC = S.CLM_TRANS_DIAG_1_CD_DESC ,
T.CLM_TRANS_DIAG_1_CD_TYP_CD = S.CLM_TRANS_DIAG_1_CD_TYP_CD ,
T.CLM_TRANS_DIAG_2_CD = S.CLM_TRANS_DIAG_2_CD ,
T.CLM_TRANS_DIAG_2_CD_CATGY_DESC = S.CLM_TRANS_DIAG_2_CD_CATGY_DESC ,
T.CLM_TRANS_DIAG_2_CD_DESC = S.CLM_TRANS_DIAG_2_CD_DESC ,
T.CLM_TRANS_DIAG_2_CD_TYP_CD = S.CLM_TRANS_DIAG_2_CD_TYP_CD ,
T.CLM_TRANS_DIAG_3_CD = S.CLM_TRANS_DIAG_3_CD ,
T.CLM_TRANS_DIAG_3_CD_CATGY_DESC = S.CLM_TRANS_DIAG_3_CD_CATGY_DESC ,
T.CLM_TRANS_DIAG_3_CD_DESC = S.CLM_TRANS_DIAG_3_CD_DESC ,
T.CLM_TRANS_DIAG_3_CD_TYP_CD = S.CLM_TRANS_DIAG_3_CD_TYP_CD ,
T.CLM_TRANS_DIAG_MH_SA_CD = S.CLM_TRANS_DIAG_MH_SA_CD ,
T.CLM_TRANS_DIAG_SBSTNC_ABUS_FLG = S.CLM_TRANS_DIAG_SBSTNC_ABUS_FLG ,
T.CLM_TRANS_DLOC_TXT = S.CLM_TRANS_DLOC_TXT ,
T.CLM_TRANS_DLOC_SEQ_NBR = S.CLM_TRANS_DLOC_SEQ_NBR ,
T.CLM_TRANS_DLOC_CATGY_TXT = S.CLM_TRANS_DLOC_CATGY_TXT ,
T.CLM_TRANS_DT_ADJD_DT = S.CLM_TRANS_DT_ADJD_DT ,
T.CLM_TRANS_DT_ENT_DT = S.CLM_TRANS_DT_ENT_DT ,
T.CLM_TRANS_DT_PD_DT = S.CLM_TRANS_DT_PD_DT ,
T.CLM_TRANS_DT_RCVD_DT = S.CLM_TRANS_DT_RCVD_DT ,
T.CLM_TRANS_DT_PST_DT = S.CLM_TRANS_DT_PST_DT ,
T.CLM_TRANS_DT_SRVC_FROM_DT = S.CLM_TRANS_DT_SRVC_FROM_DT ,
T.CLM_TRANS_DT_SRVC_THRU_DT = S.CLM_TRANS_DT_SRVC_THRU_DT ,
T.CLM_TRANS_LVL_OF_SRVC_DERIV_CD = S.CLM_TRANS_LVL_OF_SRVC_DERIV_CD ,
T.CLM_TRANS_LVL_OF_SRVC_SRC_CD = S.CLM_TRANS_LVL_OF_SRVC_SRC_CD ,
T.CLM_TRANS_MBR_IN_MO_AGE = S.CLM_TRANS_MBR_IN_MO_AGE ,
T.CLM_TRANS_PL_OF_SRVC_AMA_CD = S.CLM_TRANS_PL_OF_SRVC_AMA_CD ,
T.CLM_TRANS_PL_OF_SRVC_SRC_CD = S.CLM_TRANS_PL_OF_SRVC_SRC_CD ,
T.CLM_TRANS_PROC_CD = S.CLM_TRANS_PROC_CD ,
T.CLM_TRANS_PROC_DESC = S.CLM_TRANS_PROC_DESC ,
T.CLM_TRANS_PROC_MOD_CD = S.CLM_TRANS_PROC_MOD_CD ,
T.CLM_TRANS_PROC_TYP_CD = S.CLM_TRANS_PROC_TYP_CD ,
T.CLM_TRANS_PROC_UNIT_OF_MSR_TXT = S.CLM_TRANS_PROC_UNIT_OF_MSR_TXT ,
T.CLM_TRANS_PROV_NTWK_DERIV_CD = S.CLM_TRANS_PROV_NTWK_DERIV_CD ,
T.CLM_TRANS_RSN_CD = S.CLM_TRANS_RSN_CD ,
T.CLM_TRANS_RSN_DESC = S.CLM_TRANS_RSN_DESC ,
T.CLM_TRANS_UNET_CAP_FND_CD = S.CLM_TRANS_UNET_CAP_FND_CD ,
T.CLM_TRANS_UNET_CAP_FND_DRIV_CD = S.CLM_TRANS_UNET_CAP_FND_DRIV_CD ,
T.CLM_TRANS_UNET_RDUC_RSN_CD = S.CLM_TRANS_UNET_RDUC_RSN_CD ,
T.CLM_TRANS_UNET_RDUC_RSN_DESC = S.CLM_TRANS_UNET_RDUC_RSN_DESC ,
T.CLM_SRC_MBR_JOB_CATGY_CD = S.CLM_SRC_MBR_JOB_CATGY_CD ,
T.CLM_SRC_MBR_JOB_SITE_CD = S.CLM_SRC_MBR_JOB_SITE_CD ,
T.CLM_SRC_PROV_TAX_ID_NBR = S.CLM_SRC_PROV_TAX_ID_NBR ,
T.CLM_SRC_PROV_PAYE_NM = S.CLM_SRC_PROV_PAYE_NM ,
T.CLM_SRC_PROV_SRVC_ZIP_CD = S.CLM_SRC_PROV_SRVC_ZIP_CD ,
T.CLM_SRC_PROV_CLM_NPI_ID = S.CLM_SRC_PROV_CLM_NPI_ID ,
T.CLM_TRANS_UNET_OBLG_CD = S.CLM_TRANS_UNET_OBLG_CD ,
T.CLM_TRANS_UNET_SHR_ARNG_CD = S.CLM_TRANS_UNET_SHR_ARNG_CD ,
T.CLM_TRANS_UNET_BEN_LVL_CAUS_CD = S.CLM_TRANS_UNET_BEN_LVL_CAUS_CD ,
T.CLM_TRANS_ADJD_ID = S.CLM_TRANS_ADJD_ID ,
T.CLM_TRANS_PROC_ADJD_OFC_DESC = S.CLM_TRANS_PROC_ADJD_OFC_DESC ,
T.CLM_TRANS_PYMT_OVRIDE_CD = S.CLM_TRANS_PYMT_OVRIDE_CD ,
T.CLM_TRANS_PYMT_OVRIDE_FLG = S.CLM_TRANS_PYMT_OVRIDE_FLG ,
T.CLM_TRANS_SBMT_SRC_DESC = S.CLM_TRANS_SBMT_SRC_DESC ,
T.CLM_TRANS_RSN_TYP_CD = S.CLM_TRANS_RSN_TYP_CD ,
T.CLM_TRANS_CLM_PRI_DIAG_CD = S.CLM_TRANS_CLM_PRI_DIAG_CD ,
T.CLM_TRANS_DT_ADMIT_DT = S.CLM_TRANS_DT_ADMIT_DT ,
T.CLM_TRANS_ADMIT_TYP_CD = S.CLM_TRANS_ADMIT_TYP_CD ,
T.CLM_TRANS_ADMIT_SRC_CD = S.CLM_TRANS_ADMIT_SRC_CD ,
T.CLM_TRANS_DT_CLM_FST_SRVC_DT = S.CLM_TRANS_DT_CLM_FST_SRVC_DT ,
T.CLM_TRANS_DT_CLM_LST_SRVC_DT = S.CLM_TRANS_DT_CLM_LST_SRVC_DT ,
T.CLM_TRANS_BILL_TYP_CD = S.CLM_TRANS_BILL_TYP_CD ,
T.CLM_TRANS_DSCHRG_STS_CD = S.CLM_TRANS_DSCHRG_STS_CD ,
T.CLM_TRANS_SYS_DIAG_REL_GRP_CD = S.CLM_TRANS_SYS_DIAG_REL_GRP_CD ,
T.CLM_TRANS_ENT_DIAG_REL_GRP_CD = S.CLM_TRANS_ENT_DIAG_REL_GRP_CD ,
T.CLM_TRANS_CLM_LVL_RSN_CD = S.CLM_TRANS_CLM_LVL_RSN_CD ,
T.CLM_TRANS_CLM_LVL_RSN_CD_DESC = S.CLM_TRANS_CLM_LVL_RSN_CD_DESC ,
T.CLM_TRANS_UNET_HE_MBR_MKT_NBR = S.CLM_TRANS_UNET_HE_MBR_MKT_NBR ,
T.CLM_TRANS_UNET_CES_FINC_ARNG_CD = S.CLM_TRANS_UNET_CES_FINC_ARNG_CD ,
T.CLM_TRANS_UNET_CES_CUST_NBR = S.CLM_TRANS_UNET_CES_CUST_NBR ,
T.CLM_TRANS_UNET_CES_GRP_NBR = S.CLM_TRANS_UNET_CES_GRP_NBR ,
T.CLM_TRANS_UNET_CLM_MKT_SEG_CD = S.CLM_TRANS_UNET_CLM_MKT_SEG_CD ,
T.CLM_TRANS_UNET_LD_PRTN_CD = S.CLM_TRANS_UNET_LD_PRTN_CD ,
T.CLM_TRANS_UNET_MHSA_PRDCT_CD = S.CLM_TRANS_UNET_MHSA_PRDCT_CD ,
T.CLM_TRANS_UNET_MHSA_PRDCT_DESC = S.CLM_TRANS_UNET_MHSA_PRDCT_DESC ,
T.CLM_TRANS_UNET_PLN_VAR_SUBDIV_CD = S.CLM_TRANS_UNET_PLN_VAR_SUBDIV_CD ,
T.CLM_TRANS_UNET_RPT_CD_BR_CD = S.CLM_TRANS_UNET_RPT_CD_BR_CD ,
T.CLM_TRANS_EOB_RSN_CD = S.CLM_TRANS_EOB_RSN_CD ,
T.CLM_TRANS_EOB_RSN_CD_DESC = S.CLM_TRANS_EOB_RSN_CD_DESC ,
T.CLM_TRANS_CAC_AUTH_SYS_ID = S.CLM_TRANS_CAC_AUTH_SYS_ID ,
T.CLM_TRANS_AUTH_NBR = S.CLM_TRANS_AUTH_NBR ,
T.CLM_TRANS_SUPP_ORDR_IND = S.CLM_TRANS_SUPP_ORDR_IND ,
T.CLM_TRANS_EXTR_BEN_NBR = S.CLM_TRANS_EXTR_BEN_NBR ,
T.CLM_TRANS_EXTR_AGCY_ID = S.CLM_TRANS_EXTR_AGCY_ID ,
T.CLM_TRANS_EXTR_DEPN_NBR = S.CLM_TRANS_EXTR_DEPN_NBR ,
T.CLM_ETL_DW_SYS_ID = S.CLM_ETL_DW_SYS_ID ,
T.CLM_ETL_DW_FROM_DT = S.CLM_ETL_DW_FROM_DT ,
T.REC_CRT_DTTM = S.REC_CRT_DTTM ,
T.REC_UPDT_DTTM = S.REC_UPDT_DTTM ,
T.CARE_MGT_MKT_SYS_ID = S.CARE_MGT_MKT_SYS_ID ,
T.GRP_SYS_ID = S.GRP_SYS_ID ,
T.MBR_ELIG_SYS_ID = S.MBR_ELIG_SYS_ID ,
T.MBR_SYS_ID = S.MBR_SYS_ID ,
T.PERS_SYS_ID = S.PERS_SYS_ID ,
T.PKG_SYS_ID = S.PKG_SYS_ID ,
T.PROV_SYS_ID = S.PROV_SYS_ID ,
T.SALE_CHNL_SYS_ID = S.SALE_CHNL_SYS_ID ,
T.CLM_TRANS_ALLW_AMT = S.CLM_TRANS_ALLW_AMT ,
T.CLM_TRANS_ALLW_DERIV_AMT = S.CLM_TRANS_ALLW_DERIV_AMT ,
T.CLM_TRANS_COB_AMT = S.CLM_TRANS_COB_AMT ,
T.CLM_TRANS_COINS_AMT = S.CLM_TRANS_COINS_AMT ,
T.CLM_TRANS_CONTR_AMT = S.CLM_TRANS_CONTR_AMT ,
T.CLM_TRANS_COPAY_AMT = S.CLM_TRANS_COPAY_AMT ,
T.CLM_TRANS_DED_AMT = S.CLM_TRANS_DED_AMT ,
T.CLM_TRANS_DSALLW_AMT = S.CLM_TRANS_DSALLW_AMT ,
T.CLM_TRANS_DSCNT_AMT = S.CLM_TRANS_DSCNT_AMT ,
T.CLM_TRANS_MBR_RESP_AMT = S.CLM_TRANS_MBR_RESP_AMT ,
T.CLM_TRANS_PD_AMT = S.CLM_TRANS_PD_AMT ,
T.CLM_TRANS_RSRV_AMT = S.CLM_TRANS_RSRV_AMT ,
T.CLM_TRANS_SBMT_AMT = S.CLM_TRANS_SBMT_AMT ,
T.CLM_TRANS_UNIT_CNT = S.CLM_TRANS_UNIT_CNT ,
T.CLM_TRANS_UNIT_DERIV_CNT = S.CLM_TRANS_UNIT_DERIV_CNT ,
T.CLM_MBR_ATTR_SYS_ID = S.CLM_MBR_ATTR_SYS_ID ,
T.NET_DTL_FLG = S.NET_DTL_FLG ,
T.PRI_PAYE_CD = S.PRI_PAYE_CD ,
T.PRI_PAYE_CD_DESC = S.PRI_PAYE_CD_DESC ,
T.ICD_DIAG_TYP_CD = S.ICD_DIAG_TYP_CD ,
T.BIL_RVNU_CD = S.BIL_RVNU_CD ,
T.CLM_TRANS_DIAG_1_DSM_TYP_CD = S.CLM_TRANS_DIAG_1_DSM_TYP_CD ,
T.CLM_TRANS_DIAG_2_DSM_TYP_CD = S.CLM_TRANS_DIAG_2_DSM_TYP_CD ,
T.CLM_TRANS_DIAG_3_DSM_TYP_CD = S.CLM_TRANS_DIAG_3_DSM_TYP_CD ,
T.CLM_TRANS_PROC_MOD_2_CD = S.CLM_TRANS_PROC_MOD_2_CD ,
T.CLM_TRANS_PROC_MOD_3_CD = S.CLM_TRANS_PROC_MOD_3_CD ,
T.CLM_TRANS_PROC_MOD_4_CD = S.CLM_TRANS_PROC_MOD_4_CD ,
T.CLM_TRANS_RVNU_CD = S.CLM_TRANS_RVNU_CD ,
T.CLM_TRANS_RVNU_DESC = S.CLM_TRANS_RVNU_DESC ,
T.CLM_TRANS_SEC_PROC_CD = S.CLM_TRANS_SEC_PROC_CD ,
T.CLM_TRANS_SEC_PROC_TYP_CD = S.CLM_TRANS_SEC_PROC_TYP_CD ,
T.CLM_TRANS_SEC_PROC_DESC = S.CLM_TRANS_SEC_PROC_DESC ,
T.SRC_FINC_LIAB_CD = S.SRC_FINC_LIAB_CD ,
T.DERIV_OBH_FINC_LIAB = S.DERIV_OBH_FINC_LIAB ,
T.CLM_SRC_PROV_CLM_SRVC_NPI_ID = S.CLM_SRC_PROV_CLM_SRVC_NPI_ID ,
T.CLM_SRC_PROV_CLM_REF_NPI_ID = S.CLM_SRC_PROV_CLM_REF_NPI_ID ,
T.CLM_SRC_PROV_CLM_FAC_NPI_ID = S.CLM_SRC_PROV_CLM_FAC_NPI_ID ,
T.CLM_SRC_PROV_CLM_RNDR_NPI_ID = S.CLM_SRC_PROV_CLM_RNDR_NPI_ID ,
T.CLM_SRC_PROV_CLM_BIL_NPI_ID = S.CLM_SRC_PROV_CLM_BIL_NPI_ID ,
T.CLM_SRC_PROV_CLM_PAYE_NPI_ID = S.CLM_SRC_PROV_CLM_PAYE_NPI_ID ,
T.CLM_SRC_PROV_CLM_ADMIT_NPI_ID = S.CLM_SRC_PROV_CLM_ADMIT_NPI_ID ,
T.CLM_SRC_PROV_CLM_ATD_NPI_ID = S.CLM_SRC_PROV_CLM_ATD_NPI_ID ,
T.PND_CLM_FLG = S.PND_CLM_FLG ,
T.CLM_TRANS_BIL_PROC_CD = S.CLM_TRANS_BIL_PROC_CD ,
T.CLM_TRANS_BIL_PROC_DESC = S.CLM_TRANS_BIL_PROC_DESC ,
T.CLM_TRANS_BIL_PROC_TYP_CD = S.CLM_TRANS_BIL_PROC_TYP_CD ,
T.CLM_TRANS_CLM_ST_OF_ISS = S.CLM_TRANS_CLM_ST_OF_ISS ,
T.CLM_TRANS_AGRMNT_ID = S.CLM_TRANS_AGRMNT_ID ,
T.CLM_TRANS_AGRMNT_DESC = S.CLM_TRANS_AGRMNT_DESC ,
T.CSP_NTWX_PRCNG_CLM_BASED_ON = S.CSP_NTWX_PRCNG_CLM_BASED_ON ,
T.CSP_NTWX_PRCNG_CLM_BASED_DESC = S.CSP_NTWX_PRCNG_CLM_BASED_DESC ,
T.CLM_TRANS_CLM_ACT_RATE_SRC = S.CLM_TRANS_CLM_ACT_RATE_SRC ,
T.CLM_TRANS_OON_MTHDLGY = S.CLM_TRANS_OON_MTHDLGY ,
T.CSP_NTWX_PRCNG_CLM_VOL_TYP = S.CSP_NTWX_PRCNG_CLM_VOL_TYP ,
T.CSP_NTWX_PRCNG_CLM_RT = S.CSP_NTWX_PRCNG_CLM_RT ,
T.CSP_NTWX_PRCNG_CLM_RT_TYP = S.CSP_NTWX_PRCNG_CLM_RT_TYP ,
T.CLM_TRANS_CLM_ACT_RATE = S.CLM_TRANS_CLM_ACT_RATE ,
T.CLM_TRANS_UNET_ENG_CD = S.CLM_TRANS_UNET_ENG_CD 
WHEN NOT MATCHED THEN INSERT (
CLM_AUD_SRC_ID,
CLM_AUD_SRC_SYS_CD,
CLM_AUD_NBR,
CLM_AUD_LN_NBR,
CLM_AUD_TRANS_SEQ_NBR,
CLM_SRC_AUTH_NBR,
CLM_SRC_COSM_DIV_CD,
CLM_SRC_DOC_CNTL_NBR,
CLM_SRC_LEG_ENTY_NBR,
CLM_SRC_MBR_ACCT_NBR,
CLM_SRC_MBR_CUST_SEG_NBR,
CLM_SRC_MBR_DEPN_CD,
CLM_SRC_MBR_FAM_ID,
CLM_SRC_MBR_GDR_CD,
CLM_SRC_MBR_GRP_ID,
CLM_SRC_MBR_MKT_DERIV_NBR,
CLM_SRC_MBR_NON_UHG_EE_FLG,
CLM_SRC_MBR_PLN_ID,
CLM_SRC_MBR_PRDCT_CD,
CLM_SRC_MBR_REL_CD,
CLM_SRC_MBR_SBSCR_ID,
CLM_SRC_MBR_SYS_ID,
CLM_SRC_PROV_SRVC_CTY_NM,
CLM_SRC_PROV_SRVC_ST_CD,
CLM_SRC_PROV_SYS_ID,
CLM_SRC_RIOS_BUS_UNIT_ID,
CLM_SRC_UNET_CO_CD,
CLM_TRANS_ACCOM_FLG,
CLM_TRANS_ADJ_CD,
CLM_TRANS_BEN_LVL_DERIV_CD,
CLM_TRANS_BEN_LVL_SRC_CD,
CLM_TRANS_CHK_NBR,
CLM_TRANS_CLM_FM_TYP_CD,
CLM_TRANS_DIAG_1_CD,
CLM_TRANS_DIAG_1_CD_CATGY_DESC,
CLM_TRANS_DIAG_1_CD_DESC,
CLM_TRANS_DIAG_1_CD_TYP_CD,
CLM_TRANS_DIAG_2_CD,
CLM_TRANS_DIAG_2_CD_CATGY_DESC,
CLM_TRANS_DIAG_2_CD_DESC,
CLM_TRANS_DIAG_2_CD_TYP_CD,
CLM_TRANS_DIAG_3_CD,
CLM_TRANS_DIAG_3_CD_CATGY_DESC,
CLM_TRANS_DIAG_3_CD_DESC,
CLM_TRANS_DIAG_3_CD_TYP_CD,
CLM_TRANS_DIAG_MH_SA_CD,
CLM_TRANS_DIAG_SBSTNC_ABUS_FLG,
CLM_TRANS_DLOC_TXT,
CLM_TRANS_DLOC_SEQ_NBR,
CLM_TRANS_DLOC_CATGY_TXT,
CLM_TRANS_DT_ADJD_DT,
CLM_TRANS_DT_ENT_DT,
CLM_TRANS_DT_PD_DT,
CLM_TRANS_DT_RCVD_DT,
CLM_TRANS_DT_PST_DT,
CLM_TRANS_DT_SRVC_FROM_DT,
CLM_TRANS_DT_SRVC_THRU_DT,
CLM_TRANS_LVL_OF_SRVC_DERIV_CD,
CLM_TRANS_LVL_OF_SRVC_SRC_CD,
CLM_TRANS_MBR_IN_MO_AGE,
CLM_TRANS_PL_OF_SRVC_AMA_CD,
CLM_TRANS_PL_OF_SRVC_SRC_CD,
CLM_TRANS_PROC_CD,
CLM_TRANS_PROC_DESC,
CLM_TRANS_PROC_MOD_CD,
CLM_TRANS_PROC_TYP_CD,
CLM_TRANS_PROC_UNIT_OF_MSR_TXT,
CLM_TRANS_PROV_NTWK_DERIV_CD,
CLM_TRANS_RSN_CD,
CLM_TRANS_RSN_DESC,
CLM_TRANS_UNET_CAP_FND_CD,
CLM_TRANS_UNET_CAP_FND_DRIV_CD,
CLM_TRANS_UNET_RDUC_RSN_CD,
CLM_TRANS_UNET_RDUC_RSN_DESC,
CLM_SRC_MBR_JOB_CATGY_CD,
CLM_SRC_MBR_JOB_SITE_CD,
CLM_SRC_PROV_TAX_ID_NBR,
CLM_SRC_PROV_PAYE_NM,
CLM_SRC_PROV_SRVC_ZIP_CD,
CLM_SRC_PROV_CLM_NPI_ID,
CLM_TRANS_UNET_OBLG_CD,
CLM_TRANS_UNET_SHR_ARNG_CD,
CLM_TRANS_UNET_BEN_LVL_CAUS_CD,
CLM_TRANS_ADJD_ID,
CLM_TRANS_PROC_ADJD_OFC_DESC,
CLM_TRANS_PYMT_OVRIDE_CD,
CLM_TRANS_PYMT_OVRIDE_FLG,
CLM_TRANS_SBMT_SRC_DESC,
CLM_TRANS_RSN_TYP_CD,
CLM_TRANS_CLM_PRI_DIAG_CD,
CLM_TRANS_DT_ADMIT_DT,
CLM_TRANS_ADMIT_TYP_CD,
CLM_TRANS_ADMIT_SRC_CD,
CLM_TRANS_DT_CLM_FST_SRVC_DT,
CLM_TRANS_DT_CLM_LST_SRVC_DT,
CLM_TRANS_BILL_TYP_CD,
CLM_TRANS_DSCHRG_STS_CD,
CLM_TRANS_SYS_DIAG_REL_GRP_CD,
CLM_TRANS_ENT_DIAG_REL_GRP_CD,
CLM_TRANS_CLM_LVL_RSN_CD,
CLM_TRANS_CLM_LVL_RSN_CD_DESC,
CLM_TRANS_UNET_HE_MBR_MKT_NBR,
CLM_TRANS_UNET_CES_FINC_ARNG_CD,
CLM_TRANS_UNET_CES_CUST_NBR,
CLM_TRANS_UNET_CES_GRP_NBR,
CLM_TRANS_UNET_CLM_MKT_SEG_CD,
CLM_TRANS_UNET_LD_PRTN_CD,
CLM_TRANS_UNET_MHSA_PRDCT_CD,
CLM_TRANS_UNET_MHSA_PRDCT_DESC,
CLM_TRANS_UNET_PLN_VAR_SUBDIV_CD,
CLM_TRANS_UNET_RPT_CD_BR_CD,
CLM_TRANS_EOB_RSN_CD,
CLM_TRANS_EOB_RSN_CD_DESC,
CLM_TRANS_CAC_AUTH_SYS_ID,
CLM_TRANS_AUTH_NBR,
CLM_TRANS_SUPP_ORDR_IND,
CLM_TRANS_EXTR_BEN_NBR,
CLM_TRANS_EXTR_AGCY_ID,
CLM_TRANS_EXTR_DEPN_NBR,
CLM_ETL_DW_SYS_ID,
CLM_ETL_DW_FROM_DT,
REC_CRT_DTTM,
REC_UPDT_DTTM,
CARE_MGT_MKT_SYS_ID,
GRP_SYS_ID,
MBR_ELIG_SYS_ID,
MBR_SYS_ID,
PERS_SYS_ID,
PKG_SYS_ID,
PROV_SYS_ID,
SALE_CHNL_SYS_ID,
CLM_TRANS_ALLW_AMT,
CLM_TRANS_ALLW_DERIV_AMT,
CLM_TRANS_COB_AMT,
CLM_TRANS_COINS_AMT,
CLM_TRANS_CONTR_AMT,
CLM_TRANS_COPAY_AMT,
CLM_TRANS_DED_AMT,
CLM_TRANS_DSALLW_AMT,
CLM_TRANS_DSCNT_AMT,
CLM_TRANS_MBR_RESP_AMT,
CLM_TRANS_PD_AMT,
CLM_TRANS_RSRV_AMT,
CLM_TRANS_SBMT_AMT,
CLM_TRANS_UNIT_CNT,
CLM_TRANS_UNIT_DERIV_CNT,
CLM_MBR_ATTR_SYS_ID,
NET_DTL_FLG,
PRI_PAYE_CD,
PRI_PAYE_CD_DESC,
ICD_DIAG_TYP_CD,
BIL_RVNU_CD,
CLM_TRANS_DIAG_1_DSM_TYP_CD,
CLM_TRANS_DIAG_2_DSM_TYP_CD,
CLM_TRANS_DIAG_3_DSM_TYP_CD,
CLM_TRANS_PROC_MOD_2_CD,
CLM_TRANS_PROC_MOD_3_CD,
CLM_TRANS_PROC_MOD_4_CD,
CLM_TRANS_RVNU_CD,
CLM_TRANS_RVNU_DESC,
CLM_TRANS_SEC_PROC_CD,
CLM_TRANS_SEC_PROC_TYP_CD,
CLM_TRANS_SEC_PROC_DESC,
SRC_FINC_LIAB_CD,
DERIV_OBH_FINC_LIAB,
CLM_SRC_PROV_CLM_SRVC_NPI_ID,
CLM_SRC_PROV_CLM_REF_NPI_ID,
CLM_SRC_PROV_CLM_FAC_NPI_ID,
CLM_SRC_PROV_CLM_RNDR_NPI_ID,
CLM_SRC_PROV_CLM_BIL_NPI_ID,
CLM_SRC_PROV_CLM_PAYE_NPI_ID,
CLM_SRC_PROV_CLM_ADMIT_NPI_ID,
CLM_SRC_PROV_CLM_ATD_NPI_ID,
PND_CLM_FLG,
CLM_TRANS_BIL_PROC_CD,
CLM_TRANS_BIL_PROC_DESC,
CLM_TRANS_BIL_PROC_TYP_CD,
CLM_TRANS_CLM_ST_OF_ISS,
CLM_TRANS_AGRMNT_ID,
CLM_TRANS_AGRMNT_DESC,
CSP_NTWX_PRCNG_CLM_BASED_ON,
CSP_NTWX_PRCNG_CLM_BASED_DESC,
CLM_TRANS_CLM_ACT_RATE_SRC,
CLM_TRANS_OON_MTHDLGY,
CSP_NTWX_PRCNG_CLM_VOL_TYP,
CSP_NTWX_PRCNG_CLM_RT,
CSP_NTWX_PRCNG_CLM_RT_TYP,
CLM_TRANS_CLM_ACT_RATE,
CLM_TRANS_UNET_ENG_CD ) 
VALUES 
(S.CLM_AUD_SRC_ID,
S.CLM_AUD_SRC_SYS_CD,
S.CLM_AUD_NBR,
S.CLM_AUD_LN_NBR,
S.CLM_AUD_TRANS_SEQ_NBR,
S.CLM_SRC_AUTH_NBR,
S.CLM_SRC_COSM_DIV_CD,
S.CLM_SRC_DOC_CNTL_NBR,
S.CLM_SRC_LEG_ENTY_NBR,
S.CLM_SRC_MBR_ACCT_NBR,
S.CLM_SRC_MBR_CUST_SEG_NBR,
S.CLM_SRC_MBR_DEPN_CD,
S.CLM_SRC_MBR_FAM_ID,
S.CLM_SRC_MBR_GDR_CD,
S.CLM_SRC_MBR_GRP_ID,
S.CLM_SRC_MBR_MKT_DERIV_NBR,
S.CLM_SRC_MBR_NON_UHG_EE_FLG,
S.CLM_SRC_MBR_PLN_ID,
S.CLM_SRC_MBR_PRDCT_CD,
S.CLM_SRC_MBR_REL_CD,
S.CLM_SRC_MBR_SBSCR_ID,
S.CLM_SRC_MBR_SYS_ID,
S.CLM_SRC_PROV_SRVC_CTY_NM,
S.CLM_SRC_PROV_SRVC_ST_CD,
S.CLM_SRC_PROV_SYS_ID,
S.CLM_SRC_RIOS_BUS_UNIT_ID,
S.CLM_SRC_UNET_CO_CD,
S.CLM_TRANS_ACCOM_FLG,
S.CLM_TRANS_ADJ_CD,
S.CLM_TRANS_BEN_LVL_DERIV_CD,
S.CLM_TRANS_BEN_LVL_SRC_CD,
S.CLM_TRANS_CHK_NBR,
S.CLM_TRANS_CLM_FM_TYP_CD,
S.CLM_TRANS_DIAG_1_CD,
S.CLM_TRANS_DIAG_1_CD_CATGY_DESC,
S.CLM_TRANS_DIAG_1_CD_DESC,
S.CLM_TRANS_DIAG_1_CD_TYP_CD,
S.CLM_TRANS_DIAG_2_CD,
S.CLM_TRANS_DIAG_2_CD_CATGY_DESC,
S.CLM_TRANS_DIAG_2_CD_DESC,
S.CLM_TRANS_DIAG_2_CD_TYP_CD,
S.CLM_TRANS_DIAG_3_CD,
S.CLM_TRANS_DIAG_3_CD_CATGY_DESC,
S.CLM_TRANS_DIAG_3_CD_DESC,
S.CLM_TRANS_DIAG_3_CD_TYP_CD,
S.CLM_TRANS_DIAG_MH_SA_CD,
S.CLM_TRANS_DIAG_SBSTNC_ABUS_FLG,
S.CLM_TRANS_DLOC_TXT,
S.CLM_TRANS_DLOC_SEQ_NBR,
S.CLM_TRANS_DLOC_CATGY_TXT,
S.CLM_TRANS_DT_ADJD_DT,
S.CLM_TRANS_DT_ENT_DT,
S.CLM_TRANS_DT_PD_DT,
S.CLM_TRANS_DT_RCVD_DT,
S.CLM_TRANS_DT_PST_DT,
S.CLM_TRANS_DT_SRVC_FROM_DT,
S.CLM_TRANS_DT_SRVC_THRU_DT,
S.CLM_TRANS_LVL_OF_SRVC_DERIV_CD,
S.CLM_TRANS_LVL_OF_SRVC_SRC_CD,
S.CLM_TRANS_MBR_IN_MO_AGE,
S.CLM_TRANS_PL_OF_SRVC_AMA_CD,
S.CLM_TRANS_PL_OF_SRVC_SRC_CD,
S.CLM_TRANS_PROC_CD,
S.CLM_TRANS_PROC_DESC,
S.CLM_TRANS_PROC_MOD_CD,
S.CLM_TRANS_PROC_TYP_CD,
S.CLM_TRANS_PROC_UNIT_OF_MSR_TXT,
S.CLM_TRANS_PROV_NTWK_DERIV_CD,
S.CLM_TRANS_RSN_CD,
S.CLM_TRANS_RSN_DESC,
S.CLM_TRANS_UNET_CAP_FND_CD,
S.CLM_TRANS_UNET_CAP_FND_DRIV_CD,
S.CLM_TRANS_UNET_RDUC_RSN_CD,
S.CLM_TRANS_UNET_RDUC_RSN_DESC,
S.CLM_SRC_MBR_JOB_CATGY_CD,
S.CLM_SRC_MBR_JOB_SITE_CD,
S.CLM_SRC_PROV_TAX_ID_NBR,
S.CLM_SRC_PROV_PAYE_NM,
S.CLM_SRC_PROV_SRVC_ZIP_CD,
S.CLM_SRC_PROV_CLM_NPI_ID,
S.CLM_TRANS_UNET_OBLG_CD,
S.CLM_TRANS_UNET_SHR_ARNG_CD,
S.CLM_TRANS_UNET_BEN_LVL_CAUS_CD,
S.CLM_TRANS_ADJD_ID,
S.CLM_TRANS_PROC_ADJD_OFC_DESC,
S.CLM_TRANS_PYMT_OVRIDE_CD,
S.CLM_TRANS_PYMT_OVRIDE_FLG,
S.CLM_TRANS_SBMT_SRC_DESC,
S.CLM_TRANS_RSN_TYP_CD,
S.CLM_TRANS_CLM_PRI_DIAG_CD,
S.CLM_TRANS_DT_ADMIT_DT,
S.CLM_TRANS_ADMIT_TYP_CD,
S.CLM_TRANS_ADMIT_SRC_CD,
S.CLM_TRANS_DT_CLM_FST_SRVC_DT,
S.CLM_TRANS_DT_CLM_LST_SRVC_DT,
S.CLM_TRANS_BILL_TYP_CD,
S.CLM_TRANS_DSCHRG_STS_CD,
S.CLM_TRANS_SYS_DIAG_REL_GRP_CD,
S.CLM_TRANS_ENT_DIAG_REL_GRP_CD,
S.CLM_TRANS_CLM_LVL_RSN_CD,
S.CLM_TRANS_CLM_LVL_RSN_CD_DESC,
S.CLM_TRANS_UNET_HE_MBR_MKT_NBR,
S.CLM_TRANS_UNET_CES_FINC_ARNG_CD,
S.CLM_TRANS_UNET_CES_CUST_NBR,
S.CLM_TRANS_UNET_CES_GRP_NBR,
S.CLM_TRANS_UNET_CLM_MKT_SEG_CD,
S.CLM_TRANS_UNET_LD_PRTN_CD,
S.CLM_TRANS_UNET_MHSA_PRDCT_CD,
S.CLM_TRANS_UNET_MHSA_PRDCT_DESC,
S.CLM_TRANS_UNET_PLN_VAR_SUBDIV_CD,
S.CLM_TRANS_UNET_RPT_CD_BR_CD,
S.CLM_TRANS_EOB_RSN_CD,
S.CLM_TRANS_EOB_RSN_CD_DESC,
S.CLM_TRANS_CAC_AUTH_SYS_ID,
S.CLM_TRANS_AUTH_NBR,
S.CLM_TRANS_SUPP_ORDR_IND,
S.CLM_TRANS_EXTR_BEN_NBR,
S.CLM_TRANS_EXTR_AGCY_ID,
S.CLM_TRANS_EXTR_DEPN_NBR,
S.CLM_ETL_DW_SYS_ID,
S.CLM_ETL_DW_FROM_DT,
S.REC_CRT_DTTM,
S.REC_UPDT_DTTM,
S.CARE_MGT_MKT_SYS_ID,
S.GRP_SYS_ID,
S.MBR_ELIG_SYS_ID,
S.MBR_SYS_ID,
S.PERS_SYS_ID,
S.PKG_SYS_ID,
S.PROV_SYS_ID,
S.SALE_CHNL_SYS_ID,
S.CLM_TRANS_ALLW_AMT,
S.CLM_TRANS_ALLW_DERIV_AMT,
S.CLM_TRANS_COB_AMT,
S.CLM_TRANS_COINS_AMT,
S.CLM_TRANS_CONTR_AMT,
S.CLM_TRANS_COPAY_AMT,
S.CLM_TRANS_DED_AMT,
S.CLM_TRANS_DSALLW_AMT,
S.CLM_TRANS_DSCNT_AMT,
S.CLM_TRANS_MBR_RESP_AMT,
S.CLM_TRANS_PD_AMT,
S.CLM_TRANS_RSRV_AMT,
S.CLM_TRANS_SBMT_AMT,
S.CLM_TRANS_UNIT_CNT,
S.CLM_TRANS_UNIT_DERIV_CNT,
S.CLM_MBR_ATTR_SYS_ID,
S.NET_DTL_FLG,
S.PRI_PAYE_CD,
S.PRI_PAYE_CD_DESC,
S.ICD_DIAG_TYP_CD,
S.BIL_RVNU_CD,
S.CLM_TRANS_DIAG_1_DSM_TYP_CD,
S.CLM_TRANS_DIAG_2_DSM_TYP_CD,
S.CLM_TRANS_DIAG_3_DSM_TYP_CD,
S.CLM_TRANS_PROC_MOD_2_CD,
S.CLM_TRANS_PROC_MOD_3_CD,
S.CLM_TRANS_PROC_MOD_4_CD,
S.CLM_TRANS_RVNU_CD,
S.CLM_TRANS_RVNU_DESC,
S.CLM_TRANS_SEC_PROC_CD,
S.CLM_TRANS_SEC_PROC_TYP_CD,
S.CLM_TRANS_SEC_PROC_DESC,
S.SRC_FINC_LIAB_CD,
S.DERIV_OBH_FINC_LIAB,
S.CLM_SRC_PROV_CLM_SRVC_NPI_ID,
S.CLM_SRC_PROV_CLM_REF_NPI_ID,
S.CLM_SRC_PROV_CLM_FAC_NPI_ID,
S.CLM_SRC_PROV_CLM_RNDR_NPI_ID,
S.CLM_SRC_PROV_CLM_BIL_NPI_ID,
S.CLM_SRC_PROV_CLM_PAYE_NPI_ID,
S.CLM_SRC_PROV_CLM_ADMIT_NPI_ID,
S.CLM_SRC_PROV_CLM_ATD_NPI_ID,
S.PND_CLM_FLG,
S.CLM_TRANS_BIL_PROC_CD,
S.CLM_TRANS_BIL_PROC_DESC,
S.CLM_TRANS_BIL_PROC_TYP_CD,
S.CLM_TRANS_CLM_ST_OF_ISS,
S.CLM_TRANS_AGRMNT_ID,
S.CLM_TRANS_AGRMNT_DESC,
S.CSP_NTWX_PRCNG_CLM_BASED_ON,
S.CSP_NTWX_PRCNG_CLM_BASED_DESC,
S.CLM_TRANS_CLM_ACT_RATE_SRC,
S.CLM_TRANS_OON_MTHDLGY,
S.CSP_NTWX_PRCNG_CLM_VOL_TYP,
S.CSP_NTWX_PRCNG_CLM_RT,
S.CSP_NTWX_PRCNG_CLM_RT_TYP,
S.CLM_TRANS_CLM_ACT_RATE,
S.CLM_TRANS_UNET_ENG_CD) ;


SELECT "number of rows inserted","number of rows updated" INTO ins_cnt,updt_cnt
FROM TABLE(RESULT_SCAN(LAST_QUERY_ID()));
 SELECT CURRENT_TIMESTAMP() INTO load_end_ts ;
 INSERT INTO ETL.DBA_PROCESS_LOG VALUES
 (:unique_id,''TB_DIM_FCT_CLM_TRANS_CRR'',''TB_DIM_FCT_CLM_TRANS_CRR'',''LOAD'',0,0,:load_strt_ts,:load_end_ts,
 CURRENT_TIMESTAMP,:ins_cnt,:updt_cnt,0) ;
 result:=''LOAD_DM_FINAL_TB_DIM_FCT_CLM_TRANS_CRR refresh completed successfully'';
 return result;
 end;
  ';