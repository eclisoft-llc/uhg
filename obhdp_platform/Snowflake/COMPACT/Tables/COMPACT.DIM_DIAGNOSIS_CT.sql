CREATE TABLE IF NOT EXISTS COMPACT.DIM_DIAGNOSIS (
DIAGNOSIS_DIM_ID INTEGER NOT NULL CONSTRAINT PK_F_DIM_DIAGNOSIS_DIM_ID PRIMARY KEY,
DIAGNOSIS_CODE VARCHAR(30) NOT NULL,
DIAGNOSIS_SHORT_DESC VARCHAR(70),
DX_CLASS_1 VARCHAR(2),
FROM_AGE NUMBER(4,1),
TO_AGE NUMBER(4,1),
PATIENT_GENDER VARCHAR(1),
TRAUMA_FLAG VARCHAR(1),
PROCEDURE_CLASS VARCHAR(3),
DIAGNOSIS_MDC_CODE VARCHAR(2),
OPER_PROCEDURE_FLAG VARCHAR(1),
DIAGNOSIS_EFFECTIVE_DATE DATE,
DIAGNOSIS_TERM_DATE DATE,
PRODUCT_SERVICE_ID_QUALIFIER VARCHAR(2),
DIAGNOSIS_NODECM_CODE VARCHAR(30),
DW_INSERT_DATETIME DATETIME,
DW_UPDATE_DATETIME DATETIME,
DIAG_FIRSTN_DIM_ID INTEGER NOT NULL,
DIAG_FIRSTN_CODE VARCHAR(6) NOT NULL,
DIAG_FIRSTN_DESC VARCHAR(60),
DIAG_CAT_LVL_2_DIM_ID INTEGER NOT NULL DEFAULT -1,
DIAG_CAT_LVL_1_DIM_ID INTEGER NOT NULL DEFAULT -1,
ICD_VER_IND VARCHAR(1) NOT NULL,
CODE_TYPE VARCHAR(1) NOT NULL,
DIAGNOSIS_LONG_DESC VARCHAR(250),
SF_INSERT_DATETIME DATETIME DEFAULT CURRENT_TIMESTAMP,
SF_UPDATE_DATETIME DATETIME DEFAULT CURRENT_TIMESTAMP,
SF_PROCESS_ID VARCHAR(36),
CONSTRAINT UK_F_DIM_DIAGNOSIS_DIAGNOSIS_CODE_ICD_CODE_TYPE UNIQUE (DIAGNOSIS_CODE,ICD_VER_IND,CODE_TYPE)
);
