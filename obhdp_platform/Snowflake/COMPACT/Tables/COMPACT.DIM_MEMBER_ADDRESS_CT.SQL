CREATE TABLE IF NOT EXISTS COMPACT.DIM_MEMBER_ADDRESS (
MEMB_ADDR_DIM_ID NUMBER NOT NULL CONSTRAINT PK_F_DIM_MEMBER_ADDRESS_DIM_ID PRIMARY KEY,
COMPANY_DIM_ID NUMBER NOT NULL DEFAULT -1 ,
MEMB_DIM_ID NUMBER NOT NULL DEFAULT -1 ,
SEQ_MEMB_ID NUMBER(12,0) NOT NULL,
ADDR_TYPE VARCHAR(5) NOT NULL,
ADDRESS_LINE_1 VARCHAR(40),
ADDRESS_LINE_2 VARCHAR(40),
ADDRESS_LINE_3 VARCHAR(40),
CITY VARCHAR(19),
STATE VARCHAR(2),
ZIP VARCHAR(11),
COUNTY VARCHAR(20),
COUNTRY_CD VARCHAR(4),
PHONE VARCHAR(20),
PHONE_EXT VARCHAR(4),
FAX VARCHAR(20),
FAX_EXT VARCHAR(4),
EMAIL VARCHAR(40),
CONVERTED_FROM_DIM_ID NUMBER NOT NULL DEFAULT -1 ,
DW_INSERT_DATETIME DATE NOT NULL,
DW_UPDATE_DATETIME DATE NOT NULL ,
SF_INSERT_DATETIME DATETIME DEFAULT CURRENT_TIMESTAMP,
SF_UPDATE_DATETIME DATETIME DEFAULT CURRENT_TIMESTAMP,
SF_PROCESS_ID VARCHAR(36),
CONSTRAINT UK_F_DIM_MEMBER_ADDRESS UNIQUE (COMPANY_DIM_ID,SEQ_MEMB_ID,ADDR_TYPE),
CONSTRAINT FK_DIM_MEMBER_ADDRESS_DIM_COMPANY FOREIGN KEY (COMPANY_DIM_ID) REFERENCES COMPACT.DIM_COMPANY(COMPANY_DIM_ID),
CONSTRAINT FK_DIM_MEMBER_ADDRESS_DIM_CONVERTED_FROM FOREIGN KEY (CONVERTED_FROM_DIM_ID) REFERENCES COMPACT.DIM_CONVERTED_FROM(CONVERTED_FROM_DIM_ID),
CONSTRAINT FK_DIM_MEMBER_ADDRESS_DIM_MEMBER FOREIGN KEY (MEMB_DIM_ID) REFERENCES COMPACT.DIM_MEMBER(MEMB_DIM_ID)
);
