CREATE TABLE IF NOT EXISTS COMPACT.DIM_PROCEDURE_CODE (
PROCEDURE_DIM_ID INTEGER NOT NULL CONSTRAINT PK_F_DIM_PROCEDURE_CODE_DIM_ID PRIMARY KEY,
PROCEDURE_CODE VARCHAR(8) NOT NULL CONSTRAINT UK_F_DIM_PROCEDURE_CODE_PROCEDURE_CODE UNIQUE,
PROCEDURE_CODE_SHORT_DESC VARCHAR(28),
PRIMARY_GROUPING VARCHAR(3),
SECONDARY_GROUPING VARCHAR(3),
PRCD_REV_INP_OUTP_IND VARCHAR(1),
ER_FLAG VARCHAR(1),
DW_INSERT_DATETIME DATETIME,
DW_UPDATE_DATETIME DATETIME,
ASC_GROUPER INTEGER,
REVENUE_CAT_LVL_2_DIM_ID INTEGER NOT NULL DEFAULT -1,
REVENUE_CAT_LVL_1_DIM_ID INTEGER NOT NULL DEFAULT -1,
CPT_CAT_LVL_3_DIM_ID INTEGER NOT NULL DEFAULT -1,
CPT_CAT_LVL_2_DIM_ID INTEGER NOT NULL DEFAULT -1,
CPT_CAT_LVL_1_DIM_ID INTEGER NOT NULL DEFAULT -1,
PROCEDURE_CODE_LONG_DESC VARCHAR(250),
PROCEDURE_CODE_EFF_DATE DATE,
PROCEDURE_CODE_TERM_DATE DATE,
CODE_TYPE VARCHAR(1),
SF_INSERT_DATETIME DATETIME DEFAULT CURRENT_TIMESTAMP,
SF_UPDATE_DATETIME DATETIME DEFAULT CURRENT_TIMESTAMP,
SF_PROCESS_ID VARCHAR(36),
CONSTRAINT FK_DIM_PROCEDURE_CODE_DIM_CPT_CAT_LVL_1 FOREIGN KEY (CPT_CAT_LVL_1_DIM_ID) REFERENCES COMPACT.DIM_CPT_CAT_LVL_1(CPT_CAT_LVL_1_DIM_ID),
CONSTRAINT FK_DIM_PROCEDURE_CODE_DIM_CPT_CAT_LVL_2 FOREIGN KEY (CPT_CAT_LVL_2_DIM_ID) REFERENCES COMPACT.DIM_CPT_CAT_LVL_2(CPT_CAT_LVL_2_DIM_ID),
CONSTRAINT FK_DIM_PROCEDURE_CODE_DIM_CPT_CAT_LVL_3 FOREIGN KEY (CPT_CAT_LVL_3_DIM_ID) REFERENCES COMPACT.DIM_CPT_CAT_LVL_3(CPT_CAT_LVL_3_DIM_ID)
);
