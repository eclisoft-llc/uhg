CREATE TABLE IF NOT EXISTS COMPACT.DIM_PROVIDER_ADDRESS (
PROV_ADDR_DIM_ID NUMBER NOT NULL CONSTRAINT PK_F_DIM_PROVIDER_ADDRESS_DIM_ID PRIMARY KEY,
COMPANY_DIM_ID NUMBER NOT NULL DEFAULT -1,
PROV_DIM_ID NUMBER NOT NULL DEFAULT -1,
PROV_ADDR_ID VARCHAR(12) NOT NULL,
PROV_ADDR_SUB_ID VARCHAR(3) NOT NULL,
EFFECTIVE_DATE DATE NOT NULL,
TERM_DATE DATE NOT NULL,
TERM_REASON_DIM_ID NUMBER NOT NULL DEFAULT -1,
ADDRESS_LINE_1 VARCHAR(40),
ADDRESS_LINE_2 VARCHAR(40),
ADDRESS_LINE_3 VARCHAR(40),
CITY VARCHAR(19),
STATE VARCHAR(2),
ZIP VARCHAR(11),
COUNTY VARCHAR(20),
COUNTRY_CD VARCHAR(4),
PHONE VARCHAR(20),
PHONE_EXT VARCHAR(4),
FAX VARCHAR(20),
FAX_EXT VARCHAR(4),
EMAIL VARCHAR(40),
HD_IND VARCHAR(1),
SVC_LOC_IND VARCHAR(1),
MAIL_IND VARCHAR(1),
PRIM_ADDR_IND VARCHAR(1),
CONVERTED_FROM_DIM_ID NUMBER NOT NULL DEFAULT -1,
DW_INSERT_DATETIME DATE NOT NULL,
DW_UPDATE_DATETIME DATE NOT NULL,
SF_INSERT_DATETIME DATETIME DEFAULT CURRENT_TIMESTAMP,
SF_UPDATE_DATETIME DATETIME DEFAULT CURRENT_TIMESTAMP,
SF_PROCESS_ID VARCHAR(36),
CONSTRAINT UK_F_DIM_PROVIDER_ADDRESS_COMP_PROV_ADDR UNIQUE (COMPANY_DIM_ID,PROV_DIM_ID,PROV_ADDR_ID,PROV_ADDR_SUB_ID,EFFECTIVE_DATE),
CONSTRAINT FK_DIM_PROV_ADDRESS_DIM_COMPANY FOREIGN KEY (COMPANY_DIM_ID) REFERENCES COMPACT.DIM_COMPANY(COMPANY_DIM_ID),
CONSTRAINT FK_DIM_PROV_ADDRESS_DIM_CONVERTED_FROM FOREIGN KEY (CONVERTED_FROM_DIM_ID) REFERENCES COMPACT.DIM_CONVERTED_FROM(CONVERTED_FROM_DIM_ID),
CONSTRAINT FK_DIM_PROV_ADDRESS_DIM_PROVIDER FOREIGN KEY (PROV_DIM_ID) REFERENCES COMPACT.DIM_PROVIDER(PROV_DIM_ID)
);
