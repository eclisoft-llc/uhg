CREATE TABLE IF NOT EXISTS COMPACT.DIM_VENDOR (
VEND_DIM_ID INTEGER NOT NULL CONSTRAINT PK_F_DIM_VENDOR_DIM_ID PRIMARY KEY,
SEQ_VEND_ID INTEGER NOT NULL,
VENDOR_ID VARCHAR(20) NOT NULL,
COMPANY_DIM_ID INTEGER NOT NULL,
SHORT_NAME VARCHAR(15) NOT NULL,
VEND_FULL_NAME VARCHAR(55),
VENDOR_TYPE VARCHAR(1) NOT NULL,
IRS_TAX_ID VARCHAR(9),
HOLD_PAYMENT_FLAG VARCHAR(1),
VEND_ADDRESS_LINE_1 VARCHAR(40),
VEND_ADDRESS_LINE_2 VARCHAR(80),
VEND_CITY VARCHAR(30),
VEND_STATE VARCHAR(6),
VEND_ZIP VARCHAR(15),
VEND_COUNTY VARCHAR(30),
DW_INSERT_DATETIME DATETIME,
DW_UPDATE_DATETIME DATETIME,
GEOGRAPHY_DIM_ID INTEGER NOT NULL,
GEOGRAPHY_STATE_DIM_ID INTEGER NOT NULL,
VEND_GEOG_STATE VARCHAR(6) NOT NULL,
VEND_GEOG_STATE_DESC VARCHAR(20),
GEOGRAPHY_COUNTY_DIM_ID INTEGER NOT NULL,
VEND_GEOG_COUNTY VARCHAR(5) NOT NULL,
VEND_GEOG_COUNTY_DESC VARCHAR(25),
VEND_GEOG_ZIP VARCHAR(5),
CONVERTED_FROM_DIM_ID INTEGER NOT NULL,
TAX_DIM_ID INTEGER NOT NULL DEFAULT -1,
SF_INSERT_DATETIME DATETIME DEFAULT CURRENT_TIMESTAMP,
SF_UPDATE_DATETIME DATETIME DEFAULT CURRENT_TIMESTAMP,
SF_PROCESS_ID VARCHAR(36),
CONSTRAINT UK_F_DIM_VENDOR_SEQ_VEND_ID_COMPANY_DIM_ID UNIQUE (SEQ_VEND_ID,COMPANY_DIM_ID),
CONSTRAINT FK_DIM_VENDOR_DIM_COMPANY FOREIGN KEY (COMPANY_DIM_ID) REFERENCES COMPACT.DIM_COMPANY(COMPANY_DIM_ID),
CONSTRAINT FK_DIM_VENDOR_DIM_GEOGRAPHY FOREIGN KEY (GEOGRAPHY_DIM_ID) REFERENCES COMPACT.DIM_GEOGRAPHY(GEOGRAPHY_DIM_ID)
);
