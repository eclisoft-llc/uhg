CREATE TABLE IF NOT EXISTS ETL.SMART_DIM_DIAGNOSIS_L (
DIAGNOSIS_DIM_ID VARCHAR(50) NOT NULL CONSTRAINT PK_DIM_DIAGNOSIS_DIM_ID PRIMARY KEY,
DIAGNOSIS_CODE VARCHAR(30) NOT NULL,
DIAGNOSIS_SHORT_DESC VARCHAR(70),
DX_CLASS_1 VARCHAR(2),
FROM_AGE VARCHAR(7),
TO_AGE VARCHAR(7),
PATIENT_GENDER VARCHAR(1),
TRAUMA_FLAG VARCHAR(1),
PROCEDURE_CLASS VARCHAR(3),
DIAGNOSIS_MDC_CODE VARCHAR(2),
OPER_PROCEDURE_FLAG VARCHAR(1),
DIAGNOSIS_EFFECTIVE_DATE VARCHAR(35),
DIAGNOSIS_TERM_DATE VARCHAR(35),
PRODUCT_SERVICE_ID_QUALIFIER VARCHAR(2),
DIAGNOSIS_NODECM_CODE VARCHAR(30),
DW_INSERT_DATETIME VARCHAR(35),
DW_UPDATE_DATETIME VARCHAR(35),
DIAG_FIRSTN_DIM_ID VARCHAR(50) NOT NULL,
DIAG_FIRSTN_CODE VARCHAR(6) NOT NULL,
DIAG_FIRSTN_DESC VARCHAR(60),
DIAG_CAT_LVL_2_DIM_ID VARCHAR(50) NOT NULL,
DIAG_CAT_LVL_1_DIM_ID VARCHAR(50) NOT NULL,
ICD_VER_IND VARCHAR(1) NOT NULL,
CODE_TYPE VARCHAR(1) NOT NULL,
DIAGNOSIS_LONG_DESC VARCHAR(250),
CONSTRAINT UK_DIM_DIAGNOSIS_DIAGNOSIS_CODE_ICD_CODE_TYPE UNIQUE (DIAGNOSIS_CODE,ICD_VER_IND,CODE_TYPE)
);
