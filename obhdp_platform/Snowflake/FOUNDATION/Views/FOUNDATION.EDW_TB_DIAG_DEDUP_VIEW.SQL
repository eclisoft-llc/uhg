CREATE OR REPLACE VIEW FOUNDATION.EDW_TB_DIAG_DEDUP AS
SELECT DISTINCT
   UPPER(DIAG_CD) DIAG_CD, UPPER(DIAG_CATGY_DERIV_DESC) DIAG_CATGY_DERIV_DESC,
   UPPER(DIAG_DERIV_TYP_CD) DIAG_DERIV_TYP_CD, UPPER(MH_SA_CD) MH_SA_CD,
   UPPER(DIAG_DERIV_DESC) DIAG_DERIV_DESC,
   UPPER(ICD_DIAG_TYP_CD) ICD_DIAG_TYP_CD, UPPER(DSM_TYP_CD) DSM_TYP_CD
FROM ETL.EDW_TB_DIAG_L
WHERE CURRENT_TIMESTAMP() BETWEEN DIAG_EFF_DT AND DIAG_EXPR_DT AND DIAG_CD <> ' ';

