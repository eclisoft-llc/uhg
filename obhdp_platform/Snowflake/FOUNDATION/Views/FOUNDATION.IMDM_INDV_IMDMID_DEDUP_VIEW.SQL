create or replace view FOUNDATION.IMDM_INDV_IMDMID_DEDUP(
	IMDM_ID,
	SMRTPRSID,
	IMDM_COUNT
) as
SELECT DISTINCT
FIRST_VALUE(IMDM_ID) OVER(PARTITION BY SMRTPRSID ORDER BY IMDM_ID) IMDM_ID,
SMRTPRSID,
COUNT(IMDM_ID) OVER(PARTITION BY SMRTPRSID) IMDM_COUNT
FROM
(SELECT DISTINCT
SMRTPRSID,
IMDM_ID
FROM COMPACT.IMDM_INDV);
