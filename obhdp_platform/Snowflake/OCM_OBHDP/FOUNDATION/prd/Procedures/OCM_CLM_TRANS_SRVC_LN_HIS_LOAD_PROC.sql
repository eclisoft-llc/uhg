CREATE  OR REPLACE PROCEDURE ECT_PRD_OBH_DP_DB.FOUNDATION.OCM_CLM_TRANS_SRVC_LN_HIS_LOAD_PROC()
RETURNS VARCHAR
LANGUAGE javascript
COMMENT='Loads the data from OCM_DIM_CLM_TRANS and OCM_FCT_CLM_TRANS tables to final OCM_CLM_TRANS_SRVC_LN table in OBHDB Foundation layer'
EXECUTE as caller
AS
$$
    var result = "";
    try {
        var delete_stmt = snowflake.createStatement({sqlText:"DELETE FROM ECT_PRD_OBH_DP_DB.FOUNDATION.OCM_CLM_TRANS_SRVC_LN WHERE CLM_AUD_SRC_SYS_CD = 'COSM';"});
        delete_stmt.execute();
        var sql_DIM_CLM_command = "INSERT INTO ECT_PRD_OBH_DP_DB.FOUNDATION.OCM_CLM_TRANS_SRVC_LN(  CLM_TRANS_SYS_ID, CLM_AUD_LN_NBR, CLM_AUD_NBR, CLM_AUD_SRC_ID, CLM_AUD_SRC_SYS_CD, CLM_AUD_TRANS_SEQ_NBR, CLM_ETL_DW_FROM_DT, CLM_ETL_DW_SYS_ID, CLM_SRC_AUTH_NBR, CLM_SRC_COSM_DIV_CD, CLM_SRC_LEG_ENTY_NBR, CLM_SRC_MBR_CUST_SEG_NBR, CLM_SRC_MBR_DEPN_CD, CLM_SRC_MBR_GDR_CD, CLM_SRC_MBR_NON_UHG_EE_FLG, CLM_SRC_MBR_PLN_ID, CLM_SRC_MBR_PRDCT_CD, CLM_SRC_MBR_SBSCR_ID, CLM_SRC_MBR_SYS_ID, CLM_SRC_PROV_CLM_BIL_NPI_ID, CLM_SRC_PROV_CLM_NPI_ID, CLM_SRC_PROV_CLM_REF_NPI_ID, CLM_SRC_PROV_CLM_SRVC_NPI_ID, CLM_SRC_PROV_PAYE_NM, CLM_SRC_PROV_SRVC_CTY_NM, CLM_SRC_PROV_SRVC_ST_CD, CLM_SRC_PROV_SRVC_ZIP_CD, CLM_SRC_PROV_SYS_ID, CLM_SRC_PROV_TAX_ID_NBR, CLM_TRANS_ACCOM_FLG, CLM_TRANS_ADJ_CD, CLM_TRANS_ADMIT_SRC_CD, CLM_TRANS_ADMIT_TYP_CD, CLM_TRANS_ALLW_AMT, CLM_TRANS_ALLW_DERIV_AMT, CLM_TRANS_AUTH_NBR, CLM_TRANS_BEN_LVL_DERIV_CD, CLM_TRANS_BEN_LVL_SRC_CD, CLM_TRANS_BILL_TYP_CD, CLM_TRANS_CAC_AUTH_SYS_ID, CLM_TRANS_CHK_NBR, CLM_TRANS_CLM_FM_TYP_CD, CLM_TRANS_CLM_LVL_RSN_CD, CLM_TRANS_CLM_LVL_RSN_CD_DESC, CLM_TRANS_CLM_PRI_DIAG_CD, CLM_TRANS_COB_AMT, CLM_TRANS_COINS_AMT, CLM_TRANS_CONTR_AMT, CLM_TRANS_COPAY_AMT, CLM_TRANS_DED_AMT, CLM_TRANS_DIAG_1_CD, CLM_TRANS_DIAG_1_CD_CATGY_LVL_1_DESC, CLM_TRANS_DIAG_1_CD_CATGY_LVL_2_DESC, CLM_TRANS_DIAG_1_CD_DESC, CLM_TRANS_DIAG_1_CD_TYP_CD, CLM_TRANS_DIAG_1_DSM_TYP_CD, CLM_TRANS_DIAG_2_CD, CLM_TRANS_DIAG_2_CD_CATGY_LVL_1_DESC, CLM_TRANS_DIAG_2_CD_CATGY_LVL_2_DESC, CLM_TRANS_DIAG_2_CD_DESC, CLM_TRANS_DIAG_2_CD_TYP_CD, CLM_TRANS_DIAG_2_DSM_TYP_CD, CLM_TRANS_DIAG_3_CD, CLM_TRANS_DIAG_3_CD_CATGY_LVL_1_DESC, CLM_TRANS_DIAG_3_CD_CATGY_LVL_2_DESC, CLM_TRANS_DIAG_3_CD_DESC, CLM_TRANS_DIAG_3_CD_TYP_CD, CLM_TRANS_DIAG_3_DSM_TYP_CD, CLM_TRANS_DIAG_MH_SA_CD, CLM_TRANS_DIAG_SBSTNC_ABUS_FLG, CLM_TRANS_DLOC_CATGY_TXT, CLM_TRANS_DLOC_SEQ_NBR, CLM_TRANS_DLOC_TXT, CLM_TRANS_DSALLW_AMT, CLM_TRANS_DSCHRG_STS_CD, CLM_TRANS_DSCNT_AMT, CLM_TRANS_DT_ADJD_DT, CLM_TRANS_DT_ADMIT_DT, CLM_TRANS_DT_CLM_FST_SRVC_DT, CLM_TRANS_DT_CLM_LST_SRVC_DT, CLM_TRANS_DT_ENT_DT, CLM_TRANS_DT_PD_DT, CLM_TRANS_DT_PST_DT, CLM_TRANS_DT_RCVD_DT, CLM_TRANS_DT_SRVC_FROM_DT, CLM_TRANS_DT_SRVC_THRU_DT, CLM_TRANS_ENT_DIAG_REL_GRP_CD, CLM_TRANS_LVL_OF_SRVC_DERIV_CD, CLM_TRANS_LVL_OF_SRVC_SRC_CD, CLM_TRANS_MBR_IN_YR_AGE, CLM_TRANS_MBR_RESP_AMT, CLM_TRANS_PD_AMT, CLM_TRANS_PL_OF_SRVC_AMA_CD, CLM_TRANS_PL_OF_SRVC_SRC_CD, CLM_TRANS_PRI_PAYE_CD, CLM_TRANS_PRI_PAYE_CD_DESC, CLM_TRANS_PROC_ADJD_OFC_DESC, CLM_TRANS_PROC_CD, CLM_TRANS_PROC_DESC, CLM_TRANS_PROC_MOD_2_CD, CLM_TRANS_PROC_MOD_3_CD, CLM_TRANS_PROC_MOD_4_CD, CLM_TRANS_PROC_MOD_CD, CLM_TRANS_PROC_TYP_CD, CLM_TRANS_PROC_UNIT_OF_MSR_TXT, CLM_TRANS_PROV_NTWK_DERIV_CD, CLM_TRANS_PYMT_OVRIDE_CD, CLM_TRANS_RSN_CD, CLM_TRANS_RSN_DESC, CLM_TRANS_RSRV_AMT, CLM_TRANS_RVNU_CD, CLM_TRANS_RVNU_DESC, CLM_TRANS_SBMT_AMT, CLM_TRANS_SBMT_SRC_DESC, CLM_TRANS_SEC_PROC_CD, CLM_TRANS_SEC_PROC_DESC, CLM_TRANS_SEC_PROC_TYP_CD, CLM_TRANS_SYS_DIAG_REL_GRP_CD, CLM_TRANS_UNIT_CNT, CLM_TRANS_UNIT_DERIV_CNT, DERIV_OBH_FINC_LIAB, ICD_DIAG_TYP_CD, PND_CLM_FLG  )  SELECT  DIM_CLM_TRANS.CLM_TRANS_SYS_ID CLM_TRANS_SYS_ID, DIM_CLM_TRANS.CLM_AUD_LN_NBR, DIM_CLM_TRANS.CLM_AUD_NBR CLM_AUD_NBR, DIM_CLM_TRANS.CLM_AUD_SRC_ID CLM_AUD_SRC_ID, DIM_CLM_TRANS.CLM_AUD_SRC_SYS_CD CLM_AUD_SRC_SYS_CD, DIM_CLM_TRANS.CLM_AUD_TRANS_SEQ_NBR CLM_AUD_TRANS_SEQ_NBR, DIM_CLM_TRANS.CLM_ETL_DW_FROM_DT CLM_ETL_DW_FROM_DT, DIM_CLM_TRANS.CLM_ETL_DW_SYS_ID CLM_ETL_DW_SYS_ID, DIM_CLM_TRANS.CLM_SRC_AUTH_NBR CLM_SRC_AUTH_NBR, DIM_CLM_TRANS.CLM_SRC_COSM_DIV_CD CLM_SRC_COSM_DIV_CD, DIM_CLM_TRANS.CLM_SRC_LEG_ENTY_NBR CLM_SRC_LEG_ENTY_NBR, DIM_CLM_TRANS.CLM_SRC_MBR_CUST_SEG_NBR CLM_SRC_MBR_CUST_SEG_NBR, DIM_CLM_TRANS.CLM_SRC_MBR_DEPN_CD CLM_SRC_MBR_DEPN_CD, DIM_CLM_TRANS.CLM_SRC_MBR_GDR_CD CLM_SRC_MBR_GDR_CD, DIM_CLM_TRANS.CLM_SRC_MBR_NON_UHG_EE_FLG CLM_SRC_MBR_NON_UHG_EE_FLG, DIM_CLM_TRANS.CLM_SRC_MBR_PLN_ID CLM_SRC_MBR_PLN_ID, DIM_CLM_TRANS.CLM_SRC_MBR_PRDCT_CD CLM_SRC_MBR_PRDCT_CD, DIM_CLM_TRANS.CLM_SRC_MBR_SBSCR_ID CLM_SRC_MBR_SBSCR_ID, DIM_CLM_TRANS.CLM_SRC_MBR_SYS_ID CLM_SRC_MBR_SYS_ID, DIM_CLM_TRANS.CLM_SRC_PROV_CLM_BIL_NPI_ID CLM_SRC_PROV_CLM_BIL_NPI_ID, DIM_CLM_TRANS.CLM_SRC_PROV_CLM_NPI_ID CLM_SRC_PROV_CLM_NPI_ID, DIM_CLM_TRANS.CLM_SRC_PROV_CLM_REF_NPI_ID CLM_SRC_PROV_CLM_REF_NPI_ID, DIM_CLM_TRANS.CLM_SRC_PROV_CLM_SRVC_NPI_ID CLM_SRC_PROV_CLM_SRVC_NPI_ID, DIM_CLM_TRANS.CLM_SRC_PROV_PAYE_NM CLM_SRC_PROV_PAYE_NM, DIM_CLM_TRANS.CLM_SRC_PROV_SRVC_CTY_NM CLM_SRC_PROV_SRVC_CTY_NM, DIM_CLM_TRANS.CLM_SRC_PROV_SRVC_ST_CD CLM_SRC_PROV_SRVC_ST_CD, DIM_CLM_TRANS.CLM_SRC_PROV_SRVC_ZIP_CD CLM_SRC_PROV_SRVC_ZIP_CD, DIM_CLM_TRANS.CLM_SRC_PROV_SYS_ID CLM_SRC_PROV_SYS_ID, DIM_CLM_TRANS.CLM_SRC_PROV_TAX_ID_NBR CLM_SRC_PROV_TAX_ID_NBR, DIM_CLM_TRANS.CLM_TRANS_ACCOM_FLG CLM_TRANS_ACCOM_FLG, DIM_CLM_TRANS.CLM_TRANS_ADJ_CD CLM_TRANS_ADJ_CD, DIM_CLM_TRANS.CLM_TRANS_ADMIT_SRC_CD CLM_TRANS_ADMIT_SRC_CD, DIM_CLM_TRANS.CLM_TRANS_ADMIT_TYP_CD CLM_TRANS_ADMIT_TYP_CD, FCT_CLM_TRANS.CLM_TRANS_ALLW_AMT CLM_TRANS_ALLW_AMT,  FCT_CLM_TRANS.CLM_TRANS_ALLW_DERIV_AMT CLM_TRANS_ALLW_DERIV_AMT, DIM_CLM_TRANS.CLM_TRANS_AUTH_NBR CLM_TRANS_AUTH_NBR, DIM_CLM_TRANS.CLM_TRANS_BEN_LVL_DERIV_CD CLM_TRANS_BEN_LVL_DERIV_CD, DIM_CLM_TRANS.CLM_TRANS_BEN_LVL_SRC_CD CLM_TRANS_BEN_LVL_SRC_CD, DIM_CLM_TRANS.CLM_TRANS_BILL_TYP_CD CLM_TRANS_BILL_TYP_CD, DIM_CLM_TRANS.CLM_TRANS_CAC_AUTH_SYS_ID CLM_TRANS_CAC_AUTH_SYS_ID, DIM_CLM_TRANS.CLM_TRANS_CHK_NBR CLM_TRANS_CHK_NBR, DIM_CLM_TRANS.CLM_TRANS_CLM_FM_TYP_CD CLM_TRANS_CLM_FM_TYP_CD, DIM_CLM_TRANS.CLM_TRANS_CLM_LVL_RSN_CD CLM_TRANS_CLM_LVL_RSN_CD, DIM_CLM_TRANS.CLM_TRANS_CLM_LVL_RSN_CD_DESC CLM_TRANS_CLM_LVL_RSN_CD_DESC, DIM_CLM_TRANS.CLM_TRANS_CLM_PRI_DIAG_CD CLM_TRANS_CLM_PRI_DIAG_CD, FCT_CLM_TRANS.CLM_TRANS_COB_AMT CLM_TRANS_COB_AMT, FCT_CLM_TRANS.CLM_TRANS_COINS_AMT CLM_TRANS_COINS_AMT, FCT_CLM_TRANS.CLM_TRANS_CONTR_AMT CLM_TRANS_CONTR_AMT, FCT_CLM_TRANS.CLM_TRANS_COPAY_AMT CLM_TRANS_COPAY_AMT, FCT_CLM_TRANS.CLM_TRANS_DED_AMT CLM_TRANS_DED_AMT, DIM_CLM_TRANS.CLM_TRANS_DIAG_1_CD CLM_TRANS_DIAG_1_CD, DIM_CLM_TRANS.CLM_TRANS_DIAG_1_CD_CATGY_LVL_1_DESC CLM_TRANS_DIAG_1_CD_CATGY_LVL_1_DESC, DIM_CLM_TRANS.CLM_TRANS_DIAG_1_CD_CATGY_LVL_2_DESC CLM_TRANS_DIAG_1_CD_CATGY_LVL_2_DESC, DIM_CLM_TRANS.CLM_TRANS_DIAG_1_CD_DESC CLM_TRANS_DIAG_1_CD_DESC, DIM_CLM_TRANS.CLM_TRANS_DIAG_1_CD_TYP_CD CLM_TRANS_DIAG_1_CD_TYP_CD, DIM_CLM_TRANS.CLM_TRANS_DIAG_1_DSM_TYP_CD CLM_TRANS_DIAG_1_DSM_TYP_CD, DIM_CLM_TRANS.CLM_TRANS_DIAG_2_CD CLM_TRANS_DIAG_2_CD, DIM_CLM_TRANS.CLM_TRANS_DIAG_2_CD_CATGY_LVL_1_DESC CLM_TRANS_DIAG_2_CD_CATGY_LVL_1_DESC, DIM_CLM_TRANS.CLM_TRANS_DIAG_2_CD_CATGY_LVL_2_DESC CLM_TRANS_DIAG_2_CD_CATGY_LVL_2_DESC, DIM_CLM_TRANS.CLM_TRANS_DIAG_2_CD_DESC CLM_TRANS_DIAG_2_CD_DESC, DIM_CLM_TRANS.CLM_TRANS_DIAG_2_CD_TYP_CD CLM_TRANS_DIAG_2_CD_TYP_CD, DIM_CLM_TRANS.CLM_TRANS_DIAG_2_DSM_TYP_CD CLM_TRANS_DIAG_2_DSM_TYP_CD, DIM_CLM_TRANS.CLM_TRANS_DIAG_3_CD CLM_TRANS_DIAG_3_CD, DIM_CLM_TRANS.CLM_TRANS_DIAG_3_CD_CATGY_LVL_1_DESC CLM_TRANS_DIAG_3_CD_CATGY_LVL_1_DESC, DIM_CLM_TRANS.CLM_TRANS_DIAG_3_CD_CATGY_LVL_2_DESC CLM_TRANS_DIAG_3_CD_CATGY_LVL_2_DESC, DIM_CLM_TRANS.CLM_TRANS_DIAG_3_CD_DESC CLM_TRANS_DIAG_3_CD_DESC, DIM_CLM_TRANS.CLM_TRANS_DIAG_3_CD_TYP_CD CLM_TRANS_DIAG_3_CD_TYP_CD, DIM_CLM_TRANS.CLM_TRANS_DIAG_3_DSM_TYP_CD CLM_TRANS_DIAG_3_DSM_TYP_CD, DIM_CLM_TRANS.CLM_TRANS_DIAG_MH_SA_CD CLM_TRANS_DIAG_MH_SA_CD, DIM_CLM_TRANS.CLM_TRANS_DIAG_SBSTNC_ABUS_FLG CLM_TRANS_DIAG_SBSTNC_ABUS_FLG, DIM_CLM_TRANS.CLM_TRANS_DLOC_CATGY_TXT CLM_TRANS_DLOC_CATGY_TXT, DIM_CLM_TRANS.CLM_TRANS_DLOC_SEQ_NBR CLM_TRANS_DLOC_SEQ_NBR, DIM_CLM_TRANS.CLM_TRANS_DLOC_TXT CLM_TRANS_DLOC_TXT, FCT_CLM_TRANS.CLM_TRANS_DSALLW_AMT CLM_TRANS_DSALLW_AMT, DIM_CLM_TRANS.CLM_TRANS_DSCHRG_STS_CD CLM_TRANS_DSCHRG_STS_CD, FCT_CLM_TRANS.CLM_TRANS_DSCNT_AMT CLM_TRANS_DSCNT_AMT, DIM_CLM_TRANS.CLM_TRANS_DT_ADJD_DT CLM_TRANS_DT_ADJD_DT, DIM_CLM_TRANS.CLM_TRANS_DT_ADMIT_DT CLM_TRANS_DT_ADMIT_DT, DIM_CLM_TRANS.CLM_TRANS_DT_CLM_FST_SRVC_DT CLM_TRANS_DT_CLM_FST_SRVC_DT, DIM_CLM_TRANS.CLM_TRANS_DT_CLM_LST_SRVC_DT CLM_TRANS_DT_CLM_LST_SRVC_DT, DIM_CLM_TRANS.CLM_TRANS_DT_ENT_DT CLM_TRANS_DT_ENT_DT, DIM_CLM_TRANS.CLM_TRANS_DT_PD_DT CLM_TRANS_DT_PD_DT, DIM_CLM_TRANS.CLM_TRANS_DT_PST_DT CLM_TRANS_DT_PST_DT, DIM_CLM_TRANS.CLM_TRANS_DT_RCVD_DT CLM_TRANS_DT_RCVD_DT, DIM_CLM_TRANS.CLM_TRANS_DT_SRVC_FROM_DT CLM_TRANS_DT_SRVC_FROM_DT, DIM_CLM_TRANS.CLM_TRANS_DT_SRVC_THRU_DT CLM_TRANS_DT_SRVC_THRU_DT, DIM_CLM_TRANS.CLM_TRANS_ENT_DIAG_REL_GRP_CD CLM_TRANS_ENT_DIAG_REL_GRP_CD, DIM_CLM_TRANS.CLM_TRANS_LVL_OF_SRVC_DERIV_CD CLM_TRANS_LVL_OF_SRVC_DERIV_CD, DIM_CLM_TRANS.CLM_TRANS_LVL_OF_SRVC_SRC_CD CLM_TRANS_LVL_OF_SRVC_SRC_CD, DIM_CLM_TRANS.CLM_TRANS_MBR_IN_YR_AGE CLM_TRANS_MBR_IN_YR_AGE, FCT_CLM_TRANS.CLM_TRANS_MBR_RESP_AMT CLM_TRANS_MBR_RESP_AMT, FCT_CLM_TRANS.CLM_TRANS_PD_AMT CLM_TRANS_PD_AMT, DIM_CLM_TRANS.CLM_TRANS_PL_OF_SRVC_AMA_CD CLM_TRANS_PL_OF_SRVC_AMA_CD, DIM_CLM_TRANS.CLM_TRANS_PL_OF_SRVC_SRC_CD CLM_TRANS_PL_OF_SRVC_SRC_CD, DIM_CLM_TRANS.CLM_TRANS_PRI_PAYE_CD CLM_TRANS_PRI_PAYE_CD, DIM_CLM_TRANS.CLM_TRANS_PRI_PAYE_CD_DESC CLM_TRANS_PRI_PAYE_CD_DESC, DIM_CLM_TRANS.CLM_TRANS_PROC_ADJD_OFC_DESC CLM_TRANS_PROC_ADJD_OFC_DESC, DIM_CLM_TRANS.CLM_TRANS_PROC_CD CLM_TRANS_PROC_CD, DIM_CLM_TRANS.CLM_TRANS_PROC_DESC CLM_TRANS_PROC_DESC, DIM_CLM_TRANS.CLM_TRANS_PROC_MOD_2_CD CLM_TRANS_PROC_MOD_2_CD,  DIM_CLM_TRANS.CLM_TRANS_PROC_MOD_3_CD CLM_TRANS_PROC_MOD_3_CD, DIM_CLM_TRANS.CLM_TRANS_PROC_MOD_4_CD CLM_TRANS_PROC_MOD_4_CD, DIM_CLM_TRANS.CLM_TRANS_PROC_MOD_CD CLM_TRANS_PROC_MOD_CD, DIM_CLM_TRANS.CLM_TRANS_PROC_TYP_CD CLM_TRANS_PROC_TYP_CD, DIM_CLM_TRANS.CLM_TRANS_PROC_UNIT_OF_MSR_TXT, DIM_CLM_TRANS.CLM_TRANS_PROV_NTWK_DERIV_CD CLM_TRANS_PROV_NTWK_DERIV_CD, DIM_CLM_TRANS.CLM_TRANS_PYMT_OVRIDE_CD CLM_TRANS_PYMT_OVRIDE_CD, DIM_CLM_TRANS.CLM_TRANS_RSN_CD CLM_TRANS_RSN_CD, DIM_CLM_TRANS.CLM_TRANS_RSN_DESC CLM_TRANS_RSN_DESC, FCT_CLM_TRANS.CLM_TRANS_RSRV_AMT CLM_TRANS_RSRV_AMT, DIM_CLM_TRANS.CLM_TRANS_RVNU_CD CLM_TRANS_RVNU_CD, DIM_CLM_TRANS.CLM_TRANS_RVNU_DESC CLM_TRANS_RVNU_DESC, FCT_CLM_TRANS.CLM_TRANS_SBMT_AMT CLM_TRANS_SBMT_AMT, DIM_CLM_TRANS.CLM_TRANS_SBMT_SRC_DESC CLM_TRANS_SBMT_SRC_DESC, DIM_CLM_TRANS.CLM_TRANS_SEC_PROC_CD CLM_TRANS_SEC_PROC_CD, DIM_CLM_TRANS.CLM_TRANS_SEC_PROC_DESC CLM_TRANS_SEC_PROC_DESC, DIM_CLM_TRANS.CLM_TRANS_SEC_PROC_TYP_CD CLM_TRANS_SEC_PROC_TYP_CD, DIM_CLM_TRANS.CLM_TRANS_SYS_DIAG_REL_GRP_CD CLM_TRANS_SYS_DIAG_REL_GRP_CD, FCT_CLM_TRANS.CLM_TRANS_UNIT_CNT CLM_TRANS_UNIT_CNT, FCT_CLM_TRANS.CLM_TRANS_UNIT_DERIV_CNT CLM_TRANS_UNIT_DERIV_CNT, DIM_CLM_TRANS.DERIV_OBH_FINC_LIAB DERIV_OBH_FINC_LIAB, DIM_CLM_TRANS.ICD_DIAG_TYP_CD ICD_DIAG_TYP_CD, DIM_CLM_TRANS.PND_CLM_FLG PND_CLM_FLG  FROM ECT_PRD_OBH_DP_DB.FOUNDATION.OCM_DIM_CLM_TRANS DIM_CLM_TRANS INNER JOIN ECT_PRD_OBH_DP_DB.FOUNDATION.OCM_FCT_CLM_TRANS FCT_CLM_TRANS ON DIM_CLM_TRANS.CLM_TRANS_SYS_ID = FCT_CLM_TRANS.CLM_TRANS_SYS_ID  WHERE DIM_CLM_TRANS.CLM_AUD_SRC_SYS_CD='COSM';"
        var insert_stmt = snowflake.createStatement({ sqlText: sql_DIM_CLM_command } );
        insert_stmt.execute();
        result = "SUCCESS";
    }
    catch (err) {
         result =  "Failed: Code: " + err.code + "\n  State: " + err.state;
         result += "\n  Message: " + err.message;
         result += "\nStack Trace:\n" + err.stackTraceTxt;
    }
    return result;
$$;