CREATE  OR REPLACE PROCEDURE ECT_PRD_OBH_DP_DB.FOUNDATION.OCM_CLM_TRANS_SRVC_LN_INC_LOAD_PROC()
RETURNS VARCHAR
LANGUAGE javascript
COMMENT='Loads the data to intermediate c FOUNDATION final table from OBHDP intermediate tables on incremental load'
EXECUTE as caller
AS
$$

try {

var sql_OCM_DIM_CLM_TRANS_max_load_timestamp_Statement = snowflake.createStatement({sqlText:"SELECT MAX(SF_UPDATE_DATETIME) FROM ECT_PRD_OBH_DP_DB.FOUNDATION.OCM_DIM_CLM_TRANS;"});
var res_OCM_DIM_CLM_TRANS_max_load_timestamp = sql_OCM_DIM_CLM_TRANS_max_load_timestamp_Statement.execute();

var sql_OCM_FCT_CLM_TRANS_max_load_timestamp_Statement = snowflake.createStatement({sqlText:"SELECT MAX(SF_UPDATE_DATETIME) FROM ECT_PRD_OBH_DP_DB.FOUNDATION.OCM_FCT_CLM_TRANS;"});
var res_OCM_FCT_CLM_TRANS_max_load_timestamp = sql_OCM_FCT_CLM_TRANS_max_load_timestamp_Statement.execute();

var sql_OCM_CLM_TRANS_SRVC_LN_merge_command = "merge into ECT_PRD_OBH_DP_DB.FOUNDATION.OCM_CLM_TRANS_SRVC_LN AS T using (SELECT DISTINCT DIM_CLM_TRANS.CLM_TRANS_SYS_ID CLM_TRANS_SYS_ID,DIM_CLM_TRANS.CLM_AUD_LN_NBR,DIM_CLM_TRANS.CLM_AUD_NBR CLM_AUD_NBR,DIM_CLM_TRANS.CLM_AUD_SRC_ID CLM_AUD_SRC_ID,DIM_CLM_TRANS.CLM_AUD_SRC_SYS_CD CLM_AUD_SRC_SYS_CD,DIM_CLM_TRANS.CLM_AUD_TRANS_SEQ_NBR CLM_AUD_TRANS_SEQ_NBR,DIM_CLM_TRANS.CLM_ETL_DW_FROM_DT CLM_ETL_DW_FROM_DT,DIM_CLM_TRANS.CLM_ETL_DW_SYS_ID CLM_ETL_DW_SYS_ID,DIM_CLM_TRANS.CLM_SRC_AUTH_NBR CLM_SRC_AUTH_NBR,DIM_CLM_TRANS.CLM_SRC_COSM_DIV_CD CLM_SRC_COSM_DIV_CD,DIM_CLM_TRANS.CLM_SRC_LEG_ENTY_NBR CLM_SRC_LEG_ENTY_NBR,DIM_CLM_TRANS.CLM_SRC_MBR_CUST_SEG_NBR CLM_SRC_MBR_CUST_SEG_NBR,DIM_CLM_TRANS.CLM_SRC_MBR_DEPN_CD CLM_SRC_MBR_DEPN_CD,DIM_CLM_TRANS.CLM_SRC_MBR_GDR_CD CLM_SRC_MBR_GDR_CD,DIM_CLM_TRANS.CLM_SRC_MBR_NON_UHG_EE_FLG CLM_SRC_MBR_NON_UHG_EE_FLG,DIM_CLM_TRANS.CLM_SRC_MBR_PLN_ID CLM_SRC_MBR_PLN_ID,DIM_CLM_TRANS.CLM_SRC_MBR_PRDCT_CD CLM_SRC_MBR_PRDCT_CD,DIM_CLM_TRANS.CLM_SRC_MBR_SBSCR_ID CLM_SRC_MBR_SBSCR_ID,DIM_CLM_TRANS.CLM_SRC_MBR_SYS_ID CLM_SRC_MBR_SYS_ID,DIM_CLM_TRANS.CLM_SRC_PROV_CLM_BIL_NPI_ID CLM_SRC_PROV_CLM_BIL_NPI_ID,DIM_CLM_TRANS.CLM_SRC_PROV_CLM_NPI_ID CLM_SRC_PROV_CLM_NPI_ID,DIM_CLM_TRANS.CLM_SRC_PROV_CLM_REF_NPI_ID CLM_SRC_PROV_CLM_REF_NPI_ID,DIM_CLM_TRANS.CLM_SRC_PROV_CLM_SRVC_NPI_ID CLM_SRC_PROV_CLM_SRVC_NPI_ID,DIM_CLM_TRANS.CLM_SRC_PROV_PAYE_NM CLM_SRC_PROV_PAYE_NM,DIM_CLM_TRANS.CLM_SRC_PROV_SRVC_CTY_NM CLM_SRC_PROV_SRVC_CTY_NM,DIM_CLM_TRANS.CLM_SRC_PROV_SRVC_ST_CD CLM_SRC_PROV_SRVC_ST_CD,DIM_CLM_TRANS.CLM_SRC_PROV_SRVC_ZIP_CD CLM_SRC_PROV_SRVC_ZIP_CD,DIM_CLM_TRANS.CLM_SRC_PROV_SYS_ID CLM_SRC_PROV_SYS_ID,DIM_CLM_TRANS.CLM_SRC_PROV_TAX_ID_NBR CLM_SRC_PROV_TAX_ID_NBR,DIM_CLM_TRANS.CLM_TRANS_ACCOM_FLG CLM_TRANS_ACCOM_FLG,DIM_CLM_TRANS.CLM_TRANS_ADJ_CD CLM_TRANS_ADJ_CD,DIM_CLM_TRANS.CLM_TRANS_ADMIT_SRC_CD CLM_TRANS_ADMIT_SRC_CD,DIM_CLM_TRANS.CLM_TRANS_ADMIT_TYP_CD CLM_TRANS_ADMIT_TYP_CD,FCT_CLM_TRANS.CLM_TRANS_ALLW_AMT CLM_TRANS_ALLW_AMT,FCT_CLM_TRANS.CLM_TRANS_ALLW_DERIV_AMT CLM_TRANS_ALLW_DERIV_AMT,DIM_CLM_TRANS.CLM_TRANS_AUTH_NBR CLM_TRANS_AUTH_NBR,DIM_CLM_TRANS.CLM_TRANS_BEN_LVL_DERIV_CD CLM_TRANS_BEN_LVL_DERIV_CD,DIM_CLM_TRANS.CLM_TRANS_BEN_LVL_SRC_CD CLM_TRANS_BEN_LVL_SRC_CD,DIM_CLM_TRANS.CLM_TRANS_BILL_TYP_CD CLM_TRANS_BILL_TYP_CD,DIM_CLM_TRANS.CLM_TRANS_CAC_AUTH_SYS_ID CLM_TRANS_CAC_AUTH_SYS_ID,DIM_CLM_TRANS.CLM_TRANS_CHK_NBR CLM_TRANS_CHK_NBR,DIM_CLM_TRANS.CLM_TRANS_CLM_FM_TYP_CD CLM_TRANS_CLM_FM_TYP_CD,DIM_CLM_TRANS.CLM_TRANS_CLM_LVL_RSN_CD CLM_TRANS_CLM_LVL_RSN_CD,DIM_CLM_TRANS.CLM_TRANS_CLM_LVL_RSN_CD_DESC CLM_TRANS_CLM_LVL_RSN_CD_DESC,DIM_CLM_TRANS.CLM_TRANS_CLM_PRI_DIAG_CD CLM_TRANS_CLM_PRI_DIAG_CD,FCT_CLM_TRANS.CLM_TRANS_COB_AMT CLM_TRANS_COB_AMT,FCT_CLM_TRANS.CLM_TRANS_COINS_AMT CLM_TRANS_COINS_AMT,FCT_CLM_TRANS.CLM_TRANS_CONTR_AMT CLM_TRANS_CONTR_AMT,FCT_CLM_TRANS.CLM_TRANS_COPAY_AMT CLM_TRANS_COPAY_AMT,FCT_CLM_TRANS.CLM_TRANS_DED_AMT CLM_TRANS_DED_AMT,DIM_CLM_TRANS.CLM_TRANS_DIAG_1_CD CLM_TRANS_DIAG_1_CD,DIM_CLM_TRANS.CLM_TRANS_DIAG_1_CD_CATGY_LVL_1_DESC CLM_TRANS_DIAG_1_CD_CATGY_LVL_1_DESC,DIM_CLM_TRANS.CLM_TRANS_DIAG_1_CD_CATGY_LVL_2_DESC CLM_TRANS_DIAG_1_CD_CATGY_LVL_2_DESC,DIM_CLM_TRANS.CLM_TRANS_DIAG_1_CD_DESC CLM_TRANS_DIAG_1_CD_DESC,DIM_CLM_TRANS.CLM_TRANS_DIAG_1_CD_TYP_CD CLM_TRANS_DIAG_1_CD_TYP_CD,DIM_CLM_TRANS.CLM_TRANS_DIAG_1_DSM_TYP_CD CLM_TRANS_DIAG_1_DSM_TYP_CD,DIM_CLM_TRANS.CLM_TRANS_DIAG_2_CD CLM_TRANS_DIAG_2_CD,DIM_CLM_TRANS.CLM_TRANS_DIAG_2_CD_CATGY_LVL_1_DESC CLM_TRANS_DIAG_2_CD_CATGY_LVL_1_DESC,DIM_CLM_TRANS.CLM_TRANS_DIAG_2_CD_CATGY_LVL_2_DESC CLM_TRANS_DIAG_2_CD_CATGY_LVL_2_DESC,DIM_CLM_TRANS.CLM_TRANS_DIAG_2_CD_DESC CLM_TRANS_DIAG_2_CD_DESC,DIM_CLM_TRANS.CLM_TRANS_DIAG_2_CD_TYP_CD CLM_TRANS_DIAG_2_CD_TYP_CD,DIM_CLM_TRANS.CLM_TRANS_DIAG_2_DSM_TYP_CD CLM_TRANS_DIAG_2_DSM_TYP_CD,DIM_CLM_TRANS.CLM_TRANS_DIAG_3_CD CLM_TRANS_DIAG_3_CD,DIM_CLM_TRANS.CLM_TRANS_DIAG_3_CD_CATGY_LVL_1_DESC CLM_TRANS_DIAG_3_CD_CATGY_LVL_1_DESC,DIM_CLM_TRANS.CLM_TRANS_DIAG_3_CD_CATGY_LVL_2_DESC CLM_TRANS_DIAG_3_CD_CATGY_LVL_2_DESC,DIM_CLM_TRANS.CLM_TRANS_DIAG_3_CD_DESC CLM_TRANS_DIAG_3_CD_DESC,DIM_CLM_TRANS.CLM_TRANS_DIAG_3_CD_TYP_CD CLM_TRANS_DIAG_3_CD_TYP_CD,DIM_CLM_TRANS.CLM_TRANS_DIAG_3_DSM_TYP_CD CLM_TRANS_DIAG_3_DSM_TYP_CD,DIM_CLM_TRANS.CLM_TRANS_DIAG_MH_SA_CD CLM_TRANS_DIAG_MH_SA_CD,DIM_CLM_TRANS.CLM_TRANS_DIAG_SBSTNC_ABUS_FLG CLM_TRANS_DIAG_SBSTNC_ABUS_FLG,DIM_CLM_TRANS.CLM_TRANS_DLOC_CATGY_TXT CLM_TRANS_DLOC_CATGY_TXT,DIM_CLM_TRANS.CLM_TRANS_DLOC_SEQ_NBR CLM_TRANS_DLOC_SEQ_NBR,DIM_CLM_TRANS.CLM_TRANS_DLOC_TXT CLM_TRANS_DLOC_TXT,FCT_CLM_TRANS.CLM_TRANS_DSALLW_AMT CLM_TRANS_DSALLW_AMT,DIM_CLM_TRANS.CLM_TRANS_DSCHRG_STS_CD CLM_TRANS_DSCHRG_STS_CD,FCT_CLM_TRANS.CLM_TRANS_DSCNT_AMT CLM_TRANS_DSCNT_AMT,DIM_CLM_TRANS.CLM_TRANS_DT_ADJD_DT CLM_TRANS_DT_ADJD_DT,DIM_CLM_TRANS.CLM_TRANS_DT_ADMIT_DT CLM_TRANS_DT_ADMIT_DT,DIM_CLM_TRANS.CLM_TRANS_DT_CLM_FST_SRVC_DT CLM_TRANS_DT_CLM_FST_SRVC_DT,DIM_CLM_TRANS.CLM_TRANS_DT_CLM_LST_SRVC_DT CLM_TRANS_DT_CLM_LST_SRVC_DT,DIM_CLM_TRANS.CLM_TRANS_DT_ENT_DT CLM_TRANS_DT_ENT_DT,DIM_CLM_TRANS.CLM_TRANS_DT_PD_DT CLM_TRANS_DT_PD_DT,DIM_CLM_TRANS.CLM_TRANS_DT_PST_DT CLM_TRANS_DT_PST_DT,DIM_CLM_TRANS.CLM_TRANS_DT_RCVD_DT CLM_TRANS_DT_RCVD_DT,DIM_CLM_TRANS.CLM_TRANS_DT_SRVC_FROM_DT CLM_TRANS_DT_SRVC_FROM_DT,DIM_CLM_TRANS.CLM_TRANS_DT_SRVC_THRU_DT CLM_TRANS_DT_SRVC_THRU_DT,DIM_CLM_TRANS.CLM_TRANS_ENT_DIAG_REL_GRP_CD CLM_TRANS_ENT_DIAG_REL_GRP_CD,DIM_CLM_TRANS.CLM_TRANS_LVL_OF_SRVC_DERIV_CD CLM_TRANS_LVL_OF_SRVC_DERIV_CD,DIM_CLM_TRANS.CLM_TRANS_LVL_OF_SRVC_SRC_CD CLM_TRANS_LVL_OF_SRVC_SRC_CD,DIM_CLM_TRANS.CLM_TRANS_MBR_IN_YR_AGE CLM_TRANS_MBR_IN_YR_AGE,FCT_CLM_TRANS.CLM_TRANS_MBR_RESP_AMT CLM_TRANS_MBR_RESP_AMT,FCT_CLM_TRANS.CLM_TRANS_PD_AMT CLM_TRANS_PD_AMT,DIM_CLM_TRANS.CLM_TRANS_PL_OF_SRVC_AMA_CD CLM_TRANS_PL_OF_SRVC_AMA_CD,DIM_CLM_TRANS.CLM_TRANS_PL_OF_SRVC_SRC_CD CLM_TRANS_PL_OF_SRVC_SRC_CD,DIM_CLM_TRANS.CLM_TRANS_PRI_PAYE_CD CLM_TRANS_PRI_PAYE_CD,DIM_CLM_TRANS.CLM_TRANS_PRI_PAYE_CD_DESC CLM_TRANS_PRI_PAYE_CD_DESC,DIM_CLM_TRANS.CLM_TRANS_PROC_ADJD_OFC_DESC CLM_TRANS_PROC_ADJD_OFC_DESC,DIM_CLM_TRANS.CLM_TRANS_PROC_CD CLM_TRANS_PROC_CD,DIM_CLM_TRANS.CLM_TRANS_PROC_DESC CLM_TRANS_PROC_DESC,DIM_CLM_TRANS.CLM_TRANS_PROC_MOD_2_CD CLM_TRANS_PROC_MOD_2_CD,DIM_CLM_TRANS.CLM_TRANS_PROC_MOD_3_CD CLM_TRANS_PROC_MOD_3_CD,DIM_CLM_TRANS.CLM_TRANS_PROC_MOD_4_CD CLM_TRANS_PROC_MOD_4_CD,DIM_CLM_TRANS.CLM_TRANS_PROC_MOD_CD CLM_TRANS_PROC_MOD_CD,DIM_CLM_TRANS.CLM_TRANS_PROC_TYP_CD CLM_TRANS_PROC_TYP_CD,DIM_CLM_TRANS.CLM_TRANS_PROC_UNIT_OF_MSR_TXT,DIM_CLM_TRANS.CLM_TRANS_PROV_NTWK_DERIV_CD CLM_TRANS_PROV_NTWK_DERIV_CD,DIM_CLM_TRANS.CLM_TRANS_PYMT_OVRIDE_CD CLM_TRANS_PYMT_OVRIDE_CD,DIM_CLM_TRANS.CLM_TRANS_RSN_CD CLM_TRANS_RSN_CD,DIM_CLM_TRANS.CLM_TRANS_RSN_DESC CLM_TRANS_RSN_DESC,FCT_CLM_TRANS.CLM_TRANS_RSRV_AMT CLM_TRANS_RSRV_AMT,DIM_CLM_TRANS.CLM_TRANS_RVNU_CD CLM_TRANS_RVNU_CD,DIM_CLM_TRANS.CLM_TRANS_RVNU_DESC CLM_TRANS_RVNU_DESC,FCT_CLM_TRANS.CLM_TRANS_SBMT_AMT CLM_TRANS_SBMT_AMT,DIM_CLM_TRANS.CLM_TRANS_SBMT_SRC_DESC CLM_TRANS_SBMT_SRC_DESC,DIM_CLM_TRANS.CLM_TRANS_SEC_PROC_CD CLM_TRANS_SEC_PROC_CD,DIM_CLM_TRANS.CLM_TRANS_SEC_PROC_DESC CLM_TRANS_SEC_PROC_DESC,DIM_CLM_TRANS.CLM_TRANS_SEC_PROC_TYP_CD CLM_TRANS_SEC_PROC_TYP_CD,DIM_CLM_TRANS.CLM_TRANS_SYS_DIAG_REL_GRP_CD CLM_TRANS_SYS_DIAG_REL_GRP_CD,FCT_CLM_TRANS.CLM_TRANS_UNIT_CNT CLM_TRANS_UNIT_CNT,FCT_CLM_TRANS.CLM_TRANS_UNIT_DERIV_CNT CLM_TRANS_UNIT_DERIV_CNT,DIM_CLM_TRANS.DERIV_OBH_FINC_LIAB DERIV_OBH_FINC_LIAB,DIM_CLM_TRANS.ICD_DIAG_TYP_CD ICD_DIAG_TYP_CD,DIM_CLM_TRANS.PND_CLM_FLG PND_CLM_FLG FROM ECT_PRD_OBH_DP_DB.FOUNDATION.OCM_DIM_CLM_TRANS DIM_CLM_TRANS INNER JOIN ECT_PRD_OBH_DP_DB.FOUNDATION.OCM_FCT_CLM_TRANS FCT_CLM_TRANS ON DIM_CLM_TRANS.CLM_TRANS_SYS_ID = FCT_CLM_TRANS.CLM_TRANS_SYS_ID WHERE DIM_CLM_TRANS.CLM_AUD_SRC_SYS_CD='COSM' AND (DIM_CLM_TRANS.SF_UPDATE_DATETIME >= (SELECT NVL((SELECT LAST_LOAD_TIMESTAMP FROM ECT_PRD_OBH_DP_DB.FOUNDATION.OCM_OBHDP_LOAD_TIME WHERE PROC_NAME = 'OCM_CLM_TRANS_SRVC_LN_INC_LOAD_PROC' AND OCM_TABLE_NAME = 'OCM_DIM_CLM_TRANS'), (SELECT min(SF_UPDATE_DATETIME) FROM ECT_PRD_OBH_DP_DB.FOUNDATION.OCM_DIM_CLM_TRANS))) OR FCT_CLM_TRANS.SF_UPDATE_DATETIME >= (SELECT NVL((SELECT LAST_LOAD_TIMESTAMP FROM ECT_PRD_OBH_DP_DB.FOUNDATION.OCM_OBHDP_LOAD_TIME WHERE PROC_NAME = 'OCM_CLM_TRANS_SRVC_LN_INC_LOAD_PROC' AND OCM_TABLE_NAME = 'OCM_FCT_CLM_TRANS'), (SELECT min(SF_UPDATE_DATETIME) FROM ECT_PRD_OBH_DP_DB.FOUNDATION.OCM_FCT_CLM_TRANS))))) AS S on (T.CLM_TRANS_SYS_ID = S.CLM_TRANS_SYS_ID AND EQUAL_NULL(T.CLM_TRANS_DIAG_1_CD, S.CLM_TRANS_DIAG_1_CD) AND EQUAL_NULL(T.CLM_TRANS_DIAG_2_CD, S.CLM_TRANS_DIAG_2_CD) AND EQUAL_NULL(T.CLM_TRANS_CLM_PRI_DIAG_CD, S.CLM_TRANS_CLM_PRI_DIAG_CD) AND EQUAL_NULL(T.CLM_TRANS_PROC_CD, S.CLM_TRANS_PROC_CD) AND EQUAL_NULL(T.CLM_TRANS_SEC_PROC_CD, S.CLM_TRANS_SEC_PROC_CD) AND EQUAL_NULL(T.CLM_TRANS_PL_OF_SRVC_SRC_CD, S.CLM_TRANS_PL_OF_SRVC_SRC_CD) AND EQUAL_NULL(T.CLM_TRANS_PROV_NTWK_DERIV_CD, S.CLM_TRANS_PROV_NTWK_DERIV_CD)) when matched then update set T.CLM_TRANS_SYS_ID=S.CLM_TRANS_SYS_ID,T.CLM_AUD_LN_NBR=S.CLM_AUD_LN_NBR,T.CLM_AUD_NBR=S.CLM_AUD_NBR,T.CLM_AUD_SRC_ID=S.CLM_AUD_SRC_ID,T.CLM_AUD_SRC_SYS_CD=S.CLM_AUD_SRC_SYS_CD,T.CLM_AUD_TRANS_SEQ_NBR=S.CLM_AUD_TRANS_SEQ_NBR,T.CLM_ETL_DW_FROM_DT=S.CLM_ETL_DW_FROM_DT,T.CLM_ETL_DW_SYS_ID=S.CLM_ETL_DW_SYS_ID,T.CLM_SRC_AUTH_NBR=S.CLM_SRC_AUTH_NBR,T.CLM_SRC_COSM_DIV_CD=S.CLM_SRC_COSM_DIV_CD,T.CLM_SRC_LEG_ENTY_NBR=S.CLM_SRC_LEG_ENTY_NBR,T.CLM_SRC_MBR_CUST_SEG_NBR=S.CLM_SRC_MBR_CUST_SEG_NBR,T.CLM_SRC_MBR_DEPN_CD=S.CLM_SRC_MBR_DEPN_CD,T.CLM_SRC_MBR_GDR_CD=S.CLM_SRC_MBR_GDR_CD,T.CLM_SRC_MBR_NON_UHG_EE_FLG=S.CLM_SRC_MBR_NON_UHG_EE_FLG,T.CLM_SRC_MBR_PLN_ID=S.CLM_SRC_MBR_PLN_ID,T.CLM_SRC_MBR_PRDCT_CD=S.CLM_SRC_MBR_PRDCT_CD,T.CLM_SRC_MBR_SBSCR_ID=S.CLM_SRC_MBR_SBSCR_ID,T.CLM_SRC_MBR_SYS_ID=S.CLM_SRC_MBR_SYS_ID,T.CLM_SRC_PROV_CLM_BIL_NPI_ID=S.CLM_SRC_PROV_CLM_BIL_NPI_ID,T.CLM_SRC_PROV_CLM_NPI_ID=S.CLM_SRC_PROV_CLM_NPI_ID,T.CLM_SRC_PROV_CLM_REF_NPI_ID=S.CLM_SRC_PROV_CLM_REF_NPI_ID,T.CLM_SRC_PROV_CLM_SRVC_NPI_ID=S.CLM_SRC_PROV_CLM_SRVC_NPI_ID,T.CLM_SRC_PROV_PAYE_NM=S.CLM_SRC_PROV_PAYE_NM,T.CLM_SRC_PROV_SRVC_CTY_NM=S.CLM_SRC_PROV_SRVC_CTY_NM,T.CLM_SRC_PROV_SRVC_ST_CD=S.CLM_SRC_PROV_SRVC_ST_CD,T.CLM_SRC_PROV_SRVC_ZIP_CD=S.CLM_SRC_PROV_SRVC_ZIP_CD,T.CLM_SRC_PROV_SYS_ID=S.CLM_SRC_PROV_SYS_ID,T.CLM_SRC_PROV_TAX_ID_NBR=S.CLM_SRC_PROV_TAX_ID_NBR,T.CLM_TRANS_ACCOM_FLG=S.CLM_TRANS_ACCOM_FLG,T.CLM_TRANS_ADJ_CD=S.CLM_TRANS_ADJ_CD,T.CLM_TRANS_ADMIT_SRC_CD=S.CLM_TRANS_ADMIT_SRC_CD,T.CLM_TRANS_ADMIT_TYP_CD=S.CLM_TRANS_ADMIT_TYP_CD,T.CLM_TRANS_ALLW_AMT=S.CLM_TRANS_ALLW_AMT,T.CLM_TRANS_ALLW_DERIV_AMT=S.CLM_TRANS_ALLW_DERIV_AMT,T.CLM_TRANS_AUTH_NBR=S.CLM_TRANS_AUTH_NBR,T.CLM_TRANS_BEN_LVL_DERIV_CD=S.CLM_TRANS_BEN_LVL_DERIV_CD,T.CLM_TRANS_BEN_LVL_SRC_CD=S.CLM_TRANS_BEN_LVL_SRC_CD,T.CLM_TRANS_BILL_TYP_CD=S.CLM_TRANS_BILL_TYP_CD,T.CLM_TRANS_CAC_AUTH_SYS_ID=S.CLM_TRANS_CAC_AUTH_SYS_ID,T.CLM_TRANS_CHK_NBR=S.CLM_TRANS_CHK_NBR,T.CLM_TRANS_CLM_FM_TYP_CD=S.CLM_TRANS_CLM_FM_TYP_CD,T.CLM_TRANS_CLM_LVL_RSN_CD=S.CLM_TRANS_CLM_LVL_RSN_CD,T.CLM_TRANS_CLM_LVL_RSN_CD_DESC=S.CLM_TRANS_CLM_LVL_RSN_CD_DESC,T.CLM_TRANS_CLM_PRI_DIAG_CD=S.CLM_TRANS_CLM_PRI_DIAG_CD,T.CLM_TRANS_COB_AMT=S.CLM_TRANS_COB_AMT,T.CLM_TRANS_COINS_AMT=S.CLM_TRANS_COINS_AMT,T.CLM_TRANS_CONTR_AMT=S.CLM_TRANS_CONTR_AMT,T.CLM_TRANS_COPAY_AMT=S.CLM_TRANS_COPAY_AMT,T.CLM_TRANS_DED_AMT=S.CLM_TRANS_DED_AMT,T.CLM_TRANS_DIAG_1_CD=S.CLM_TRANS_DIAG_1_CD,T.CLM_TRANS_DIAG_1_CD_CATGY_LVL_1_DESC=S.CLM_TRANS_DIAG_1_CD_CATGY_LVL_1_DESC,T.CLM_TRANS_DIAG_1_CD_CATGY_LVL_2_DESC=S.CLM_TRANS_DIAG_1_CD_CATGY_LVL_2_DESC,T.CLM_TRANS_DIAG_1_CD_DESC=S.CLM_TRANS_DIAG_1_CD_DESC,T.CLM_TRANS_DIAG_1_CD_TYP_CD=S.CLM_TRANS_DIAG_1_CD_TYP_CD,T.CLM_TRANS_DIAG_1_DSM_TYP_CD=S.CLM_TRANS_DIAG_1_DSM_TYP_CD,T.CLM_TRANS_DIAG_2_CD=S.CLM_TRANS_DIAG_2_CD,T.CLM_TRANS_DIAG_2_CD_CATGY_LVL_1_DESC=S.CLM_TRANS_DIAG_2_CD_CATGY_LVL_1_DESC,T.CLM_TRANS_DIAG_2_CD_CATGY_LVL_2_DESC=S.CLM_TRANS_DIAG_2_CD_CATGY_LVL_2_DESC,T.CLM_TRANS_DIAG_2_CD_DESC=S.CLM_TRANS_DIAG_2_CD_DESC,T.CLM_TRANS_DIAG_2_CD_TYP_CD=S.CLM_TRANS_DIAG_2_CD_TYP_CD,T.CLM_TRANS_DIAG_2_DSM_TYP_CD=S.CLM_TRANS_DIAG_2_DSM_TYP_CD,T.CLM_TRANS_DIAG_3_CD=S.CLM_TRANS_DIAG_3_CD,T.CLM_TRANS_DIAG_3_CD_CATGY_LVL_1_DESC=S.CLM_TRANS_DIAG_3_CD_CATGY_LVL_1_DESC,T.CLM_TRANS_DIAG_3_CD_CATGY_LVL_2_DESC=S.CLM_TRANS_DIAG_3_CD_CATGY_LVL_2_DESC,T.CLM_TRANS_DIAG_3_CD_DESC=S.CLM_TRANS_DIAG_3_CD_DESC,T.CLM_TRANS_DIAG_3_CD_TYP_CD=S.CLM_TRANS_DIAG_3_CD_TYP_CD,T.CLM_TRANS_DIAG_3_DSM_TYP_CD=S.CLM_TRANS_DIAG_3_DSM_TYP_CD,T.CLM_TRANS_DIAG_MH_SA_CD=S.CLM_TRANS_DIAG_MH_SA_CD,T.CLM_TRANS_DIAG_SBSTNC_ABUS_FLG=S.CLM_TRANS_DIAG_SBSTNC_ABUS_FLG,T.CLM_TRANS_DLOC_CATGY_TXT=S.CLM_TRANS_DLOC_CATGY_TXT,T.CLM_TRANS_DLOC_SEQ_NBR=S.CLM_TRANS_DLOC_SEQ_NBR,T.CLM_TRANS_DLOC_TXT=S.CLM_TRANS_DLOC_TXT,T.CLM_TRANS_DSALLW_AMT=S.CLM_TRANS_DSALLW_AMT,T.CLM_TRANS_DSCHRG_STS_CD=S.CLM_TRANS_DSCHRG_STS_CD,T.CLM_TRANS_DSCNT_AMT=S.CLM_TRANS_DSCNT_AMT,T.CLM_TRANS_DT_ADJD_DT=S.CLM_TRANS_DT_ADJD_DT,T.CLM_TRANS_DT_ADMIT_DT=S.CLM_TRANS_DT_ADMIT_DT,T.CLM_TRANS_DT_CLM_FST_SRVC_DT=S.CLM_TRANS_DT_CLM_FST_SRVC_DT,T.CLM_TRANS_DT_CLM_LST_SRVC_DT=S.CLM_TRANS_DT_CLM_LST_SRVC_DT,T.CLM_TRANS_DT_ENT_DT=S.CLM_TRANS_DT_ENT_DT,T.CLM_TRANS_DT_PD_DT=S.CLM_TRANS_DT_PD_DT,T.CLM_TRANS_DT_PST_DT=S.CLM_TRANS_DT_PST_DT,T.CLM_TRANS_DT_RCVD_DT=S.CLM_TRANS_DT_RCVD_DT,T.CLM_TRANS_DT_SRVC_FROM_DT=S.CLM_TRANS_DT_SRVC_FROM_DT,T.CLM_TRANS_DT_SRVC_THRU_DT=S.CLM_TRANS_DT_SRVC_THRU_DT,T.CLM_TRANS_ENT_DIAG_REL_GRP_CD=S.CLM_TRANS_ENT_DIAG_REL_GRP_CD,T.CLM_TRANS_LVL_OF_SRVC_DERIV_CD=S.CLM_TRANS_LVL_OF_SRVC_DERIV_CD,T.CLM_TRANS_LVL_OF_SRVC_SRC_CD=S.CLM_TRANS_LVL_OF_SRVC_SRC_CD,T.CLM_TRANS_MBR_IN_YR_AGE=S.CLM_TRANS_MBR_IN_YR_AGE,T.CLM_TRANS_MBR_RESP_AMT=S.CLM_TRANS_MBR_RESP_AMT,T.CLM_TRANS_PD_AMT=S.CLM_TRANS_PD_AMT,T.CLM_TRANS_PL_OF_SRVC_AMA_CD=S.CLM_TRANS_PL_OF_SRVC_AMA_CD,T.CLM_TRANS_PL_OF_SRVC_SRC_CD=S.CLM_TRANS_PL_OF_SRVC_SRC_CD,T.CLM_TRANS_PRI_PAYE_CD=S.CLM_TRANS_PRI_PAYE_CD,T.CLM_TRANS_PRI_PAYE_CD_DESC=S.CLM_TRANS_PRI_PAYE_CD_DESC,T.CLM_TRANS_PROC_ADJD_OFC_DESC=S.CLM_TRANS_PROC_ADJD_OFC_DESC,T.CLM_TRANS_PROC_CD=S.CLM_TRANS_PROC_CD,T.CLM_TRANS_PROC_DESC=S.CLM_TRANS_PROC_DESC,T.CLM_TRANS_PROC_MOD_2_CD=S.CLM_TRANS_PROC_MOD_2_CD,T.CLM_TRANS_PROC_MOD_3_CD=S.CLM_TRANS_PROC_MOD_3_CD,T.CLM_TRANS_PROC_MOD_4_CD=S.CLM_TRANS_PROC_MOD_4_CD,T.CLM_TRANS_PROC_MOD_CD=S.CLM_TRANS_PROC_MOD_CD,T.CLM_TRANS_PROC_TYP_CD=S.CLM_TRANS_PROC_TYP_CD,T.CLM_TRANS_PROC_UNIT_OF_MSR_TXT=S.CLM_TRANS_PROC_UNIT_OF_MSR_TXT,T.CLM_TRANS_PROV_NTWK_DERIV_CD=S.CLM_TRANS_PROV_NTWK_DERIV_CD,T.CLM_TRANS_PYMT_OVRIDE_CD=S.CLM_TRANS_PYMT_OVRIDE_CD,T.CLM_TRANS_RSN_CD=S.CLM_TRANS_RSN_CD,T.CLM_TRANS_RSN_DESC=S.CLM_TRANS_RSN_DESC,T.CLM_TRANS_RSRV_AMT=S.CLM_TRANS_RSRV_AMT,T.CLM_TRANS_RVNU_CD=S.CLM_TRANS_RVNU_CD,T.CLM_TRANS_RVNU_DESC=S.CLM_TRANS_RVNU_DESC,T.CLM_TRANS_SBMT_AMT=S.CLM_TRANS_SBMT_AMT,T.CLM_TRANS_SBMT_SRC_DESC=S.CLM_TRANS_SBMT_SRC_DESC,T.CLM_TRANS_SEC_PROC_CD=S.CLM_TRANS_SEC_PROC_CD,T.CLM_TRANS_SEC_PROC_DESC=S.CLM_TRANS_SEC_PROC_DESC,T.CLM_TRANS_SEC_PROC_TYP_CD=S.CLM_TRANS_SEC_PROC_TYP_CD,T.CLM_TRANS_SYS_DIAG_REL_GRP_CD=S.CLM_TRANS_SYS_DIAG_REL_GRP_CD,T.CLM_TRANS_UNIT_CNT=S.CLM_TRANS_UNIT_CNT,T.CLM_TRANS_UNIT_DERIV_CNT=S.CLM_TRANS_UNIT_DERIV_CNT,T.DERIV_OBH_FINC_LIAB=S.DERIV_OBH_FINC_LIAB,T.ICD_DIAG_TYP_CD=S.ICD_DIAG_TYP_CD,T.PND_CLM_FLG=S.PND_CLM_FLG,T.SF_UPDATE_DATETIME = CURRENT_TIMESTAMP() when not matched then INSERT (CLM_TRANS_SYS_ID,CLM_AUD_LN_NBR,CLM_AUD_NBR,CLM_AUD_SRC_ID,CLM_AUD_SRC_SYS_CD,CLM_AUD_TRANS_SEQ_NBR,CLM_ETL_DW_FROM_DT,CLM_ETL_DW_SYS_ID,CLM_SRC_AUTH_NBR,CLM_SRC_COSM_DIV_CD,CLM_SRC_LEG_ENTY_NBR,CLM_SRC_MBR_CUST_SEG_NBR,CLM_SRC_MBR_DEPN_CD,CLM_SRC_MBR_GDR_CD,CLM_SRC_MBR_NON_UHG_EE_FLG,CLM_SRC_MBR_PLN_ID,CLM_SRC_MBR_PRDCT_CD,CLM_SRC_MBR_SBSCR_ID,CLM_SRC_MBR_SYS_ID,CLM_SRC_PROV_CLM_BIL_NPI_ID,CLM_SRC_PROV_CLM_NPI_ID,CLM_SRC_PROV_CLM_REF_NPI_ID,CLM_SRC_PROV_CLM_SRVC_NPI_ID,CLM_SRC_PROV_PAYE_NM,CLM_SRC_PROV_SRVC_CTY_NM,CLM_SRC_PROV_SRVC_ST_CD,CLM_SRC_PROV_SRVC_ZIP_CD,CLM_SRC_PROV_SYS_ID,CLM_SRC_PROV_TAX_ID_NBR,CLM_TRANS_ACCOM_FLG,CLM_TRANS_ADJ_CD,CLM_TRANS_ADMIT_SRC_CD,CLM_TRANS_ADMIT_TYP_CD,CLM_TRANS_ALLW_AMT,CLM_TRANS_ALLW_DERIV_AMT,CLM_TRANS_AUTH_NBR,CLM_TRANS_BEN_LVL_DERIV_CD,CLM_TRANS_BEN_LVL_SRC_CD,CLM_TRANS_BILL_TYP_CD,CLM_TRANS_CAC_AUTH_SYS_ID,CLM_TRANS_CHK_NBR,CLM_TRANS_CLM_FM_TYP_CD,CLM_TRANS_CLM_LVL_RSN_CD,CLM_TRANS_CLM_LVL_RSN_CD_DESC,CLM_TRANS_CLM_PRI_DIAG_CD,CLM_TRANS_COB_AMT,CLM_TRANS_COINS_AMT,CLM_TRANS_CONTR_AMT,CLM_TRANS_COPAY_AMT,CLM_TRANS_DED_AMT,CLM_TRANS_DIAG_1_CD,CLM_TRANS_DIAG_1_CD_CATGY_LVL_1_DESC,CLM_TRANS_DIAG_1_CD_CATGY_LVL_2_DESC,CLM_TRANS_DIAG_1_CD_DESC,CLM_TRANS_DIAG_1_CD_TYP_CD,CLM_TRANS_DIAG_1_DSM_TYP_CD,CLM_TRANS_DIAG_2_CD,CLM_TRANS_DIAG_2_CD_CATGY_LVL_1_DESC,CLM_TRANS_DIAG_2_CD_CATGY_LVL_2_DESC,CLM_TRANS_DIAG_2_CD_DESC,CLM_TRANS_DIAG_2_CD_TYP_CD,CLM_TRANS_DIAG_2_DSM_TYP_CD,CLM_TRANS_DIAG_3_CD,CLM_TRANS_DIAG_3_CD_CATGY_LVL_1_DESC,CLM_TRANS_DIAG_3_CD_CATGY_LVL_2_DESC,CLM_TRANS_DIAG_3_CD_DESC,CLM_TRANS_DIAG_3_CD_TYP_CD,CLM_TRANS_DIAG_3_DSM_TYP_CD,CLM_TRANS_DIAG_MH_SA_CD,CLM_TRANS_DIAG_SBSTNC_ABUS_FLG,CLM_TRANS_DLOC_CATGY_TXT,CLM_TRANS_DLOC_SEQ_NBR,CLM_TRANS_DLOC_TXT,CLM_TRANS_DSALLW_AMT,CLM_TRANS_DSCHRG_STS_CD,CLM_TRANS_DSCNT_AMT,CLM_TRANS_DT_ADJD_DT,CLM_TRANS_DT_ADMIT_DT,CLM_TRANS_DT_CLM_FST_SRVC_DT,CLM_TRANS_DT_CLM_LST_SRVC_DT,CLM_TRANS_DT_ENT_DT,CLM_TRANS_DT_PD_DT,CLM_TRANS_DT_PST_DT,CLM_TRANS_DT_RCVD_DT,CLM_TRANS_DT_SRVC_FROM_DT,CLM_TRANS_DT_SRVC_THRU_DT,CLM_TRANS_ENT_DIAG_REL_GRP_CD,CLM_TRANS_LVL_OF_SRVC_DERIV_CD,CLM_TRANS_LVL_OF_SRVC_SRC_CD,CLM_TRANS_MBR_IN_YR_AGE,CLM_TRANS_MBR_RESP_AMT,CLM_TRANS_PD_AMT,CLM_TRANS_PL_OF_SRVC_AMA_CD,CLM_TRANS_PL_OF_SRVC_SRC_CD,CLM_TRANS_PRI_PAYE_CD,CLM_TRANS_PRI_PAYE_CD_DESC,CLM_TRANS_PROC_ADJD_OFC_DESC,CLM_TRANS_PROC_CD,CLM_TRANS_PROC_DESC,CLM_TRANS_PROC_MOD_2_CD,CLM_TRANS_PROC_MOD_3_CD,CLM_TRANS_PROC_MOD_4_CD,CLM_TRANS_PROC_MOD_CD,CLM_TRANS_PROC_TYP_CD,CLM_TRANS_PROC_UNIT_OF_MSR_TXT,CLM_TRANS_PROV_NTWK_DERIV_CD,CLM_TRANS_PYMT_OVRIDE_CD,CLM_TRANS_RSN_CD,CLM_TRANS_RSN_DESC,CLM_TRANS_RSRV_AMT,CLM_TRANS_RVNU_CD,CLM_TRANS_RVNU_DESC,CLM_TRANS_SBMT_AMT,CLM_TRANS_SBMT_SRC_DESC,CLM_TRANS_SEC_PROC_CD,CLM_TRANS_SEC_PROC_DESC,CLM_TRANS_SEC_PROC_TYP_CD,CLM_TRANS_SYS_DIAG_REL_GRP_CD,CLM_TRANS_UNIT_CNT,CLM_TRANS_UNIT_DERIV_CNT,DERIV_OBH_FINC_LIAB,ICD_DIAG_TYP_CD,PND_CLM_FLG) values(S.CLM_TRANS_SYS_ID,S.CLM_AUD_LN_NBR,S.CLM_AUD_NBR,S.CLM_AUD_SRC_ID,S.CLM_AUD_SRC_SYS_CD,S.CLM_AUD_TRANS_SEQ_NBR,S.CLM_ETL_DW_FROM_DT,S.CLM_ETL_DW_SYS_ID,S.CLM_SRC_AUTH_NBR,S.CLM_SRC_COSM_DIV_CD,S.CLM_SRC_LEG_ENTY_NBR,S.CLM_SRC_MBR_CUST_SEG_NBR,S.CLM_SRC_MBR_DEPN_CD,S.CLM_SRC_MBR_GDR_CD,S.CLM_SRC_MBR_NON_UHG_EE_FLG,S.CLM_SRC_MBR_PLN_ID,S.CLM_SRC_MBR_PRDCT_CD,S.CLM_SRC_MBR_SBSCR_ID,S.CLM_SRC_MBR_SYS_ID,S.CLM_SRC_PROV_CLM_BIL_NPI_ID,S.CLM_SRC_PROV_CLM_NPI_ID,S.CLM_SRC_PROV_CLM_REF_NPI_ID,S.CLM_SRC_PROV_CLM_SRVC_NPI_ID,S.CLM_SRC_PROV_PAYE_NM,S.CLM_SRC_PROV_SRVC_CTY_NM,S.CLM_SRC_PROV_SRVC_ST_CD,S.CLM_SRC_PROV_SRVC_ZIP_CD,S.CLM_SRC_PROV_SYS_ID,S.CLM_SRC_PROV_TAX_ID_NBR,S.CLM_TRANS_ACCOM_FLG,S.CLM_TRANS_ADJ_CD,S.CLM_TRANS_ADMIT_SRC_CD,S.CLM_TRANS_ADMIT_TYP_CD,S.CLM_TRANS_ALLW_AMT,S.CLM_TRANS_ALLW_DERIV_AMT,S.CLM_TRANS_AUTH_NBR,S.CLM_TRANS_BEN_LVL_DERIV_CD,S.CLM_TRANS_BEN_LVL_SRC_CD,S.CLM_TRANS_BILL_TYP_CD,S.CLM_TRANS_CAC_AUTH_SYS_ID,S.CLM_TRANS_CHK_NBR,S.CLM_TRANS_CLM_FM_TYP_CD,S.CLM_TRANS_CLM_LVL_RSN_CD,S.CLM_TRANS_CLM_LVL_RSN_CD_DESC,S.CLM_TRANS_CLM_PRI_DIAG_CD,S.CLM_TRANS_COB_AMT,S.CLM_TRANS_COINS_AMT,S.CLM_TRANS_CONTR_AMT,S.CLM_TRANS_COPAY_AMT,S.CLM_TRANS_DED_AMT,S.CLM_TRANS_DIAG_1_CD,S.CLM_TRANS_DIAG_1_CD_CATGY_LVL_1_DESC,S.CLM_TRANS_DIAG_1_CD_CATGY_LVL_2_DESC,S.CLM_TRANS_DIAG_1_CD_DESC,S.CLM_TRANS_DIAG_1_CD_TYP_CD,S.CLM_TRANS_DIAG_1_DSM_TYP_CD,S.CLM_TRANS_DIAG_2_CD,S.CLM_TRANS_DIAG_2_CD_CATGY_LVL_1_DESC,S.CLM_TRANS_DIAG_2_CD_CATGY_LVL_2_DESC,S.CLM_TRANS_DIAG_2_CD_DESC,S.CLM_TRANS_DIAG_2_CD_TYP_CD,S.CLM_TRANS_DIAG_2_DSM_TYP_CD,S.CLM_TRANS_DIAG_3_CD,S.CLM_TRANS_DIAG_3_CD_CATGY_LVL_1_DESC,S.CLM_TRANS_DIAG_3_CD_CATGY_LVL_2_DESC,S.CLM_TRANS_DIAG_3_CD_DESC,S.CLM_TRANS_DIAG_3_CD_TYP_CD,S.CLM_TRANS_DIAG_3_DSM_TYP_CD,S.CLM_TRANS_DIAG_MH_SA_CD,S.CLM_TRANS_DIAG_SBSTNC_ABUS_FLG,S.CLM_TRANS_DLOC_CATGY_TXT,S.CLM_TRANS_DLOC_SEQ_NBR,S.CLM_TRANS_DLOC_TXT,S.CLM_TRANS_DSALLW_AMT,S.CLM_TRANS_DSCHRG_STS_CD,S.CLM_TRANS_DSCNT_AMT,S.CLM_TRANS_DT_ADJD_DT,S.CLM_TRANS_DT_ADMIT_DT,S.CLM_TRANS_DT_CLM_FST_SRVC_DT,S.CLM_TRANS_DT_CLM_LST_SRVC_DT,S.CLM_TRANS_DT_ENT_DT,S.CLM_TRANS_DT_PD_DT,S.CLM_TRANS_DT_PST_DT,S.CLM_TRANS_DT_RCVD_DT,S.CLM_TRANS_DT_SRVC_FROM_DT,S.CLM_TRANS_DT_SRVC_THRU_DT,S.CLM_TRANS_ENT_DIAG_REL_GRP_CD,S.CLM_TRANS_LVL_OF_SRVC_DERIV_CD,S.CLM_TRANS_LVL_OF_SRVC_SRC_CD,S.CLM_TRANS_MBR_IN_YR_AGE,S.CLM_TRANS_MBR_RESP_AMT,S.CLM_TRANS_PD_AMT,S.CLM_TRANS_PL_OF_SRVC_AMA_CD,S.CLM_TRANS_PL_OF_SRVC_SRC_CD,S.CLM_TRANS_PRI_PAYE_CD,S.CLM_TRANS_PRI_PAYE_CD_DESC,S.CLM_TRANS_PROC_ADJD_OFC_DESC,S.CLM_TRANS_PROC_CD,S.CLM_TRANS_PROC_DESC,S.CLM_TRANS_PROC_MOD_2_CD,S.CLM_TRANS_PROC_MOD_3_CD,S.CLM_TRANS_PROC_MOD_4_CD,S.CLM_TRANS_PROC_MOD_CD,S.CLM_TRANS_PROC_TYP_CD,S.CLM_TRANS_PROC_UNIT_OF_MSR_TXT,S.CLM_TRANS_PROV_NTWK_DERIV_CD,S.CLM_TRANS_PYMT_OVRIDE_CD,S.CLM_TRANS_RSN_CD,S.CLM_TRANS_RSN_DESC,S.CLM_TRANS_RSRV_AMT,S.CLM_TRANS_RVNU_CD,S.CLM_TRANS_RVNU_DESC,S.CLM_TRANS_SBMT_AMT,S.CLM_TRANS_SBMT_SRC_DESC,S.CLM_TRANS_SEC_PROC_CD,S.CLM_TRANS_SEC_PROC_DESC,S.CLM_TRANS_SEC_PROC_TYP_CD,S.CLM_TRANS_SYS_DIAG_REL_GRP_CD,S.CLM_TRANS_UNIT_CNT,S.CLM_TRANS_UNIT_DERIV_CNT,S.DERIV_OBH_FINC_LIAB,S.ICD_DIAG_TYP_CD,S.PND_CLM_FLG)"
snowflake.execute ({sqlText: sql_OCM_CLM_TRANS_SRVC_LN_merge_command});

while (res_OCM_DIM_CLM_TRANS_max_load_timestamp.next()) {
var sql_OCM_DIM_CLM_TRANS_max_load_timestamp = "merge into ECT_PRD_OBH_DP_DB.FOUNDATION.OCM_OBHDP_LOAD_TIME AS T using (SELECT 'OCM_CLM_TRANS_SRVC_LN_INC_LOAD_PROC' PROC_NAME, 'OCM_DIM_CLM_TRANS' OCM_TABLE_NAME, (select to_timestamp_ntz(SPLIT_PART('" + res_OCM_DIM_CLM_TRANS_max_load_timestamp.getColumnValue(1) + "', 'GMT', 1), 'DY MON DD YYYY HH24:MI:SS')) LAST_LOAD_TIMESTAMP) AS S on T.PROC_NAME = S.PROC_NAME AND T.OCM_TABLE_NAME = S.OCM_TABLE_NAME when matched then update set T.LAST_LOAD_TIMESTAMP = S.LAST_LOAD_TIMESTAMP when not matched then INSERT(PROC_NAME, OCM_TABLE_NAME,LAST_LOAD_TIMESTAMP) values (S.PROC_NAME, S.OCM_TABLE_NAME, S.LAST_LOAD_TIMESTAMP);"
snowflake.execute (
          {sqlText: sql_OCM_DIM_CLM_TRANS_max_load_timestamp}
    );
}

while (res_OCM_FCT_CLM_TRANS_max_load_timestamp.next()) {
var sql_OCM_FCT_CLM_TRANS_max_load_timestamp = "merge into ECT_PRD_OBH_DP_DB.FOUNDATION.OCM_OBHDP_LOAD_TIME AS T using (SELECT 'OCM_CLM_TRANS_SRVC_LN_INC_LOAD_PROC' PROC_NAME, 'OCM_FCT_CLM_TRANS' OCM_TABLE_NAME, (select to_timestamp_ntz(SPLIT_PART('" + res_OCM_FCT_CLM_TRANS_max_load_timestamp.getColumnValue(1) + "', 'GMT', 1), 'DY MON DD YYYY HH24:MI:SS')) LAST_LOAD_TIMESTAMP) AS S on T.PROC_NAME = S.PROC_NAME AND T.OCM_TABLE_NAME = S.OCM_TABLE_NAME when matched then update set T.LAST_LOAD_TIMESTAMP = S.LAST_LOAD_TIMESTAMP when not matched then INSERT(PROC_NAME, OCM_TABLE_NAME,LAST_LOAD_TIMESTAMP) values (S.PROC_NAME, S.OCM_TABLE_NAME, S.LAST_LOAD_TIMESTAMP);"
snowflake.execute (
          {sqlText: sql_OCM_FCT_CLM_TRANS_max_load_timestamp}
    );
}

return "Succeeded.";   // Return a success/error indicator.
}
catch (err)  {
  return "Failed: " + err;   // Return a success/error indicator.
}

$$;