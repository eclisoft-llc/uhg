CREATE OR REPLACE TABLE COMPACT.IMDM_INDV_DM CLONE COMPACT.IMDM_INDV;

create or replace view TCOC.IMDM_INDV(
	IMDM_ID COMMENT 'Unique Identifier assigned to an individual by enterprise individual master data management [iMDM EID]',
	SSN,
	MDCDID,
	SBSCRID,
	MDCRID,
	URSLID,
	RXCL1_CAGMID,
	RXCL2_CAGMID,
	RXCC_CAGMID,
	EDWPRSID,
	SMRTPRSID,
	BH_IND,
	FST_NM COMMENT 'First/Given name of the individual',
	LST_NM COMMENT 'Last/Surname/Family name of the individual',
	BTH_DT COMMENT 'Date of birth of the individual',
	DCSD_DT COMMENT 'Deceased Date of the individual',
	GDR_CD COMMENT 'Gender Code of the individual',
	ADDR_LN_1 COMMENT 'Street address for primary address of the individual',
	ADDR_LN_2 COMMENT 'The apartment/suite number for primary address of the individual',
	ADDR_LN_3 COMMENT 'The apartment/suite number for primary address of the individual',
	CTY_NM COMMENT 'Name of the city for primary address of the individual',
	ST_CD COMMENT 'State Code for primary address of the individual',
	PST_CD COMMENT 'Postal/Zip code for primary address of the individual',
	CNTY_NM COMMENT 'Name of the county for primary address of the individual',
	CNTRY_CD COMMENT 'Name of the country for primary address of the individual',
	LAT COMMENT 'Latitude for primary address of the individual',
	LONG COMMENT 'Longitude for primary address of the individual',
	ADDR_STD_IND,
	ADDR_PRF_IND,
	ADDR_VLD_IND,
	EML_ADDR COMMENT 'Primary Electronical mail address provided by the individual',
	EML_ADDR_PRF_IND,
	EML_ADDR_VLD_IND,
	PH_NBR COMMENT 'Primary Phone number provider by the individual',
	PH_NBR_TYP,
	PH_NBR_PRF_IND,
	PH_NBR_VLD_IND,
	CDC_FLAG,
	SF_INSERT_DATETIME,
	SF_UPDATE_DATETIME,
	SF_PROCESS_ID
) as SELECT DISTINCT
IMDM_ID,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN SSN ELSE '' END AS SSN,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN MDCDID ELSE '' END AS MDCDID,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN SBSCRID ELSE '' END AS SBSCRID,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN MDCRID ELSE '' END AS MDCRID,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN URSLID ELSE '' END AS URSLID,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN RXCL1_CAGMID ELSE '' END AS RXCL1_CAGMID,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN RXCL2_CAGMID ELSE '' END AS RXCL2_CAGMID,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN RXCC_CAGMID ELSE '' END AS RXCC_CAGMID,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN EDWPRSID ELSE '' END AS EDWPRSID,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN SMRTPRSID ELSE '' END AS SMRTPRSID,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN BH_IND ELSE '' END AS BH_IND,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN FST_NM ELSE '' END AS FST_NM,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN LST_NM ELSE '' END AS LST_NM,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN BTH_DT ELSE TO_DATE('1800-01-01','YYYY-MM-DD') END AS BTH_DT,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN DCSD_DT ELSE TO_DATE('1800-01-01','YYYY-MM-DD') END AS DCSD_DT,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN GDR_CD ELSE '' END AS GDR_CD,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN ADDR_LN_1 ELSE '' END AS ADDR_LN_1,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN ADDR_LN_2 ELSE '' END AS ADDR_LN_2,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN ADDR_LN_3 ELSE '' END AS ADDR_LN_3,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN CTY_NM ELSE '' END AS CTY_NM,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN ST_CD ELSE '' END AS ST_CD,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN PST_CD ELSE '' END AS PST_CD,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN CNTY_NM ELSE '' END AS CNTY_NM,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN CNTRY_CD ELSE '' END AS CNTRY_CD,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN LAT ELSE '0' END AS LAT,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN LONG ELSE '0' END AS LONG,
ADDR_STD_IND,
ADDR_PRF_IND,
ADDR_VLD_IND,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN EML_ADDR ELSE '' END AS EML_ADDR,
EML_ADDR_PRF_IND,
EML_ADDR_VLD_IND,
CASE WHEN CURRENT_ROLE() LIKE ANY ('%_OBHDPSAS_OPTUM_ROLE','%_DEBBY_POON_OPTUM_ROLE') THEN PH_NBR ELSE '' END AS PH_NBR,
PH_NBR_TYP,
PH_NBR_PRF_IND,
PH_NBR_VLD_IND,
CDC_FLAG,
SF_INSERT_DATETIME,
SF_UPDATE_DATETIME,
SF_PROCESS_ID
FROM COMPACT.IMDM_INDV_DM;